import{j as e}from"./index-Bb-Hm6Ev.js";import{r as l}from"./vendor-react-BHxUanFt.js";import{a as E}from"./axiosInstance-Bq-uIJjs.js";import{F as n,J as y,j as P,u as h,v as z,p as w,O,W as R,X as U,i as W}from"./index-a-IrBYvB.js";/* empty css                */import{d as x,e as j,n as _,h as G,i as B,k as H,a as J,b as V,V as X,W as u}from"./vendor-coreui-T9QyU9K3.js";import"./vendor-redux-CSji-Y9p.js";import"./index-xsH4HHeE.js";const ae=()=>{const[f,o]=l.useState([]),[I,S]=l.useState(!0),[C,A]=l.useState(""),[b,L]=l.useState(""),[i,d]=l.useState(1),[p]=l.useState(5);l.useEffect(()=>{(async()=>{try{const a=await E.get("/finance/invoices");console.log("Fetched invoice response:",a.data);const t=a.data;Array.isArray(t)?o(t):t&&Array.isArray(t.data)?o(t.data):t&&typeof t.data=="object"?o([t.data]):(console.error("Unexpected data format:",t),o([]))}catch(a){A("Failed to fetch invoices"),console.error(a)}finally{S(!1)}})()},[]);const T=s=>{switch(s==null?void 0:s.toLowerCase()){case"paid":return e.jsxs("div",{className:"status-badge status-paid",children:[e.jsx(n,{icon:W})," Paid"]});case"unpaid":return e.jsxs("div",{className:"status-badge status-unpaid",children:[e.jsx(n,{icon:P})," Unpaid"]});case"pending":return e.jsxs("div",{className:"status-badge status-pending",children:[e.jsx(n,{icon:y})," Pending"]});default:return e.jsx("div",{className:"status-badge",children:s||"N/A"})}},F=s=>{L(s.target.value),d(1)},m=f.filter(s=>{const a=b.toLowerCase();return s.invoiceNumber&&s.invoiceNumber.toLowerCase().includes(a)||s.firstName&&s.firstName.toLowerCase().includes(a)||s.lastName&&s.lastName.toLowerCase().includes(a)||s.status&&s.status.toLowerCase().includes(a)}),N=i*p,v=N-p,k=m.slice(v,N),r=Math.ceil(m.length/p),M=()=>{let a=[];if(r<=5)a=Array.from({length:r},(t,c)=>c+1);else{a.push(1);let t=Math.max(2,i-1),c=Math.min(r-1,i+1);c-t<2&&(i<r/2?c=Math.min(t+5-3,r-1):t=Math.max(2,c-2)),t>2&&a.push("...");for(let g=t;g<=c;g++)a.push(g);c<r-1&&a.push("..."),a.push(r)}return a},$=s=>{typeof s=="number"&&d(s)};return I?e.jsx(x,{className:"mb-4",children:e.jsx(j,{className:"d-flex justify-content-center align-items-center p-5",children:e.jsxs("div",{className:"loading-container text-center",children:[e.jsx(n,{icon:y,spin:!0,size:"2x",className:"mb-3"}),e.jsx("p",{children:"Loading invoices..."})]})})}):C?e.jsx(x,{className:"mb-4",children:e.jsx(j,{className:"d-flex justify-content-center align-items-center p-5",children:e.jsxs("div",{className:"error-container text-center",children:[e.jsx(n,{icon:P,size:"2x",color:"red",className:"mb-3"}),e.jsx("p",{children:C})]})})}):!f||f.length===0?e.jsx(x,{className:"mb-4",children:e.jsx(j,{className:"d-flex justify-content-center align-items-center p-5",children:e.jsxs("div",{className:"empty-container text-center",children:[e.jsx(n,{icon:h,size:"2x",className:"mb-3"}),e.jsx("p",{children:"No invoices found."})]})})}):e.jsxs(x,{className:"mb-4",children:[e.jsxs(_,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("h4",{className:"mb-0",children:[e.jsx(n,{icon:h,className:"me-2"})," All Invoices"]}),e.jsxs(G,{className:"w-auto",children:[e.jsx(B,{children:e.jsx(n,{icon:z})}),e.jsx(H,{placeholder:"Search invoices...",value:b,onChange:F,style:{maxWidth:"250px"}})]})]}),e.jsxs(j,{children:[e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-hover table-striped align-middle",children:[e.jsx("thead",{className:"bg-light",children:e.jsxs("tr",{children:[e.jsxs("th",{children:[e.jsx(n,{icon:h,className:"me-2"})," Invoice #"]}),e.jsxs("th",{children:[e.jsx(n,{icon:w,className:"me-2"})," Client"]}),e.jsxs("th",{children:[e.jsx(n,{icon:O,className:"me-2"})," Status"]})]})}),e.jsx("tbody",{children:k.map((s,a)=>e.jsxs("tr",{children:[e.jsxs("td",{className:"invoice-number",children:[e.jsx(n,{icon:h,className:"me-2 text-secondary"}),s.invoiceNumber||s._id||"N/A"]}),e.jsxs("td",{children:[e.jsx(n,{icon:w,className:"me-2 text-secondary"}),s.firstName&&s.lastName?`${s.firstName} ${s.lastName}`:"N/A"]}),e.jsx("td",{className:"status-cell",children:T(s.status)})]},s._id||`invoice-${a}`))})]})}),e.jsxs("div",{className:"text-center text-muted mt-3",children:["Showing ",v+1,"-",Math.min(N,m.length)," of ",m.length," invoices"]}),e.jsx(J,{className:"mt-3",children:e.jsx(V,{xs:12,className:"d-flex justify-content-center",children:e.jsxs(X,{"aria-label":"Page navigation",children:[e.jsx(u,{"aria-label":"Previous",disabled:i===1,onClick:()=>d(i-1),children:e.jsx("span",{"aria-hidden":"true",children:e.jsx(n,{icon:R})})}),M().map((s,a)=>s==="..."?e.jsx(u,{disabled:!0,children:"..."},`ellipsis-${a}`):e.jsx(u,{active:s===i,onClick:()=>$(s),children:s},`page-${s}`)),e.jsx(u,{"aria-label":"Next",disabled:i===r||r===0,onClick:()=>d(i+1),children:e.jsx("span",{"aria-hidden":"true",children:e.jsx(n,{icon:U})})})]})})})]})]})};export{ae as default};
