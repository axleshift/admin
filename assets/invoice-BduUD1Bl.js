import{x as I,j as e}from"./index-DM1yPWM8.js";import{r as D}from"./vendor-react-B6URQkMn.js";import{N as y,O as m,al as g,o as u,k as S,X as f,j as h,l as w,Z as b,_ as N,$ as p,a0 as a,a1 as $,a2 as o,y as A}from"./vendor-coreui-B7GHRQOS.js";import{l as c}from"./activityLogger-dj-FpP-1.js";import{c as L}from"./cil-money-Dk3vHnQB.js";import{c as P}from"./cil-clock-0brlqJOZ.js";import"./vendor-redux-C7peqcPR.js";import"./axiosInstance-Dv2jt_v_.js";import"./index-t--hEgTQ.js";var T=["512 512","<rect width='32' height='176' x='240' y='176' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='240' y='384' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M274.014,16H237.986L16,445.174V496H496V445.174ZM464,464H48V452.959L256,50.826,464,452.959Z' class='ci-primary'/>"];const Z=()=>{const{data:n=[],isLoading:l,error:i}=I();D.useEffect(()=>{const t=sessionStorage.getItem("name"),s=sessionStorage.getItem("role"),r=sessionStorage.getItem("department");c({name:t,role:s,department:r,route:"/invoicing",action:"View Invoice Dashboard",description:"User accessed the invoice management dashboard"}),i&&c({name:t,role:s,department:r,route:"/invoicing",action:"Error",description:`Error occurred while loading invoice data: ${i.message}`}),n.length>0&&!l&&c({name:t,role:s,department:r,route:"/invoicing",action:"Data Loaded",description:`Successfully loaded ${n.length} invoices`})},[n,i,l]);const d=n.length>0?{totalInvoices:n.length,pendingAmount:n.filter(t=>t.paymentStatus==="Pending").reduce((t,s)=>t+s.amountDue,0),overdueinvoices:n.filter(t=>t.paymentStatus==="Pending"&&new Date(t.dueDate)<new Date).length}:{totalInvoices:0,pendingAmount:0,overdueinvoices:0},x=(t,s)=>{const r=sessionStorage.getItem("name"),v=sessionStorage.getItem("role"),C=sessionStorage.getItem("department");c({name:r,role:v,department:C,route:"/invoicing",action:"Update Invoice Status",description:`User updated invoice ${t} status to ${s}`}),console.log(`Updating invoice ${t} to status ${s}`)},j=()=>{const t=sessionStorage.getItem("name"),s=sessionStorage.getItem("role"),r=sessionStorage.getItem("department");c({name:t,role:s,department:r,route:"/invoicing",action:"Create Invoice",description:"User initiated invoice creation process"}),console.log("Creating new invoice")};return l?e.jsx("p",{children:"Loading invoices..."}):i?e.jsxs("p",{children:["Error loading invoices: ",i.message]}):e.jsxs("div",{className:"p-4",children:[e.jsx("h2",{className:"mb-4",children:"Invoice Management"}),e.jsxs(y,{className:"mb-4",children:[e.jsx(m,{sm:6,lg:4,children:e.jsx(g,{icon:e.jsx(u,{icon:L,height:24}),title:"Total Invoices",value:d.totalInvoices.toString(),color:"primary"})}),e.jsx(m,{sm:6,lg:4,children:e.jsx(g,{icon:e.jsx(u,{icon:P,height:24}),title:"Pending Amount",value:`$${d.pendingAmount.toLocaleString()}`,color:"warning"})}),e.jsx(m,{sm:6,lg:4,children:e.jsx(g,{icon:e.jsx(u,{icon:T,height:24}),title:"Overdue Invoices",value:d.overdueinvoices.toString(),color:"danger"})})]}),e.jsxs(S,{children:[e.jsxs(f,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("strong",{children:"Invoices"}),e.jsx(h,{color:"primary",onClick:j,children:"Create Invoice"})]}),e.jsx(w,{children:n.length>0?e.jsxs(b,{hover:!0,responsive:!0,children:[e.jsx(N,{children:e.jsxs(p,{children:[e.jsx(a,{children:"Invoice ID"}),e.jsx(a,{children:"Customer ID"}),e.jsx(a,{children:"Amount Due"}),e.jsx(a,{children:"Due Date"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Actions"})]})}),e.jsx($,{children:n.map(t=>e.jsxs(p,{children:[e.jsx(o,{children:t.invoiceId}),e.jsx(o,{children:t.customerId}),e.jsxs(o,{children:["$",t.amountDue.toLocaleString()]}),e.jsx(o,{children:new Date(t.dueDate).toLocaleDateString()}),e.jsx(o,{children:e.jsxs(A,{color:t.paymentStatus==="Paid"?"success":new Date(t.dueDate)<new Date?"danger":"warning",children:[t.paymentStatus,t.paymentStatus==="Pending"&&new Date(t.dueDate)<new Date&&" (Overdue)"]})}),e.jsx(o,{children:t.paymentStatus==="Pending"&&e.jsx(h,{color:"success",size:"sm",onClick:()=>x(t.invoiceId,"Paid"),children:"Mark as Paid"})})]},t._id))})]}):e.jsx("p",{className:"text-center",children:"No Data Available"})})]})]})};export{Z as default};
