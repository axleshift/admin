import{j as e}from"./index-BRiklXPP.js";import{r as d,R as B}from"./vendor-react-B6URQkMn.js";import{a as O}from"./axiosInstance-BZJzjIBE.js";import{F as x,O as U,E as $,a7 as G,a8 as H,a9 as J}from"./index-BPaG30GW.js";import{S as _,T as S,o as q,$ as W,n as T,p as X,X as Y,Y as Z,Z as z,d as K,W as Q,a1 as V,a2 as ee,a3 as b,a4 as c,a5 as se,a6 as t,D as re,ac as ae,ad as P}from"./vendor-coreui-C9cgcUrA.js";import"./vendor-redux-DipIbRRz.js";const me=()=>{const[h,p]=d.useState([]),[j,k]=d.useState(!0),[u,v]=d.useState(null),[w,A]=d.useState(""),[r,E]=d.useState({key:"id",direction:"ascending"}),[m,y]=d.useState(1),g=10;d.useEffect(()=>{C()},[]);const C=async()=>{try{k(!0);const s=await O.get("/hr/payroll");s.data&&Array.isArray(s.data)?p(s.data):(console.warn("Unexpected API response format:",s.data),p([])),v(null)}catch(s){v("Failed to fetch payroll data. Please try again later."),console.error("Error fetching payroll data:",s),p([])}finally{k(!1)}},n=s=>{let a="ascending";r.key===s&&r.direction==="ascending"&&(a="descending"),E({key:s,direction:a})},o=s=>r.key!==s?e.jsx(x,{icon:G,className:"ms-1 text-gray-400"}):r.direction==="ascending"?e.jsx(x,{icon:H,className:"ms-1"}):e.jsx(x,{icon:J,className:"ms-1"}),f=B.useMemo(()=>r.key?[...h].sort((s,a)=>{const l=s[r.key],i=a[r.key];return!isNaN(parseFloat(l))&&!isNaN(parseFloat(i))?r.direction==="ascending"?parseFloat(l)-parseFloat(i):parseFloat(i)-parseFloat(l):typeof l=="string"&&typeof i=="string"?r.direction==="ascending"?l.localeCompare(i):i.localeCompare(l):l<i?r.direction==="ascending"?-1:1:l>i?r.direction==="ascending"?1:-1:0}):h,[h,r]).filter(s=>Object.values(s).some(a=>a&&a.toString().toLowerCase().includes(w.toLowerCase()))),D=m*g,M=D-g,F=f.slice(M,D),N=Math.ceil(f.length/g),I=s=>s==null?"N/A":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s),L=s=>["January","February","March","April","May","June","July","August","September","October","November","December"][s-1]||`Month ${s}`,R=s=>{switch(s==null?void 0:s.toLowerCase()){case"approved":return"success";case"paid":return"success";case"pending":return"warning";case"rejected":return"danger";case"failed":return"danger";default:return"secondary"}};return e.jsx("div",{className:"mb-4",children:e.jsx(_,{children:e.jsx(S,{children:e.jsxs(q,{className:"mb-4",children:[e.jsxs(W,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h4",{className:"mb-0",children:"Payroll Management"}),e.jsx("div",{children:e.jsxs(T,{color:"light",className:"me-2",onClick:C,children:[e.jsx(x,{icon:U,className:"me-1"})," Refresh"]})})]}),e.jsxs(X,{children:[e.jsxs(_,{className:"mb-3",children:[e.jsx(S,{md:6,children:e.jsxs(Y,{children:[e.jsx(Z,{children:e.jsx(x,{icon:$})}),e.jsx(z,{placeholder:"Search payroll...",value:w,onChange:s=>A(s.target.value)})]})}),e.jsx(S,{md:6,className:"d-flex justify-content-end align-items-center",children:!j&&!u&&e.jsxs("small",{className:"text-medium-emphasis",children:["Showing ",f.length," of ",h.length," records"]})})]}),j&&e.jsxs("div",{className:"text-center p-5",children:[e.jsx(K,{color:"primary"}),e.jsx("div",{className:"mt-3",children:"Loading payroll data..."})]}),u&&e.jsxs(Q,{color:"danger",children:[u,e.jsx(T,{color:"link",className:"p-0 ms-2",onClick:C,children:"Try again"})]}),!j&&!u&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"table-responsive",children:e.jsxs(V,{hover:!0,bordered:!0,children:[e.jsx(ee,{color:"light",children:e.jsxs(b,{children:[e.jsxs(c,{onClick:()=>n("id"),style:{cursor:"pointer"},children:["ID ",o("id")]}),e.jsxs(c,{onClick:()=>n("employee_id"),style:{cursor:"pointer"},children:["Employee ID ",o("employee_id")]}),e.jsxs(c,{onClick:()=>n("name"),style:{cursor:"pointer"},children:["Employee ",o("name")]}),e.jsxs(c,{onClick:()=>n("department"),style:{cursor:"pointer"},children:["Department ",o("department")]}),e.jsxs(c,{onClick:()=>n("job_position"),style:{cursor:"pointer"},children:["Position ",o("job_position")]}),e.jsxs(c,{onClick:()=>n("gross_salary"),style:{cursor:"pointer"},className:"text-end",children:["Gross Pay ",o("gross_salary")]}),e.jsxs(c,{onClick:()=>n("net_salary"),style:{cursor:"pointer"},className:"text-end",children:["Net Pay ",o("net_salary")]}),e.jsxs(c,{onClick:()=>n("year"),style:{cursor:"pointer"},className:"text-center",children:["Period ",o("year")]}),e.jsxs(c,{onClick:()=>n("status"),style:{cursor:"pointer"},className:"text-center",children:["Status ",o("status")]})]})}),e.jsx(se,{children:F.length>0?F.map((s,a)=>e.jsxs(b,{children:[e.jsx(t,{children:s.id||"—"}),e.jsx(t,{children:s.employee_id||"—"}),e.jsx(t,{children:s.name||"—"}),e.jsx(t,{children:s.department||"—"}),e.jsx(t,{children:s.job_position||"—"}),e.jsx(t,{className:"text-end",children:I(s.gross_salary)}),e.jsx(t,{className:"text-end",children:I(s.net_salary)}),e.jsx(t,{className:"text-center",children:`${L(s.month)}, ${s.year}`}),e.jsx(t,{className:"text-center",children:e.jsx(re,{color:R(s.status),children:s.status||"Pending"})})]},s.id||a)):e.jsx(b,{children:e.jsx(t,{colSpan:"10",className:"text-center p-4 text-medium-emphasis",children:"No payroll records found."})})})]})}),N>1&&e.jsxs(ae,{className:"mt-3 justify-content-center","aria-label":"Page navigation",children:[e.jsx(P,{disabled:m===1,onClick:()=>y(m-1),children:"Previous"}),Array.from({length:N},(s,a)=>a+1).map(s=>e.jsx(P,{active:s===m,onClick:()=>y(s),children:s},s)),e.jsx(P,{disabled:m===N,onClick:()=>y(m+1),children:"Next"})]})]})]})]})})})})};export{me as default};
