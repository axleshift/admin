import{a as M,b as X,j as e}from"./index-BA9i51uk.js";import{r as t}from"./vendor-react-BHxUanFt.js";import{F as c,j as Z,a as ee,k as se,l as re}from"./index-BbcC8ntF.js";import{S as v}from"./statbox-DkcPDEyD.js";import{C as te}from"./customhead-CZNfy1vk.js";import{a as p}from"./axiosInstance-Bq-uIJjs.js";import{l as ae}from"./activityLogger-D6Lc4RsL.js";import{C as le,a as n,b as a,d as R,n as D,e as E,l as ne,h as oe,i as ce,k as ie,r as de,s as he,t as P,u as i,v as me,w as d}from"./vendor-coreui-blXmWd_E.js";import"./vendor-redux-CSji-Y9p.js";import"./index-xsH4HHeE.js";const ve=()=>{const{data:xe,error:w,isLoading:H}=M(),{data:h,error:L,isLoading:U}=X(),[T,I]=t.useState(0),[g,A]=t.useState([]),[B,m]=t.useState(!0),[F,f]=t.useState(null),[y,G]=t.useState(""),[k,$]=t.useState([]),[q,x]=t.useState(!1),[J,K]=t.useState(null),b=localStorage.getItem("name"),_=localStorage.getItem("role"),z=localStorage.getItem("department");localStorage.getItem("username"),ae({name:b,role:_,department:z,route:"Hr Dashboard",action:"Navigate",description:`${b} Navigate to Hr Dashboard`}).catch(console.warn);const C=(h==null?void 0:h.data)||[];t.useEffect(()=>{m(!0),p.get("/hr/leaveRequest").then(s=>I(s.data.count||0)).catch(s=>f(s)).finally(()=>m(!1)),p.get("/hr/payroll").then(s=>{const r=s.data.payrollEntries||s.data||[];A(r)}).catch(s=>f(s)).finally(()=>m(!1))},[]),t.useEffect(()=>{(async()=>{try{x(!0);const l=(await p.get("/hr/worker")).data||[];$(l),x(!1)}catch(r){K(r.message||"Failed to fetch user data"),x(!1),console.error("Error fetching users:",r)}})()},[]);const N=s=>{if(s==null)return"N/A";const l=(typeof s=="number"?s.toString():s).replace(/[\s,]/g,""),O={$:"USD","₱":"PHP","€":"EUR","£":"GBP","¥":"JPY","₩":"KRW","₹":"INR",R$:"BRL",A$:"AUD",C$:"CAD","฿":"THB","₽":"RUB",kr:"SEK",CHF:"CHF",zł:"PLN"},Q=["USD","PHP","EUR","GBP","JPY","KRW","INR","BRL","AUD","CAD","THB","RUB","SEK","CHF","PLN"];let j="USD";for(const[o,V]of Object.entries(O))if(l.includes(o)){j=V;break}for(const o of Q)if(l.includes(o)){j=o;break}let Y=l.replace(/[^\d.-]/g,"");const S=parseFloat(Y);return isNaN(S)?s:new Intl.NumberFormat("en-US",{style:"currency",currency:j}).format(S)},W=k.length,u=g.filter(s=>Object.values(s).some(r=>r&&r.toString().toLowerCase().includes(y.toLowerCase())));return H||U||B||q?e.jsx("p",{children:"Loading..."}):w||L||F||J?e.jsx("p",{children:"Error fetching data"}):e.jsxs(le,{fluid:!0,className:"p-3",children:[e.jsx(n,{children:e.jsx(a,{xs:12,children:e.jsx(te,{title:"HR Dashboard",subtitle:"Welcome to the HR Dashboard"})})}),e.jsxs(n,{className:"my-3",children:[e.jsx(a,{xs:12,md:6,lg:3,children:e.jsx(v,{title:"Total Employees",value:W,icon:e.jsx(c,{icon:Z}),color:"primary",description:"Total registered employees"})}),e.jsx(a,{xs:12,md:6,lg:3,children:e.jsx(v,{title:"Leave Requests",value:T,description:"Total pending requests",icon:e.jsx(c,{icon:ee}),increase:0})})]}),e.jsx(n,{children:e.jsx(a,{xs:12,children:e.jsxs(R,{className:"mb-4 shadow",children:[e.jsx(D,{className:"bg-primary text-white",children:e.jsx("h5",{className:"m-0",children:"Job Postings"})}),e.jsx(E,{children:C.length>0?e.jsxs("table",{className:"table table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Job Title"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Author"}),e.jsx("th",{children:"Capacity"}),e.jsx("th",{children:"Description"})]})}),e.jsx("tbody",{children:C.map((s,r)=>e.jsxs("tr",{children:[e.jsx("td",{className:"fw-bold",children:s.title}),e.jsx("td",{children:s.category}),e.jsx("td",{children:s.author}),e.jsx("td",{children:s.capacity}),e.jsx("td",{children:s.responsibilities?s.responsibilities.length>100?`${s.responsibilities.substring(0,100)}...`:s.responsibilities:"No description available"})]},s._id||r))})]}):e.jsx("p",{className:"p-3",children:"No job postings available"})})]})})}),e.jsx(n,{children:e.jsx(a,{xs:12,children:e.jsxs(R,{className:"mb-4 shadow",children:[e.jsxs(D,{className:"bg-primary text-white d-flex justify-content-between align-items-center",children:[e.jsx("h5",{className:"m-0",children:"Payroll"}),e.jsxs(ne,{color:"light",size:"sm",children:[e.jsx(c,{icon:se,className:"me-1"}),"Generate Report"]})]}),e.jsxs(E,{children:[e.jsxs(n,{className:"mb-3",children:[e.jsx(a,{md:6,children:e.jsxs(oe,{children:[e.jsx(ce,{children:e.jsx(c,{icon:re})}),e.jsx(ie,{placeholder:"Search payroll...",value:y,onChange:s=>G(s.target.value)})]})}),e.jsx(a,{md:6,className:"d-flex justify-content-end align-items-center",children:e.jsxs("small",{className:"text-medium-emphasis",children:["Showing ",u.length," of ",g.length," records"]})})]}),u.length>0?e.jsx("div",{className:"table-responsive",children:e.jsxs(de,{striped:!0,hover:!0,bordered:!0,children:[e.jsx(he,{color:"light",children:e.jsxs(P,{children:[e.jsx(i,{children:"Employee ID"}),e.jsx(i,{children:"Name"}),e.jsx(i,{className:"text-end",children:"Gross Pay"}),e.jsx(i,{className:"text-end",children:"Net Pay"})]})}),e.jsx(me,{children:u.map((s,r)=>e.jsxs(P,{children:[e.jsx(d,{children:s.employee_id||"—"}),e.jsx(d,{children:s.name||"—"}),e.jsx(d,{className:"text-end",children:N(s.gross_salary)}),e.jsx(d,{className:"text-end",children:N(s.net_salary)})]},s.id||r))})]})}):e.jsx("p",{className:"text-center p-3",children:"No payroll data available"})]})]})})})]})};export{ve as default};
