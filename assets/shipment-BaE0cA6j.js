import{j as e}from"./index-C_p2WIB1.js";import{r as u,R as U}from"./vendor-react-P0hRR2W0.js";import{F as x,h as V,x as P,z as J,B as O,i as W,j as K}from"./index-D0KVb9r2.js";import{a as Y}from"./axiosInstance-Bq-uIJjs.js";import{l}from"./activityLogger-D6Lc4RsL.js";import{K as C,d as S,e as b,m as Z,n as q,w as G,x as Q,y as B,z as d,A as X,B as h,p as D,r as ee,Y as te,Z as k,H as se,I as ae,J as ne}from"./vendor-coreui-pds89uUO.js";import"./vendor-redux-BXoDUiID.js";import"./index-xsH4HHeE.js";const ue=()=>{const[g,_]=u.useState([]),[$,y]=u.useState(!0),[F,E]=u.useState(null),[r,L]=u.useState(1),p=10,[j,R]=u.useState(null),f=U.useRef(),s=localStorage.getItem("name"),a=localStorage.getItem("role"),n=localStorage.getItem("department"),c=localStorage.getItem("userId");localStorage.getItem("username"),JSON.parse(localStorage.getItem("permissions")||"[]"),l({name:s,role:a,department:n,route:"Shipment Table",action:"Page Visit",description:`${s} visit the Shipment Table page`}).catch(console.warn);const I=(t,m,o)=>{R(e.jsxs(se,{autohide:!0,delay:5e3,children:[e.jsxs(ae,{closeButton:!0,children:[e.jsx(x,{icon:o==="success"?W:K,className:"me-2"}),e.jsx("strong",{className:`me-auto text-${o}`,children:t})]}),e.jsx(ne,{children:m})]}))};u.useEffect(()=>{(async()=>{var m;try{y(!0),c&&s&&a&&n&&l({name:s,role:a,department:n,route:"/freight-table",action:"Fetch Shipments",description:"User accessed freight shipment data"}).catch(console.warn);const T=((m=(await Y.get("/core/fetch-core")).data)==null?void 0:m.data)||[];_(T),y(!1),I("Data Loaded",`Successfully loaded ${T.length} shipments`,"success"),c&&s&&a&&n&&l({name:s,role:a,department:n,route:"/freight-table",action:"Shipments Loaded",description:`Successfully loaded ${T.length} shipments`}).catch(console.warn)}catch(o){E(o.message||"Failed to fetch shipment data"),y(!1),I("Error Loading Data",o.message||"Failed to fetch shipment data","danger"),c&&s&&a&&n&&l({name:s,role:a,department:n,route:"/freight-table",action:"Shipments Load Failed",description:`Error fetching shipments: ${o.message}`}).catch(console.warn)}})()},[c,s,a,n]);const w=Math.ceil(g.length/p),N=t=>{L(t),c&&s&&a&&n&&l({name:s,role:a,department:n,route:"/freight-table",action:"Pagination",description:`User navigated to page ${t} of shipments`}).catch(console.warn)},H=()=>{const t=(r-1)*p,m=t+p;return g.slice(t,m)};if($)return e.jsxs(e.Fragment,{children:[e.jsx(C,{ref:f,push:j,placement:"top-end"}),e.jsx(S,{children:e.jsxs(b,{className:"text-center",children:[e.jsx(Z,{color:"primary"}),e.jsx("p",{className:"mt-2",children:"Loading Shipments..."})]})})]});if(F)return e.jsxs(e.Fragment,{children:[e.jsx(C,{ref:f,push:j,placement:"top-end"}),e.jsx(S,{className:"text-danger",children:e.jsxs(b,{className:"text-center",children:[e.jsx(x,{icon:V,size:"3x",className:"mb-3"}),e.jsx("p",{children:F})]})})]});if(g.length===0)return e.jsxs(e.Fragment,{children:[e.jsx(C,{ref:f,push:j,placement:"top-end"}),e.jsx(S,{children:e.jsxs(b,{className:"text-center",children:[e.jsx(x,{icon:P,size:"3x",className:"mb-3"}),e.jsx("p",{children:"No Shipments Found"})]})})]});const z=t=>{switch(t){case"to_pay":return"warning";case"cancelled":return"danger";case"delivered":return"success";case"in_transit":return"info";case"processing":return"primary";default:return"secondary"}},A=t=>{c&&s&&a&&n&&l({name:s,role:a,department:n,route:"/freight-table",action:"View Shipment Details",description:`Viewed details for shipment ${t.tracking_number}`}).catch(console.warn)},i=t=>{c&&s&&a&&n&&l({name:s,role:a,department:n,route:"/freight-table",action:"Sort Shipments",description:`User sorted shipments by ${t}`}).catch(console.warn)},M=H(),v=[];for(let t=1;t<=w;t++)v.push(e.jsx(k,{active:t===r,onClick:()=>N(t),children:t},t));return e.jsxs(e.Fragment,{children:[e.jsx(C,{ref:f,push:j,placement:"top-end"}),e.jsxs(S,{children:[e.jsxs(q,{children:[e.jsx(x,{icon:P,className:"me-2"}),"Shipment List"]}),e.jsx(b,{children:e.jsxs(G,{hover:!0,responsive:!0,children:[e.jsx(Q,{children:e.jsxs(B,{children:[e.jsx(d,{onClick:()=>i("tracking_number"),children:"Tracking Number"}),e.jsx(d,{onClick:()=>i("country"),children:"Country"}),e.jsx(d,{onClick:()=>i("type"),children:"Type"}),e.jsx(d,{onClick:()=>i("status"),children:"Status"}),e.jsx(d,{onClick:()=>i("weight"),children:"Weight"}),e.jsx(d,{onClick:()=>i("items"),children:"Items"}),e.jsx(d,{onClick:()=>i("amount"),children:"Amount"})]})}),e.jsx(X,{children:M.map(t=>e.jsxs(B,{onClick:()=>A(t),style:{cursor:"pointer"},children:[e.jsx(h,{children:t.tracking_number}),e.jsx(h,{children:t.country}),e.jsx(h,{children:e.jsx(D,{color:t.type==="business"?"info":"primary",children:t.type})}),e.jsx(h,{children:e.jsx(D,{color:z(t.status),children:t.status})}),e.jsxs(h,{children:[e.jsx(x,{icon:J,className:"me-1"}),t.total_weight," kg"]}),e.jsx(h,{children:t.number_of_items}),e.jsxs(h,{children:[e.jsx(x,{icon:O,className:"me-1"}),t.amount.value," ",t.amount.currency]})]},t._id))})]})}),w>1&&e.jsxs(ee,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"small text-muted",children:["Showing ",(r-1)*p+1," to ",Math.min(r*p,g.length)," of ",g.length," shipments"]}),e.jsxs(te,{"aria-label":"Shipment navigation",children:[e.jsx(k,{"aria-label":"Previous",disabled:r===1,onClick:()=>N(r-1),children:e.jsx("span",{"aria-hidden":"true",children:"«"})}),v,e.jsx(k,{"aria-label":"Next",disabled:r===w,onClick:()=>N(r+1),children:e.jsx("span",{"aria-hidden":"true",children:"»"})})]})]})]})]})};export{ue as default};
