import{H as C,j as e}from"./index-BrEm2_OI.js";import{r as I}from"./vendor-react-B6URQkMn.js";import{N as D,O as m,ab as g,o as u,k as S,a2 as f,j as h,l as w,Y as b,Z as H,_ as p,$ as i,a0 as N,a1 as n,y as $}from"./vendor-coreui-vXCAeGSv.js";import{l as c}from"./activityLogger-CswLieGG.js";import{c as A}from"./cil-clock-0brlqJOZ.js";import"./vendor-redux-DipIbRRz.js";import"./axiosInstance-Dv2jt_v_.js";import"./index-t--hEgTQ.js";var L=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M432,64H16V384H432ZM400,352H48V96H400Z' class='ci-primary'/><polygon fill='var(--ci-primary-color, currentColor)' points='464 144 464 416 96 416 96 448 496 448 496 144 464 144' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M224,302.46c39.7,0,72-35.137,72-78.326s-32.3-78.326-72-78.326-72,35.136-72,78.326S184.3,302.46,224,302.46Zm0-124.652c22.056,0,40,20.782,40,46.326s-17.944,46.326-40,46.326-40-20.782-40-46.326S201.944,177.808,224,177.808Z' class='ci-primary'/><rect width='32' height='176' x='80' y='136' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='176' x='336' y='136' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/>"],M=["512 512","<rect width='32' height='176' x='240' y='176' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='240' y='384' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M274.014,16H237.986L16,445.174V496H496V445.174ZM464,464H48V452.959L256,50.826,464,452.959Z' class='ci-primary'/>"];const B=()=>{const{data:s=[],isLoading:l,error:o}=C();I.useEffect(()=>{const r=sessionStorage.getItem("name"),t=sessionStorage.getItem("role"),a=sessionStorage.getItem("department");c({name:r,role:t,department:a,route:"/invoicing",action:"View Invoice Dashboard",description:"User accessed the invoice management dashboard"}),o&&c({name:r,role:t,department:a,route:"/invoicing",action:"Error",description:`Error occurred while loading invoice data: ${o.message}`}),s.length>0&&!l&&c({name:r,role:t,department:a,route:"/invoicing",action:"Data Loaded",description:`Successfully loaded ${s.length} invoices`})},[s,o,l]);const d=s.length>0?{totalInvoices:s.length,pendingAmount:s.filter(r=>r.paymentStatus==="Pending").reduce((r,t)=>r+t.amountDue,0),overdueinvoices:s.filter(r=>r.paymentStatus==="Pending"&&new Date(r.dueDate)<new Date).length}:{totalInvoices:0,pendingAmount:0,overdueinvoices:0},x=(r,t)=>{const a=sessionStorage.getItem("name"),j=sessionStorage.getItem("role"),y=sessionStorage.getItem("department");c({name:a,role:j,department:y,route:"/invoicing",action:"Update Invoice Status",description:`User updated invoice ${r} status to ${t}`}),console.log(`Updating invoice ${r} to status ${t}`)},v=()=>{const r=sessionStorage.getItem("name"),t=sessionStorage.getItem("role"),a=sessionStorage.getItem("department");c({name:r,role:t,department:a,route:"/invoicing",action:"Create Invoice",description:"User initiated invoice creation process"}),console.log("Creating new invoice")};return l?e.jsx("p",{children:"Loading invoices..."}):o?e.jsxs("p",{children:["Error loading invoices: ",o.message]}):e.jsxs("div",{className:"p-4",children:[e.jsx("h2",{className:"mb-4",children:"Invoice Management"}),e.jsxs(D,{className:"mb-4",children:[e.jsx(m,{sm:6,lg:4,children:e.jsx(g,{icon:e.jsx(u,{icon:L,height:24}),title:"Total Invoices",value:d.totalInvoices.toString(),color:"primary"})}),e.jsx(m,{sm:6,lg:4,children:e.jsx(g,{icon:e.jsx(u,{icon:A,height:24}),title:"Pending Amount",value:`$${d.pendingAmount.toLocaleString()}`,color:"warning"})}),e.jsx(m,{sm:6,lg:4,children:e.jsx(g,{icon:e.jsx(u,{icon:M,height:24}),title:"Overdue Invoices",value:d.overdueinvoices.toString(),color:"danger"})})]}),e.jsxs(S,{children:[e.jsxs(f,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("strong",{children:"Invoices"}),e.jsx(h,{color:"primary",onClick:v,children:"Create Invoice"})]}),e.jsx(w,{children:s.length>0?e.jsxs(b,{hover:!0,responsive:!0,children:[e.jsx(H,{children:e.jsxs(p,{children:[e.jsx(i,{children:"Invoice ID"}),e.jsx(i,{children:"Customer ID"}),e.jsx(i,{children:"Amount Due"}),e.jsx(i,{children:"Due Date"}),e.jsx(i,{children:"Status"}),e.jsx(i,{children:"Actions"})]})}),e.jsx(N,{children:s.map(r=>e.jsxs(p,{children:[e.jsx(n,{children:r.invoiceId}),e.jsx(n,{children:r.customerId}),e.jsxs(n,{children:["$",r.amountDue.toLocaleString()]}),e.jsx(n,{children:new Date(r.dueDate).toLocaleDateString()}),e.jsx(n,{children:e.jsxs($,{color:r.paymentStatus==="Paid"?"success":new Date(r.dueDate)<new Date?"danger":"warning",children:[r.paymentStatus,r.paymentStatus==="Pending"&&new Date(r.dueDate)<new Date&&" (Overdue)"]})}),e.jsx(n,{children:r.paymentStatus==="Pending"&&e.jsx(h,{color:"success",size:"sm",onClick:()=>x(r.invoiceId,"Paid"),children:"Mark as Paid"})})]},r._id))})]}):e.jsx("p",{className:"text-center",children:"No Data Available"})})]})]})};export{B as default};
