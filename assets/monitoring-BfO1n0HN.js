import{R as m,r as O,$ as te,a0 as ne,j as e,C as M}from"./index-BizKBI6a.js";import{a as L,b as h}from"./index.esm-LX8wyrY9.js";import{I as ce,J as B,K as _,s as w}from"./DefaultLayout-CnpPbvhY.js";import{C as R,a as D}from"./CCardBody-cs6hLwSm.js";import{C as V}from"./CCardHeader-CPTDb0Yp.js";import{C as F}from"./CFormInput-BYAzJEzi.js";import{C as A}from"./CFormSelect-BBQbi0Yz.js";import{C as H,a as G,b as v,c as a,d as Q,e as l}from"./CTable-D-tPmOjy.js";import"./chatbox-V5kNCwUM.js";import"./cil-magnifying-glass-COgjSVTM.js";import"./CCloseButton-CGgGdGd-.js";import"./index-D8rVyQy1.js";var X={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},K=m.createContext&&m.createContext(X),ie=["attr","size","title"];function le(r,t){if(r==null)return{};var n=ae(r,t),c,i;if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(r);for(i=0;i<j.length;i++)c=j[i],!(t.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(r,c)&&(n[c]=r[c])}return n}function ae(r,t){if(r==null)return{};var n={};for(var c in r)if(Object.prototype.hasOwnProperty.call(r,c)){if(t.indexOf(c)>=0)continue;n[c]=r[c]}return n}function f(){return f=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var c in n)Object.prototype.hasOwnProperty.call(n,c)&&(r[c]=n[c])}return r},f.apply(this,arguments)}function W(r,t){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);t&&(c=c.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),n.push.apply(n,c)}return n}function C(r){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?W(Object(n),!0).forEach(function(c){oe(r,c,n[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(n,c))})}return r}function oe(r,t,n){return t=de(t),t in r?Object.defineProperty(r,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[t]=n,r}function de(r){var t=ue(r,"string");return typeof t=="symbol"?t:t+""}function ue(r,t){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var c=n.call(r,t);if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function Y(r){return r&&r.map((t,n)=>m.createElement(t.tag,C({key:n},t.attr),Y(t.child)))}function d(r){return t=>m.createElement(he,f({attr:C({},r.attr)},t),Y(r.child))}function he(r){var t=n=>{var{attr:c,size:i,title:j}=r,y=le(r,ie),p=i||n.size||"1em",x;return n.className&&(x=n.className),r.className&&(x=(x?x+" ":"")+r.className),m.createElement("svg",f({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,c,y,{className:x,style:C(C({color:r.color||n.color},n.style),r.style),height:p,width:p,xmlns:"http://www.w3.org/2000/svg"}),j&&m.createElement("title",null,j),r.children)};return K!==void 0?m.createElement(K.Consumer,null,n=>t(n)):t(X)}function me(r){return d({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M436 480h-20V24c0-13.255-10.745-24-24-24H56C42.745 0 32 10.745 32 24v456H12c-6.627 0-12 5.373-12 12v20h448v-20c0-6.627-5.373-12-12-12zM128 76c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12V76zm0 96c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40zm52 148h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12zm76 160h-64v-84c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v84zm64-172c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40zm0-96c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40zm0-96c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12V76c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40z"},child:[]}]})(r)}function je(r){return d({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"},child:[]}]})(r)}function J(r){return d({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"},child:[]}]})(r)}function Z(r){return d({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},child:[]}]})(r)}function k(r){return d({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.976 0H24.028C2.71 0-8.047 25.866 7.058 40.971L192 225.941V432c0 7.831 3.821 15.17 10.237 19.662l80 55.98C298.02 518.69 320 507.493 320 487.98V225.941l184.947-184.97C520.021 25.896 509.338 0 487.976 0z"},child:[]}]})(r)}function q(r){return d({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M512 176.001C512 273.203 433.202 352 336 352c-11.22 0-22.19-1.062-32.827-3.069l-24.012 27.014A23.999 23.999 0 0 1 261.223 384H224v40c0 13.255-10.745 24-24 24h-40v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24v-78.059c0-6.365 2.529-12.47 7.029-16.971l161.802-161.802C163.108 213.814 160 195.271 160 176 160 78.798 238.797.001 335.999 0 433.488-.001 512 78.511 512 176.001zM336 128c0 26.51 21.49 48 48 48s48-21.49 48-48-21.49-48-48-48-48 21.49-48 48z"},child:[]}]})(r)}function xe(r){return d({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M202.021 0C122.202 0 70.503 32.703 29.914 91.026c-7.363 10.58-5.093 25.086 5.178 32.874l43.138 32.709c10.373 7.865 25.132 6.026 33.253-4.148 25.049-31.381 43.63-49.449 82.757-49.449 30.764 0 68.816 19.799 68.816 49.631 0 22.552-18.617 34.134-48.993 51.164-35.423 19.86-82.299 44.576-82.299 106.405V320c0 13.255 10.745 24 24 24h72.471c13.255 0 24-10.745 24-24v-5.773c0-42.86 125.268-44.645 125.268-160.627C377.504 66.256 286.902 0 202.021 0zM192 373.459c-38.196 0-69.271 31.075-69.271 69.271 0 38.195 31.075 69.27 69.271 69.27s69.271-31.075 69.271-69.271-31.075-69.27-69.271-69.27z"},child:[]}]})(r)}function ve(r){return d({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 160H48c-26.51 0-48 21.49-48 48v224c0 26.51 21.49 48 48 48h16v16c0 8.84 7.16 16 16 16h32c8.84 0 16-7.16 16-16v-16h128v16c0 8.84 7.16 16 16 16h32c8.84 0 16-7.16 16-16v-16h16c26.51 0 48-21.49 48-48V208c0-26.51-21.49-48-48-48zm-16 216c0 4.42-3.58 8-8 8H72c-4.42 0-8-3.58-8-8v-16c0-4.42 3.58-8 8-8h240c4.42 0 8 3.58 8 8v16zm0-96c0 4.42-3.58 8-8 8H72c-4.42 0-8-3.58-8-8v-16c0-4.42 3.58-8 8-8h240c4.42 0 8 3.58 8 8v16zM144 48h96v80h48V48c0-26.51-21.49-48-48-48h-96c-26.51 0-48 21.49-48 48v80h48V48z"},child:[]}]})(r)}function pe(r){return d({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(r)}function $(r){return d({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M622.3 271.1l-115.2-45c-4.1-1.6-12.6-3.7-22.2 0l-115.2 45c-10.7 4.2-17.7 14-17.7 24.9 0 111.6 68.7 188.8 132.9 213.9 9.6 3.7 18 1.6 22.2 0C558.4 489.9 640 420.5 640 296c0-10.9-7-20.7-17.7-24.9zM496 462.4V273.3l95.5 37.3c-5.6 87.1-60.9 135.4-95.5 151.8zM224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm96 40c0-2.5.8-4.8 1.1-7.2-2.5-.1-4.9-.8-7.5-.8h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c6.8 0 13.3-1.5 19.2-4-54-42.9-99.2-116.7-99.2-212z"},child:[]}]})(r)}const Ae=()=>{const[r,t]=O.useState("alerts"),[n,c]=O.useState({userId:"",alertType:"",status:""}),[i,j]=O.useState({userId:"",status:"",ipAddress:""}),y=()=>{const s={...i};return s.status==="attempt"&&(delete s.status,s.emptyUserId=!0),s},{data:p=[],isLoading:x,error:E}=te(n),{data:g=[],isLoading:ee,error:P}=ne(y()),T=m.useMemo(()=>i.status==="attempt"?g.filter(s=>!s.userId||s.userId===""||s.userId===null||s.userId===void 0):i.status==="success"||i.status==="failed"?g.filter(s=>s.status===i.status&&s.userId&&s.userId!==""&&s.userId!==null&&s.userId!==void 0):g,[g,i.status]),b=s=>{const{name:u,value:S}=s.target;c(I=>({...I,[u]:S}))},N=s=>{const{name:u,value:S}=s.target;j(I=>({...I,[u]:S}))},z=s=>new Date(s).toLocaleString(),U=(s,u=!1)=>{if(u)return s==="attempt"?"warning":s==="success"?"success":"danger";switch(s){case"OPEN":return"warning";case"RESOLVED":return"success";case"FALSE_POSITIVE":return"info";default:return"secondary"}},re=s=>{switch(s){case"SUSPICIOUS_LOGIN":return"warning";case"BRUTE_FORCE":return"danger";case"MULTIPLE_FAILURES":return"danger";case"UNUSUAL_LOCATION":return"info";default:return"secondary"}},o=s=>s==null?"-":typeof s=="object"?s.name?s.name:s.id?s.id:s.toString&&s.toString()!=="[object Object]"?s.toString():JSON.stringify(s):s,se=s=>!s.userId||s.userId===""||s.userId===null||s.userId===void 0?"attempt":s.status;return e.jsx("div",{className:"security-dashboard",children:e.jsx(L,{children:e.jsxs(h,{children:[e.jsxs(ce,{variant:"tabs",className:"mb-4",children:[e.jsx(B,{children:e.jsxs(_,{active:r==="alerts",onClick:()=>t("alerts"),children:[e.jsx(Z,{className:"me-2"})," Security Alerts"]})}),e.jsx(B,{children:e.jsxs(_,{active:r==="logins",onClick:()=>t("logins"),children:[e.jsx(q,{className:"me-2"})," Login Attempts"]})})]}),r==="alerts"&&e.jsxs(R,{className:"mb-4",children:[e.jsx(V,{children:e.jsxs("strong",{children:[e.jsx(Z,{className:"me-2"})," Security Alerts"]})}),e.jsxs(D,{children:[e.jsxs(L,{className:"mb-3 filter-section",children:[e.jsx(h,{sm:12,children:e.jsxs("h6",{children:[e.jsx(k,{className:"me-2"})," Filters"]})}),e.jsx(h,{sm:3,children:e.jsx(F,{placeholder:"User ID",name:"userId",value:n.userId,onChange:b,className:"mb-2"})}),e.jsx(h,{sm:3,children:e.jsxs(A,{name:"alertType",value:n.alertType,onChange:b,className:"mb-2",children:[e.jsx("option",{value:"",children:"All Alert Types"}),e.jsx("option",{value:"SUSPICIOUS_LOGIN",children:"Suspicious Login"}),e.jsx("option",{value:"BRUTE_FORCE",children:"Brute Force"}),e.jsx("option",{value:"MULTIPLE_FAILURES",children:"Multiple Failures"}),e.jsx("option",{value:"UNUSUAL_LOCATION",children:"Unusual Location"})]})}),e.jsx(h,{sm:3,children:e.jsxs(A,{name:"status",value:n.status,onChange:b,className:"mb-2",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"OPEN",children:"Open"}),e.jsx("option",{value:"RESOLVED",children:"Resolved"}),e.jsx("option",{value:"FALSE_POSITIVE",children:"False Positive"})]})})]}),E&&e.jsxs("div",{className:"alert alert-danger",children:["Failed to load security alerts: ",E.toString()]}),x?e.jsxs("div",{className:"text-center py-5",children:[e.jsx(M,{color:"primary"}),e.jsx("p",{className:"mt-3",children:"Loading security alerts..."})]}):e.jsxs(H,{hover:!0,responsive:!0,children:[e.jsx(G,{children:e.jsxs(v,{children:[e.jsx(a,{children:"Alert Type"}),e.jsx(a,{children:"User"}),e.jsx(a,{children:"Timestamp"}),e.jsx(a,{children:"Details"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Resolution"})]})}),e.jsx(Q,{children:p.length===0?e.jsx(v,{children:e.jsx(l,{colSpan:"6",className:"text-center",children:"No security alerts found"})}):p.map(s=>e.jsxs(v,{children:[e.jsx(l,{children:e.jsx(w,{color:re(s.alertType),children:o(s.alertType)})}),e.jsxs(l,{children:[e.jsx($,{className:"me-1"}),typeof s.userId=="object"&&s.userId!==null&&o(s.userId.name)||o(s.userId)]}),e.jsxs(l,{children:[e.jsx(J,{className:"me-1"}),s.timestamp?z(s.timestamp):"-"]}),e.jsx(l,{children:o(s.details)}),e.jsx(l,{children:e.jsx(w,{color:U(s.status),children:o(s.status)})}),e.jsx(l,{children:s.resolution&&typeof s.resolution=="object"?o(s.resolution.notes):"-"})]},s._id))})]})]})]}),r==="logins"&&e.jsxs(R,{className:"mb-4",children:[e.jsx(V,{children:e.jsxs("strong",{children:[e.jsx(q,{className:"me-2"})," Login Attempts"]})}),e.jsxs(D,{children:[e.jsxs(L,{className:"mb-3 filter-section",children:[e.jsx(h,{sm:12,children:e.jsxs("h6",{children:[e.jsx(k,{className:"me-2"})," Filters"]})}),e.jsx(h,{sm:3,children:e.jsx(F,{placeholder:"User ID",name:"userId",value:i.userId,onChange:N,className:"mb-2"})}),e.jsx(h,{sm:3,children:e.jsx(F,{placeholder:"IP Address",name:"ipAddress",value:i.ipAddress,onChange:N,className:"mb-2"})}),e.jsx(h,{sm:3,children:e.jsxs(A,{name:"status",value:i.status,onChange:N,className:"mb-2",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"success",children:"Success"}),e.jsx("option",{value:"failed",children:"Failed"}),e.jsx("option",{value:"attempt",children:"Attempt"})]})})]}),P&&e.jsxs("div",{className:"alert alert-danger",children:["Failed to load login attempts: ",P.toString()]}),ee?e.jsxs("div",{className:"text-center py-5",children:[e.jsx(M,{color:"primary"}),e.jsx("p",{className:"mt-3",children:"Loading login attempts..."})]}):e.jsxs(H,{hover:!0,responsive:!0,children:[e.jsx(G,{children:e.jsxs(v,{children:[e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Name"}),e.jsx(a,{children:"Role"}),e.jsx(a,{children:"Department"}),e.jsx(a,{children:"Device/Browser"}),e.jsx(a,{children:"Timestamp"})]})}),e.jsx(Q,{children:T.length===0?e.jsx(v,{children:e.jsx(l,{colSpan:"7",className:"text-center",children:"No login attempts found"})}):T.map(s=>{const u=se(s);return e.jsxs(v,{children:[e.jsx(l,{children:e.jsx(w,{color:U(u,!0),children:u==="success"?e.jsxs(e.Fragment,{children:[e.jsx(je,{className:"me-1"})," SUCCESS"]}):u==="attempt"?e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"me-1"})," ATTEMPT"]}):e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"me-1"})," FAILED"]})})}),e.jsxs(l,{children:[e.jsx($,{className:"me-1"}),o(s.name)]}),e.jsxs(l,{children:[e.jsx(ve,{className:"me-1"}),o(s.role)]}),e.jsxs(l,{children:[e.jsx(me,{className:"me-1"}),o(s.department)]}),e.jsx(l,{children:o(s.userAgent)}),e.jsxs(l,{children:[e.jsx(J,{className:"me-1"}),s.timestamp?z(s.timestamp):"-"]})]},s._id)})})]})]})]})]})})})};export{Ae as default};
