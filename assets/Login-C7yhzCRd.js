import{r as l,_ as T,R as E,B as P,D as R,P as g,u as B,Z as F,j as e,e as G,f as U,C as h,b as x,c as f,N as q}from"./index-CKcFKU7h.js";import{C as D,a as C}from"./index.esm-DAwbp2WG.js";import{C as j}from"./CRow-6GBEGtvd.js";import{C as c}from"./CCol-Bfnlt4mm.js";import{C as M}from"./CForm-2IzFcotE.js";import{C as y}from"./CInputGroupText-D1zJnoih.js";import{c as _}from"./ex-CELXs5B0.js";import{c as A}from"./cil-lock-locked-DmxpJbVL.js";var d=l.forwardRef(function(s,i){var n=s.children,o=s.className,r=T(s,["children","className"]);return E.createElement("div",P({className:R("card-group",o)},r,{ref:i}),n)});d.propTypes={children:g.node,className:g.string};d.displayName="CCardGroup";const X=()=>{const[s,i]=l.useState({identifier:"",password:""}),[n,o]=l.useState(null),r=B(),[N,{isLoading:m,error:J}]=F(),S=async t=>{var p;if(t.preventDefault(),!s.identifier||!s.password){o("Both fields are required.");return}try{const a=await N(s).unwrap();console.log("Login Success:",a),localStorage.setItem("accessToken",a.accessToken),localStorage.setItem("refreshToken",a.refreshToken);const{id:I,name:b,username:w,role:v,email:k,department:u,permissions:L}=a.user;switch(sessionStorage.setItem("userId",I),sessionStorage.setItem("username",w||""),sessionStorage.setItem("name",b||""),sessionStorage.setItem("email",k||""),sessionStorage.setItem("role",v||""),sessionStorage.setItem("department",u||""),sessionStorage.setItem("permissions",JSON.stringify(L||[])),console.log("Stored Permissions in sessionStorage:",sessionStorage.getItem("permissions")),u.toLowerCase()){case"administrative":r("/employeedash");break;case"hr":r("/hrdash");break;case"core":r("/coredash");break;case"finance":r("/financedash");break;case"logistics":r("/logisticdash");break;default:o("Invalid department or access rights.")}}catch(a){console.error("Login Failed:",a),o(((p=a.data)==null?void 0:p.message)||"An error occurred. Please try again.")}};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsx(D,{children:e.jsx(j,{className:"justify-content-center",children:e.jsx(c,{md:8,children:e.jsx(d,{children:e.jsx(G,{className:"p-4",children:e.jsx(U,{children:e.jsxs(M,{onSubmit:S,children:[e.jsx("h1",{children:"Login"}),e.jsx("p",{className:"text-body-secondary",children:"Sign In to your account"}),n&&e.jsx("p",{style:{color:"red"},children:n}),e.jsxs(h,{className:"mb-3",children:[e.jsx(y,{children:e.jsx(C,{icon:_})}),e.jsx(x,{type:"text",placeholder:"Email or Username",autoComplete:"email",value:s.identifier,onChange:t=>i({...s,identifier:t.target.value}),required:!0})]}),e.jsxs(h,{className:"mb-4",children:[e.jsx(y,{children:e.jsx(C,{icon:A})}),e.jsx(x,{type:"password",placeholder:"Password",autoComplete:"current-password",value:s.password,onChange:t=>i({...s,password:t.target.value}),required:!0})]}),e.jsxs(j,{children:[e.jsx(c,{xs:6,children:e.jsx(f,{type:"submit",color:"primary",className:"px-4",disabled:m,children:m?"Logging in...":"Login"})}),e.jsx(c,{xs:6,className:"text-right",children:e.jsx(q,{to:"/forgotpass",children:e.jsx(f,{color:"link",className:"px-0",children:"Forgot password?"})})})]})]})})})})})})})})};export{X as default};
