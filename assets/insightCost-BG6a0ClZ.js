import{j as s}from"./index-DGlCYBmm.js";import{r as h}from"./vendor-react-B6URQkMn.js";import{a as z}from"./axiosInstance-Dv2jt_v_.js";import{F as t,O as B,Z as W,R as I,G as S,D as P,ac as Y,a6 as Z,C as q,a7 as L,a8 as G,a9 as p,aa as R,ab as H}from"./index-DgWFfLP0.js";import{N as x,O as d,k as w,X as D,e as J,f as U,g as X,h as F,j,l as T,C as _,S as K,I as $,Z as O,y as u,_ as Q,$ as ss,a0 as A,a1 as C,a2 as es,a3 as n,ak as as}from"./vendor-coreui-DDUzhqJ9.js";import"./vendor-redux-C7peqcPR.js";import"./index-t--hEgTQ.js";const ms=()=>{const[N,M]=h.useState(null),[f,g]=h.useState(!0),[b,k]=h.useState(null),[o,y]=h.useState("6months");h.useEffect(()=>{(async()=>{var a;try{g(!0);const r=await z.get(`/core/insight/cost?timeframe=${o}`);M(r.data)}catch(r){k(((a=r.response)==null?void 0:a.data)||"Failed to fetch data")}finally{g(!1)}})()},[o]);const e=(()=>{if(!N)return null;const l=typeof N=="string"?JSON.parse(N):N;return{labels:l.labels||[],data:l.data||[]}})(),i=e?e.data.reduce((l,a)=>l+a,0):0,V=e?Math.max(...e.data,1):1,c=l=>{if(!e||l===0)return null;const a=e.data[l],r=e.data[l-1];return r===0?null:(a-r)/r*100},m=l=>l===null?"secondary":l>0?"danger":l<0?"success":"info",v=l=>l===null?p:l>0?R:l<0?H:p,E=()=>{(async()=>{var a;try{g(!0);const r=await z.get(`/core/insight/cost?timeframe=${o}`);M(r.data)}catch(r){k(((a=r.response)==null?void 0:a.data)||"Failed to fetch data")}finally{g(!1)}})()};return s.jsx("div",{className:"bg-light min-vh-100 d-flex flex-column",children:s.jsx("div",{className:"py-4",children:s.jsx(x,{children:s.jsx(d,{md:12,children:s.jsxs(w,{className:"mb-4 shadow-sm border-0",children:[s.jsxs(D,{className:"bg-white d-flex justify-content-between align-items-center py-3 border-bottom",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"mb-0 text-primary",children:[s.jsx(t,{icon:B,className:"me-2"}),"Cost Insights"]}),s.jsx("small",{className:"text-medium-emphasis",children:"Track and analyze your monthly expenditures"})]}),s.jsxs("div",{className:"d-flex gap-2",children:[s.jsxs(J,{children:[s.jsxs(U,{color:"light",className:"d-flex align-items-center",children:[s.jsx(t,{icon:W,className:"me-2"}),o==="6months"&&"Last 6 Months",o==="12months"&&"Last 12 Months",o==="ytd"&&"Year to Date"]}),s.jsxs(X,{children:[s.jsx(F,{onClick:()=>y("6months"),children:"Last 6 Months"}),s.jsx(F,{onClick:()=>y("12months"),children:"Last 12 Months"}),s.jsx(F,{onClick:()=>y("ytd"),children:"Year to Date"})]})]}),s.jsxs(j,{color:"light",onClick:E,disabled:f,children:[s.jsx(t,{icon:I,className:f?"fa-spin me-2":"me-2"}),"Refresh"]}),s.jsxs(j,{color:"light",children:[s.jsx(t,{icon:S,className:"me-2"}),"Export"]})]})]}),s.jsxs(T,{className:"p-4",children:[f&&s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"300px"},children:s.jsxs("div",{className:"text-center",children:[s.jsx(_,{color:"primary",style:{width:"3rem",height:"3rem"}}),s.jsx("p",{className:"mt-3 text-medium-emphasis",children:"Loading cost data..."})]})}),b&&s.jsxs(K,{color:"danger",className:"d-flex align-items-center",children:[s.jsx(t,{icon:P,className:"me-3 fs-4"}),s.jsxs("div",{children:[s.jsx("h4",{className:"alert-heading",children:"Data Fetch Error"}),s.jsx("p",{className:"mb-0",children:b}),s.jsxs(j,{color:"danger",variant:"ghost",size:"sm",className:"mt-2",onClick:E,children:[s.jsx(t,{icon:I,className:"me-1"})," Try Again"]})]})]}),e&&!f&&!b&&s.jsxs(s.Fragment,{children:[s.jsxs(x,{className:"mb-4",children:[s.jsx(d,{lg:4,md:6,className:"mb-4",children:s.jsx($,{color:"info",className:"h-100",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"p-3 bg-info bg-opacity-25 rounded-circle me-3",children:s.jsx(t,{icon:B,size:"2x",className:"text-info"})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-medium-emphasis small",children:"Total Cost"}),s.jsxs("div",{className:"fs-3 fw-bold",children:["₱",i.toFixed(2)]})]})]})})}),s.jsx(d,{lg:4,md:6,className:"mb-4",children:s.jsx($,{color:"primary",className:"h-100",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"p-3 bg-primary bg-opacity-25 rounded-circle me-3",children:s.jsx(t,{icon:Y,size:"2x",className:"text-primary"})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-medium-emphasis small",children:"Average Monthly Cost"}),s.jsxs("div",{className:"fs-3 fw-bold",children:["₱",e.data.length>0?(i/e.data.length).toFixed(2):"0.00"]})]})]})})}),s.jsx(d,{lg:4,md:12,className:"mb-4",children:e.data.length>=2&&s.jsx($,{color:m(c(e.data.length-1)),className:"h-100",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:`p-3 bg-${m(c(e.data.length-1))} bg-opacity-25 rounded-circle me-3`,children:s.jsx(t,{icon:v(c(e.data.length-1)),size:"2x",className:`text-${m(c(e.data.length-1))}`})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-medium-emphasis small",children:"Month-over-Month Change"}),s.jsx("div",{className:"fs-3 fw-bold",children:c(e.data.length-1)!==null?`${c(e.data.length-1)>0?"+":""}${c(e.data.length-1).toFixed(1)}%`:"N/A"})]})]})})})]}),s.jsx(x,{className:"mb-4",children:s.jsx(d,{md:12,children:s.jsxs(w,{className:"border-0 shadow-sm",children:[s.jsxs(D,{className:"bg-white border-bottom d-flex justify-content-between align-items-center py-3",children:[s.jsxs("h4",{className:"mb-0",children:[s.jsx(t,{icon:Z,className:"me-2 text-primary"}),"Monthly Cost Breakdown"]}),s.jsxs(j,{color:"light",size:"sm",children:[s.jsx(t,{icon:q,className:"me-1"})," Cost Analysis"]})]}),s.jsx(T,{className:"p-4",children:s.jsx("div",{className:"px-3",children:s.jsx(x,{className:"align-items-end g-0",style:{height:"250px"},children:e.data.map((l,a)=>s.jsx(d,{className:"px-1 text-center",children:s.jsxs("div",{className:"d-flex flex-column align-items-center",children:[s.jsxs("small",{className:"mb-2 fw-bold",children:["$",l.toFixed(2)]}),s.jsx("div",{style:{width:"100%",height:`${l/V*80}%`,minHeight:l>0?"20px":"4px"},children:s.jsx(O,{value:100,color:a===e.data.length-1?"primary":"success",className:"h-100 shadow-sm",style:{minWidth:"30px",borderRadius:"4px"}})}),s.jsxs("small",{className:"mt-2 text-medium-emphasis",children:[s.jsx(t,{icon:L,className:"me-1"}),e.labels[a]]}),a>0&&s.jsxs(u,{color:m(c(a)),shape:"rounded-pill",className:"mt-1",children:[s.jsx(t,{icon:v(c(a)),className:"me-1",size:"xs"}),c(a)!==null?`${c(a).toFixed(1)}%`:"N/A"]})]})},a))})})})]})})}),s.jsx(x,{children:s.jsx(d,{md:12,children:s.jsxs(w,{className:"border-0 shadow-sm",children:[s.jsxs(D,{className:"bg-white border-bottom d-flex justify-content-between align-items-center py-3",children:[s.jsxs("h4",{className:"mb-0",children:[s.jsx(t,{icon:G,className:"me-2 text-primary"}),"Cost Details"]}),s.jsxs(j,{color:"primary",size:"sm",variant:"outline",children:[s.jsx(t,{icon:S,className:"me-1"})," Export Data"]})]}),s.jsx(T,{className:"p-0",children:s.jsxs(Q,{hover:!0,responsive:!0,className:"mb-0 border-0",children:[s.jsx(ss,{className:"bg-light",children:s.jsxs(A,{children:[s.jsx(C,{children:"Month"}),s.jsx(C,{className:"text-end",children:"Cost (₱)"}),s.jsx(C,{className:"text-end",children:"% of Total"}),s.jsx(C,{className:"text-end",children:"Change"})]})}),s.jsx(es,{children:e.labels.map((l,a)=>s.jsxs(A,{children:[s.jsx(n,{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"p-2 me-2 bg-light rounded",children:s.jsx(t,{icon:L,className:"text-primary"})}),s.jsx("span",{className:"fw-medium",children:l})]})}),s.jsxs(n,{className:"text-end fw-bold",children:["₱",e.data[a].toFixed(2)]}),s.jsx(n,{className:"text-end",children:s.jsxs("div",{className:"d-flex align-items-center justify-content-end",children:[s.jsx("span",{className:"me-2",children:i>0?`${(e.data[a]/i*100).toFixed(1)}%`:"0%"}),s.jsx(O,{value:i>0?e.data[a]/i*100:0,color:"success",className:"flex-grow-1",style:{maxWidth:"100px",height:"8px"}})]})}),s.jsx(n,{className:"text-end",children:a>0?s.jsxs(u,{color:m(c(a)),shape:"rounded-pill",children:[s.jsx(t,{icon:v(c(a)),className:"me-1"}),c(a)!==null?`${c(a).toFixed(1)}%`:"N/A"]}):s.jsxs(u,{color:"secondary",shape:"rounded-pill",children:[s.jsx(t,{icon:p,className:"me-1"})," Base"]})})]},a))}),s.jsx(as,{className:"bg-light",children:s.jsxs(A,{children:[s.jsx(n,{className:"fw-bold",children:"Total"}),s.jsxs(n,{className:"fw-bold text-end",children:["₱",i.toFixed(2)]}),s.jsx(n,{className:"fw-bold text-end",children:"100%"}),s.jsx(n,{className:"text-end",children:e.data.length>=2&&s.jsxs(u,{color:e.data[e.data.length-1]>e.data[0]?"danger":e.data[e.data.length-1]<e.data[0]?"success":"info",shape:"rounded-pill",children:[s.jsx(t,{icon:e.data[e.data.length-1]>e.data[0]?R:e.data[e.data.length-1]<e.data[0]?H:p,className:"me-1"}),e.data[0]!==0?`${((e.data[e.data.length-1]-e.data[0])/e.data[0]*100).toFixed(1)}%`:"N/A"]})})]})})]})})]})})})]})]})]})})})})})};export{ms as default};
