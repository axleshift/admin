import{u as b,r as d,a0 as g,q as k,j as e,F as n,v as T,L,a1 as E,a2 as p,e as x}from"./index-B_J4AspD.js";import{C as O}from"./customhead-UR91rqGH.js";import{S as c}from"./statbox-B1Ddqbsr.js";import{O as B}from"./overviewChart-gCBB2dFs.js";import{E as z}from"./exceljs.min-DdH1QTAA.js";import{F as R}from"./FileSaver.min-CbDgHOxZ.js";import{B as A}from"./breakdownchart-Be7_pwop.js";import{C as V}from"./index.esm-Slr6Ep72.js";import{C as m}from"./CRow-CsDAzqQM.js";import{C as t}from"./CCol-RLEkE_jQ.js";import{C as W,a as F,b as y,c as o,d as M,e as i}from"./CTable-4oTXSU5-.js";import{C as H}from"./DefaultLayout-rvCroLYH.js";import"./CCardTitle-PGXrdOob.js";import"./generateCategoricalChart-bErp_Suu.js";import"./LineChart-DDhqQRID.js";import"./ex-CELXs5B0.js";const oe=()=>{var u;const h=b(),[I,f]=d.useState(window.innerWidth>768),[_,S]=d.useState(""),{data:a,isLoading:w}=g(),{data:l,isLoading:C}=k();d.useEffect(()=>{const s=()=>f(window.innerWidth>768);return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),d.useEffect(()=>{const s=localStorage.getItem("accessToken");s?S(s):h("/login")},[h]);const D=async()=>{if(!l)return;const s=new z.Workbook,j=s.addWorksheet("Transactions");j.columns=[{header:"Customer Name",key:"CustomerName",width:20},{header:"Order Volume (kg)",key:"OrderVolume",width:15},{header:"Shipping Type",key:"ShippingType",width:15},{header:"Order Date",key:"OrderDate",width:20},{header:"Status",key:"Status",width:15},{header:"Delivery Date",key:"DeliveryDate",width:20}],l.forEach(r=>{j.addRow({CustomerName:r.customerName,OrderVolume:`${r.orderVolume} kg`,ShippingType:r.shippingType,OrderDate:new Date(r.orderDate).toLocaleDateString(),Status:r.status,DeliveryDate:r.deliveryDate?new Date(r.deliveryDate).toLocaleString():"N/A"})});const v=await s.xlsx.writeBuffer(),N=new Blob([v],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});R.saveAs(N,"shipping_transactions.xlsx")};return w||C?e.jsx("div",{children:"Loading..."}):e.jsxs(V,{fluid:!0,className:"p-3",children:[e.jsxs(m,{className:"mb-4",children:[e.jsx(t,{xs:12,md:8,children:e.jsx(O,{title:"Dashboard",subtitle:"Welcome to Dashboard"})}),e.jsx(t,{xs:12,md:4,className:"d-flex justify-content-md-end align-items-center mb-3 mb-md-0",children:e.jsxs("button",{className:"download-btn",onClick:D,children:[e.jsx(n,{icon:T}),"Â  Download Reports"]})})]}),e.jsxs(m,{className:"my-3 g-3",children:[e.jsx(t,{xs:12,md:6,lg:3,children:e.jsx(c,{title:"Total Customers",value:a&&a.totalCustomers,increase:"+14%",description:"Since last month",icon:e.jsx(n,{icon:L,style:{fontSize:"20px",color:"#ffc107"}})})}),e.jsx(t,{xs:12,md:6,lg:3,children:e.jsx(c,{title:"Sales Today",value:((u=a==null?void 0:a.todayStats)==null?void 0:u.totalSales)||"N/A",increase:"+21%",description:"Since last month",icon:e.jsx(n,{icon:E,style:{fontSize:"20px"}})})}),e.jsx(t,{xs:12,md:6,lg:3,children:e.jsx(c,{title:"Monthly Sales",value:a&&a.thisMonthStats.totalSales,increase:"+5%",description:"Since last month",icon:e.jsx(n,{icon:p,style:{fontSize:"20px"}})})}),e.jsx(t,{xs:12,md:6,lg:3,children:e.jsx(c,{title:"Yearly Sales",value:a&&a.yearlySalesTotal,increase:"+43%",description:"Since last month",icon:e.jsx(n,{icon:p,style:{fontSize:"20px"}})})})]}),e.jsx(m,{className:"my-3",children:e.jsx(t,{xs:12,children:e.jsx(x,{className:"mb-4",children:e.jsx("div",{className:"p-3",children:e.jsx(B,{view:"sales",salesData:a})})})})}),e.jsxs(m,{className:"my-3 g-3",children:[e.jsx(t,{xs:12,lg:8,children:e.jsxs(x,{children:[e.jsx("h5",{className:"p-3",children:"Transactions"}),e.jsx("div",{className:"table-responsive",children:e.jsxs(W,{striped:!0,bordered:!0,hover:!0,responsive:!0,className:"mb-0",children:[e.jsx(F,{children:e.jsxs(y,{children:[e.jsx(o,{children:"Customer Name"}),e.jsx(o,{children:"Order Volume (kg)"}),e.jsx(o,{children:"Shipping Type"}),e.jsx(o,{children:"Order Date"}),e.jsx(o,{children:"Status"}),e.jsx(o,{children:"Delivery Date"})]})}),e.jsx(M,{children:l&&l.map(s=>e.jsxs(y,{children:[e.jsx(i,{children:s.customerName}),e.jsx(i,{children:s.orderVolume}),e.jsx(i,{children:s.shippingType}),e.jsx(i,{children:new Date(s.orderDate).toLocaleDateString()}),e.jsx(i,{children:e.jsx(H,{color:s.status==="Delivered"?"success":"warning",children:s.status})}),e.jsx(i,{children:s.deliveryDate?new Date(s.deliveryDate).toLocaleDateString():"N/A"})]},s._id))})]})})]})}),e.jsx(t,{xs:12,lg:4,children:e.jsxs(x,{children:[e.jsx("h5",{className:"p-3",children:"Sales By Category"}),e.jsx("div",{className:"p-3",children:e.jsx(A,{})}),e.jsx("h6",{className:"p-3",children:"Revenue of this year and Sales"})]})})]})]})};export{oe as default};
