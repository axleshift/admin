import{r as i,j as e}from"./index-BizKBI6a.js";import{a as v}from"./axiosInstance-CnxFScdD.js";import{a as f,b as n}from"./index.esm-LX8wyrY9.js";import{C as E,a as F}from"./CCardBody-cs6hLwSm.js";import{C as R}from"./CCardHeader-CPTDb0Yp.js";import{C as h,a as T}from"./CFormInput-BYAzJEzi.js";import{C as k}from"./CFormSelect-BBQbi0Yz.js";import{C as L,a as P,b as m,c,d as U,e as r}from"./CTable-D-tPmOjy.js";import{C as O,a as x}from"./CPaginationItem-B-2D8iv_.js";import"./index-D8rVyQy1.js";const $=()=>{const[j,b]=i.useState([]),[y,C]=i.useState(!1),[s,l]=i.useState({userId:"",actionType:"",startDate:"",endDate:"",page:1,limit:10}),[g,D]=i.useState({total:0,pages:1}),N=["PAGE_VIEW","BUTTON_CLICK","FORM_SUBMIT","SEARCH","LOGIN","LOGOUT"],u=async()=>{C(!0);try{const a=new URLSearchParams;Object.entries(s).forEach(([p,d])=>{d&&a.append(p,d)});const t=await v.get(`/general/getact?${a.toString()}`);t.data.success&&(b(t.data.data),D({total:t.data.total,pages:t.data.pages}))}catch(a){console.error("Error fetching activities:",a)}finally{C(!1)}};i.useEffect(()=>{u()},[s.page,s.limit]);const o=a=>{const{name:t,value:p}=a.target;l(d=>({...d,[t]:p,page:1}))},S=()=>{u()},I=()=>{l({userId:"",actionType:"",startDate:"",endDate:"",page:1,limit:10})},A=a=>new Date(a).toLocaleString();return e.jsx(f,{children:e.jsx(n,{xs:12,children:e.jsxs(E,{className:"mb-4",children:[e.jsx(R,{children:e.jsx("strong",{children:"User Activity Tracker"})}),e.jsxs(F,{children:[e.jsxs(f,{className:"mb-3",children:[e.jsx(n,{sm:12,md:3,children:e.jsx(h,{type:"text",name:"userId",value:s.userId,onChange:o,placeholder:"Filter by User ID",className:"mb-2"})}),e.jsx(n,{sm:12,md:3,children:e.jsxs(k,{name:"actionType",value:s.actionType,onChange:o,className:"mb-2",children:[e.jsx("option",{value:"",children:"All Action Types"}),N.map(a=>e.jsx("option",{value:a,children:a},a))]})}),e.jsx(n,{sm:12,md:2,children:e.jsx(h,{type:"date",name:"startDate",value:s.startDate,onChange:o,placeholder:"Start Date",className:"mb-2"})}),e.jsx(n,{sm:12,md:2,children:e.jsx(h,{type:"date",name:"endDate",value:s.endDate,onChange:o,placeholder:"End Date",className:"mb-2"})}),e.jsxs(n,{sm:12,md:2,className:"d-flex",children:[e.jsx(T,{color:"primary",onClick:S,className:"me-2",children:"Apply"}),e.jsx(T,{color:"secondary",onClick:I,children:"Reset"})]})]}),e.jsxs(L,{hover:!0,responsive:!0,children:[e.jsx(P,{children:e.jsxs(m,{children:[e.jsx(c,{scope:"col",children:"User"}),e.jsx(c,{scope:"col",children:"Role"}),e.jsx(c,{scope:"col",children:"Department"}),e.jsx(c,{scope:"col",children:"Action Type"}),e.jsx(c,{scope:"col",children:"Description"}),e.jsx(c,{scope:"col",children:"Timestamp"})]})}),e.jsx(U,{children:y?e.jsx(m,{children:e.jsx(r,{colSpan:"6",className:"text-center",children:"Loading..."})}):j.length===0?e.jsx(m,{children:e.jsx(r,{colSpan:"6",className:"text-center",children:"No activities found"})}):j.map(a=>e.jsxs(m,{children:[e.jsx(r,{children:a.name}),e.jsx(r,{children:a.role}),e.jsx(r,{children:a.department}),e.jsx(r,{children:a.actionType}),e.jsx(r,{children:a.actionDescription}),e.jsx(r,{children:A(a.timestamp)})]},a._id))})]}),e.jsxs(O,{align:"center",className:"mt-3",children:[e.jsx(x,{disabled:s.page<=1,onClick:()=>l(a=>({...a,page:a.page-1})),children:"Previous"}),[...Array(g.pages).keys()].map(a=>e.jsx(x,{active:a+1===s.page,onClick:()=>l(t=>({...t,page:a+1})),children:a+1},a+1)),e.jsx(x,{disabled:s.page>=g.pages,onClick:()=>l(a=>({...a,page:a.page+1})),children:"Next"})]})]})]})})})};export{$ as default};
