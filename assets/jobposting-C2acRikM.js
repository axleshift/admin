import{b as te,j as e}from"./index-3FTAhQcu.js";import{r as i}from"./vendor-react-BHxUanFt.js";import{F as a,i as P,E as N,G as ie,l as le,H as ce,I as T,J as ne,K as L,s as Q,L as oe,M as de}from"./index-fF0KaNX5.js";import{l as R}from"./activityLogger-D6Lc4RsL.js";import{D as me,E as xe,F as he,G as je,d as o,n as x,l as C,e as d,m as U,a as b,b as h,h as ue,k as pe,H as ge,I as Ne,J as Ce,K as $,r as K,s as _,t as f,u as m,v as O,w as n,p as D,L as fe,M as be,N as ye,O as we,Q as ve,R as Se,S as y,T as Te}from"./vendor-coreui-DaIzHuu_.js";import"./vendor-redux-CSji-Y9p.js";import"./axiosInstance-Bq-uIJjs.js";import"./index-xsH4HHeE.js";const Ie=()=>{const{data:r,error:A,isLoading:W,isSuccess:J,refetch:X}=te(),[Y,B]=i.useState(!1),[t,M]=i.useState(null),w=localStorage.getItem("role"),v=localStorage.getItem("department"),p=localStorage.getItem("name"),[Z,ee]=i.useState(null),[Le,se]=i.useState(null),[l,E]=i.useState(""),[F,k]=i.useState([]),[j,S]=i.useState("");i.useEffect(()=>{R({name:p,role:w,department:v,route:"jobpost",action:"Page Visit",description:`${p} visited the Job Postings page`}).catch(console.warn)},[p,w,v]);const u=(r==null?void 0:r.data)||[];i.useEffect(()=>{var s;J&&r&&(ee(e.jsxs(me,{autohide:!0,delay:3e3,children:[e.jsxs(xe,{closeButton:!0,children:[e.jsx(a,{icon:P,className:"me-2 text-success"}),e.jsx("strong",{className:"me-auto text-success",children:"Data Loaded"})]}),e.jsxs(he,{children:["Successfully loaded ",(r==null?void 0:r.count)||((s=r==null?void 0:r.data)==null?void 0:s.length)||0," job postings!"]})]})),k(u))},[J,r,u]),i.useEffect(()=>{let s=u;j&&(s=s.filter(c=>{var g;return((g=c.category)==null?void 0:g.toLowerCase())===j.toLowerCase()})),l&&(s=s.filter(c=>{var g,z,G,V;return((g=c.title)==null?void 0:g.toLowerCase().includes(l.toLowerCase()))||((z=c.author)==null?void 0:z.toLowerCase().includes(l.toLowerCase()))||((G=c.requirements)==null?void 0:G.toLowerCase().includes(l.toLowerCase()))||((V=c.responsibilities)==null?void 0:V.toLowerCase().includes(l.toLowerCase()))})),k(s)},[l,j,u]);const ae=async s=>{M(s),B(!0);try{await R({name:p,role:w,department:v,route:"jobposting",action:"Click",description:`${p} viewed details for job: ${s.title}`}).catch(console.warn)}catch(c){console.warn("Error logging activity:",c)}},I=()=>{B(!1),M(null)},q=s=>{switch(s==null?void 0:s.toLowerCase()){case"fulltime":case"full-time":return"success";case"parttime":case"part-time":return"info";case"contract":return"warning";case"internship":return"primary";default:return"secondary"}},H=s=>s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",re=[...new Set(u.map(s=>s.category))].filter(Boolean);return e.jsxs("div",{children:[e.jsx(je,{ref:se,push:Z,placement:"top-end"}),e.jsxs(o,{className:"mb-4 shadow border-0",children:[e.jsxs(x,{className:"bg-primary text-white d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx(a,{icon:N,className:"me-2"}),e.jsx("span",{className:"h4 m-0",children:"Job Postings"})]}),e.jsx(C,{color:"light",variant:"outline",size:"sm",onClick:()=>X(),title:"Refresh job postings",children:e.jsx(a,{icon:ie})})]}),e.jsx(d,{children:W?e.jsxs("div",{className:"text-center p-5",children:[e.jsx(U,{color:"primary",style:{width:"3rem",height:"3rem"}}),e.jsx("div",{className:"mt-3 text-muted",children:"Loading job postings..."})]}):A?e.jsxs("div",{className:"alert alert-danger d-flex align-items-center",children:[e.jsx(a,{icon:faExclamationTriangle,className:"me-2"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Error loading job postings:"})," ",A.toString()]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4",children:e.jsxs(b,{className:"align-items-center",children:[e.jsx(h,{md:4,children:e.jsx(o,{className:"h-100 shadow-sm",children:e.jsxs(d,{className:"d-flex align-items-center",children:[e.jsx(a,{icon:N,className:"text-primary fs-3 me-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted small",children:"Total Job Postings"}),e.jsx("div",{className:"fs-4 fw-semibold",children:(r==null?void 0:r.count)||u.length||0})]})]})})}),e.jsx(h,{md:8,children:e.jsxs(ue,{children:[e.jsx(pe,{placeholder:"Search job postings...",value:l,onChange:s=>E(s.target.value)}),e.jsx(C,{type:"button",color:"primary",children:e.jsx(a,{icon:le})}),e.jsxs(ge,{variant:"btn-group",children:[e.jsxs(Ne,{color:"primary",variant:"outline",children:[e.jsx(a,{icon:ce,className:"me-1"}),j||"All Categories"]}),e.jsxs(Ce,{children:[e.jsx($,{onClick:()=>S(""),children:"All Categories"}),re.map(s=>e.jsx($,{onClick:()=>S(s),children:s},s))]})]})]})})]})}),e.jsxs(K,{striped:!0,hover:!0,responsive:!0,className:"border shadow-sm",children:[e.jsx(_,{className:"bg-light",children:e.jsxs(f,{children:[e.jsxs(m,{children:[e.jsx(a,{icon:N,className:"me-2 text-primary"})," Job Title"]}),e.jsxs(m,{children:[e.jsx(a,{icon:T,className:"me-2 text-primary"})," Author"]}),e.jsxs(m,{children:[e.jsx(a,{icon:ne,className:"me-2 text-primary"})," Category"]}),e.jsxs(m,{children:[e.jsx(a,{icon:L,className:"me-2 text-primary"})," Capacity"]}),e.jsxs(m,{children:[e.jsx(a,{icon:Q,className:"me-2 text-primary"})," Posted Date"]}),e.jsx(m,{children:"Actions"})]})}),e.jsx(O,{children:F.length>0?F.map(s=>e.jsxs(f,{className:"align-middle",children:[e.jsx(n,{className:"fw-bold",children:s.title}),e.jsx(n,{children:s.author}),e.jsx(n,{children:e.jsx(D,{color:q(s.category),shape:"rounded-pill",className:"px-3 py-2",children:s.category})}),e.jsx(n,{className:"text-center",children:s.capacity}),e.jsx(n,{children:H(s.createdAt)}),e.jsx(n,{children:e.jsx(C,{color:"primary",size:"sm",onClick:()=>ae(s),className:"px-3",children:"View Details"})})]},s._id)):e.jsx(f,{children:e.jsxs(n,{colSpan:"6",className:"text-center py-5",children:[e.jsx(a,{icon:N,size:"3x",className:"text-muted mb-3"}),e.jsx("div",{className:"h5 text-muted mb-2",children:"No job postings found"}),e.jsx("div",{className:"text-muted small",children:l||j?"Try adjusting your search or filter criteria":"No job postings are currently available"}),(l||j)&&e.jsx(C,{color:"primary",variant:"outline",size:"sm",className:"mt-3",onClick:()=>{E(""),S("")},children:"Clear Filters"})]})})})]})]})})]}),e.jsxs(fe,{visible:Y,onClose:I,size:"lg",children:[e.jsx(be,{className:"bg-primary text-white",children:e.jsxs(ye,{children:[e.jsx(a,{icon:N,className:"me-2"}),"Job Details"]})}),e.jsx(we,{className:"px-4 py-4",children:t?e.jsxs("div",{className:"job-details",children:[e.jsx(ve,{className:"mb-1 h3",children:t.title}),e.jsxs(Se,{className:"mb-3 text-muted",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(a,{icon:T,className:"me-2 text-primary"}),"Posted by: ",e.jsx("strong",{className:"ms-1",children:t.author}),e.jsx("span",{className:"mx-2",children:"|"}),e.jsx(a,{icon:Q,className:"me-1 text-primary"}),H(t.createdAt)]}),e.jsx(D,{color:q(t.category),shape:"rounded-pill",className:"px-3 py-2",children:t.category})]}),e.jsx(b,{className:"mt-4",children:e.jsx(h,{children:e.jsxs(o,{className:"h-100 shadow-sm border-0",children:[e.jsxs(x,{className:"bg-light border-0",children:[e.jsx(a,{icon:oe,className:"me-2 text-primary"}),e.jsx("strong",{children:"Responsibilities"})]}),e.jsx(d,{children:e.jsx(y,{children:t.responsibilities||"No responsibilities specified."})})]})})}),e.jsxs(b,{className:"mt-4",children:[e.jsx(h,{md:6,children:e.jsxs(o,{className:"h-100 shadow-sm border-0",children:[e.jsxs(x,{className:"bg-light border-0",children:[e.jsx(a,{icon:P,className:"me-2 text-primary"}),e.jsx("strong",{children:"Requirements"})]}),e.jsx(d,{children:e.jsx(y,{children:t.requirements||"No requirements specified."})})]})}),e.jsx(h,{md:6,children:e.jsxs(o,{className:"h-100 shadow-sm border-0",children:[e.jsxs(x,{className:"bg-light border-0",children:[e.jsx(a,{icon:T,className:"me-2 text-primary"}),e.jsx("strong",{children:"Qualifications"})]}),e.jsx(d,{children:e.jsx(y,{children:t.qualifications||"No qualifications specified."})})]})})]}),e.jsxs(b,{className:"mt-4",children:[e.jsx(h,{md:8,children:e.jsxs(o,{className:"h-100 shadow-sm border-0",children:[e.jsxs(x,{className:"bg-light border-0",children:[e.jsx(a,{icon:de,className:"me-2 text-primary"}),e.jsx("strong",{children:"Benefits"})]}),e.jsx(d,{children:e.jsx(y,{children:t.benefits||"No benefits specified."})})]})}),e.jsx(h,{md:4,children:e.jsxs(o,{className:"h-100 shadow-sm border-0",children:[e.jsxs(x,{className:"bg-light border-0",children:[e.jsx(a,{icon:L,className:"me-2 text-primary"}),e.jsx("strong",{children:"Capacity"})]}),e.jsx(d,{children:e.jsx("div",{className:"d-flex align-items-center justify-content-center h-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"display-4 fw-bold text-primary",children:t.capacity}),e.jsx("div",{className:"text-muted",children:"position(s)"})]})})})]})})]}),t.applications&&t.applications.length>0&&e.jsxs(o,{className:"mt-4 shadow-sm border-0",children:[e.jsxs(x,{className:"bg-light border-0",children:[e.jsx(a,{icon:L,className:"me-2 text-primary"}),e.jsx("strong",{children:"Applications"})]}),e.jsx(d,{children:e.jsxs(K,{striped:!0,hover:!0,className:"mt-3 border",children:[e.jsx(_,{className:"bg-light",children:e.jsxs(f,{children:[e.jsx(m,{children:"Applicant Name"}),e.jsx(m,{children:"Status"})]})}),e.jsx(O,{children:t.applications.map(s=>e.jsxs(f,{children:[e.jsx(n,{children:s.applicantName}),e.jsx(n,{children:e.jsx(D,{color:s.status==="Approved"?"success":s.status==="Rejected"?"danger":s.status==="Pending"?"warning":"info",shape:"rounded-pill",className:"px-3 py-2",children:s.status})})]},s._id))})]})})]})]}):e.jsxs("div",{className:"text-center py-5",children:[e.jsx(U,{color:"primary"}),e.jsx("div",{className:"mt-3",children:"Loading job details..."})]})}),e.jsx(Te,{children:e.jsx(C,{color:"secondary",onClick:I,children:"Close"})})]})]})};export{Ie as default};
