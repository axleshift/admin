import{j as e}from"./index-CzlX11AB.js";import{r as t}from"./vendor-react-P0hRR2W0.js";import"./statbox-ZiMRliOC.js";import{C as P}from"./customhead-HZLGt52a.js";import{a as f}from"./axiosInstance-Bq-uIJjs.js";import{F as i,h as I,w as R,D as U,i as k,A as T,E as B}from"./index-D0KVb9r2.js";import H from"./vehicletable-96Z1I23E.js";import{l as M}from"./activityLogger-D6Lc4RsL.js";import{C as $,a as j,b as c,d as o,e as m,g as q,m as d,q as W,D as G,n as J}from"./vendor-coreui-pds89uUO.js";import"./vendor-redux-BKcj_6VU.js";import"./index-xsH4HHeE.js";const ie=()=>{const[l,E]=t.useState({total:0,available:0,maintenance:0,forRegistration:0}),[A,L]=t.useState(0),[h,v]=t.useState(!0),[D,b]=t.useState(!0),[N,u]=t.useState(null),[K,p]=t.useState(null),[z,F]=t.useState([]),x=localStorage.getItem("name"),y=localStorage.getItem("role"),C=localStorage.getItem("department");localStorage.getItem("username"),t.useEffect(()=>{M({name:x,role:y,department:C,route:"Logistic Dashboard",action:"Navigate",description:`${x} Navigate to Logistic Dashboard`}).catch(console.warn)},[x,y,C]),t.useEffect(()=>{const w=async()=>{try{v(!0);const s=await f.get("/logistics/vehicle");if(s.data.success&&s.data.data.success){const n=s.data.data.data.filter(r=>!r.deleted),V={total:n.length,available:n.filter(r=>r.status==="available").length,maintenance:n.filter(r=>r.status==="maintenance").length||0,forRegistration:n.filter(r=>r.status==="for registration").length||0};E(V)}else u("Failed to fetch vehicle data")}catch(s){u(s.message||"An error occurred while fetching vehicle data"),console.error("Error fetching vehicles:",s)}finally{v(!1)}},a=async()=>{try{const S=(await f.get("/hr/worker")).data.filter(n=>n.department==="Logistics");F(S)}catch(s){u(s.message||"Failed to fetch Logistics department users"),console.error("Error fetching Logistics users:",s)}};w(),a()},[]),t.useEffect(()=>{(async()=>{try{b(!0);const a=await f.get("/logistics/inventory");a.data&&Array.isArray(a.data)?L(a.data.length):p("Failed to fetch inventory data")}catch(a){p(a.message||"An error occurred while fetching inventory data"),console.error("Error fetching inventory:",a)}finally{b(!1)}})()},[]);const g=l.total>0?Math.round(l.available/l.total*100):0;return e.jsxs($,{fluid:!0,className:"p-4",children:[e.jsx(j,{className:"mb-4",children:e.jsx(c,{children:e.jsx(o,{className:"border-0 shadow-sm",children:e.jsx(m,{children:e.jsx(P,{title:"Logistics Dashboard",subtitle:`Welcome back, ${x||"User"}! Here's your logistics overview`})})})})}),N&&e.jsx(j,{className:"mb-4",children:e.jsx(c,{children:e.jsxs(q,{color:"danger",dismissible:!0,children:[e.jsx(i,{icon:I,className:"me-2"}),N]})})}),e.jsxs(j,{children:[e.jsx(c,{md:5,lg:4,children:e.jsxs(j,{className:"g-4",children:[e.jsx(c,{xs:12,children:e.jsx(o,{className:"border-0 shadow-sm h-100",children:e.jsxs(m,{className:"d-flex align-items-center",children:[e.jsx("div",{className:"text-primary bg-light rounded-circle p-3 me-3",children:e.jsx(i,{icon:R,size:"2x"})}),e.jsxs("div",{children:[e.jsx("h6",{className:"text-muted mb-1",children:"Logistics Personnel"}),e.jsx("h3",{className:"mb-0",children:h?e.jsx(d,{size:"sm"}):z.length}),e.jsx("small",{className:"text-muted",children:"Total employees in department"})]})]})})}),e.jsx(c,{xs:12,children:e.jsx(o,{className:"border-0 shadow-sm h-100",children:e.jsxs(m,{className:"d-flex align-items-center",children:[e.jsx("div",{className:"text-info bg-light rounded-circle p-3 me-3",children:e.jsx(i,{icon:U,size:"2x"})}),e.jsxs("div",{className:"w-100",children:[e.jsx("h6",{className:"text-muted mb-1",children:"Fleet Status"}),e.jsx("h3",{className:"mb-0",children:h?e.jsx(d,{size:"sm"}):l.total}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"d-flex justify-content-between mb-1",children:[e.jsx("small",{className:"text-muted",children:"Vehicle Availability"}),e.jsxs("small",{className:"text-success",children:[g,"%"]})]}),e.jsx(W,{height:5,className:"mb-3",children:e.jsx(G,{color:g>70?"success":g>30?"warning":"danger",value:g})}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("small",{children:[e.jsx(i,{icon:k,className:"text-success me-1"}),h?e.jsx(d,{size:"sm"}):l.available," Available"]}),e.jsxs("small",{children:[e.jsx(i,{icon:I,className:"text-warning me-1"}),h?e.jsx(d,{size:"sm"}):l.maintenance||0," In Maintenance"]})]})]})]})]})})}),e.jsx(c,{xs:12,children:e.jsx(o,{className:"border-0 shadow-sm h-100",children:e.jsxs(m,{className:"d-flex align-items-center",children:[e.jsx("div",{className:"text-success bg-light rounded-circle p-3 me-3",children:e.jsx(i,{icon:T,size:"2x"})}),e.jsxs("div",{children:[e.jsx("h6",{className:"text-muted mb-1",children:"Inventory Items"}),e.jsx("h3",{className:"mb-0",children:D?e.jsx(d,{size:"sm"}):A}),e.jsx("small",{className:"text-muted",children:"Total items in stock"})]})]})})})]})}),e.jsx(c,{md:7,lg:8,children:e.jsxs(o,{className:"border-0 shadow-sm h-100",children:[e.jsx(J,{className:"bg-transparent border-bottom-0",children:e.jsx("div",{className:"d-flex justify-content-between align-items-center",children:e.jsxs("h5",{className:"mb-0",children:[e.jsx(i,{icon:B,className:"me-2 text-primary"}),"Vehicle Management"]})})}),e.jsx(m,{children:e.jsx(H,{})})]})})]})]})};export{ie as default};
