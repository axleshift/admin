import{j as e}from"./index-B0abr24P.js";import{r}from"./vendor-react-B6URQkMn.js";import{a as y}from"./axiosInstance-Dv2jt_v_.js";import{l as b}from"./activityLogger-CswLieGG.js";import"./vendor-redux-DipIbRRz.js";import"./vendor-coreui-vXCAeGSv.js";import"./index-t--hEgTQ.js";const I=()=>{const[g,S]=r.useState([]),[i,u]=r.useState(1),[m,w]=r.useState(0),[a,o]=r.useState(!1),[x,c]=r.useState(null),l=sessionStorage.getItem("role"),d=sessionStorage.getItem("department"),h=sessionStorage.getItem("name");r.useEffect(()=>{b({name:h,role:l,department:d,route:"/freights",action:"Page Visit",description:"User viewed the freights list page"})},[h,l,d]);const p=async()=>{var t,n;o(!0),c(null);try{const s=await y.post("/core/syncFreightData");console.log("Sync response:",s.data),await j()}catch(s){c(((n=(t=s.response)==null?void 0:t.data)==null?void 0:n.message)||"An error occurred while syncing freights"),console.error("Error syncing freights:",s)}finally{o(!1)}},j=async()=>{var t,n;o(!0),c(null);try{const s=await y.get("/core/freight",{params:{page:i}});S(s.data.freights),w(s.data.totalPages)}catch(s){c(((n=(t=s.response)==null?void 0:t.data)==null?void 0:n.message)||"An error occurred while fetching freights"),console.error("Error fetching freights:",s)}finally{o(!1)}};r.useEffect(()=>{p()},[]),r.useEffect(()=>{j()},[i]);const f=t=>{b({name:h,role:l,department:d,route:`/freights/${t}`,action:"View Freight",description:`User viewed details for freight ID: ${t}`})},P=()=>u(t=>Math.max(t-1,1)),v=()=>u(t=>t+1);return a?e.jsx("p",{children:"Loading freights..."}):x?e.jsxs("p",{children:["Error: ",x]}):e.jsxs("div",{className:"freight-list-container",children:[e.jsx("h2",{children:"Freight List"}),e.jsx("div",{className:"sync-section",children:e.jsx("button",{onClick:p,disabled:a,children:a?"Syncing...":"Sync Freight Data"})}),e.jsxs("table",{className:"freight-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Tracking Number"}),e.jsx("th",{children:"Country"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Total Weight"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:g.length>0?g.map(t=>e.jsxs("tr",{onClick:()=>f(t._id),className:"freight-row",children:[e.jsx("td",{children:t.tracking_number}),e.jsx("td",{children:t.country}),e.jsx("td",{children:t.status}),e.jsxs("td",{children:[t.total_weight," kg"]}),e.jsxs("td",{children:[t.amount.currency," ",t.amount.value]}),e.jsx("td",{children:e.jsx("button",{onClick:n=>{n.stopPropagation(),f(t._id)},children:"View Details"})})]},t._id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",children:"No freights available"})})})]}),e.jsxs("div",{className:"pagination",children:[e.jsx("button",{onClick:P,disabled:i===1||a,children:"Previous"}),e.jsxs("span",{children:["Page ",i," of ",m]}),e.jsx("button",{onClick:v,disabled:i===m||a,children:"Next"})]})]})};export{I as default};
