import{j as e}from"./index-30lfaIj6.js";import{r as o}from"./vendor-react-BHxUanFt.js";import{a as p}from"./axiosInstance-Bq-uIJjs.js";import{F as d,G as R,H as f,n as S,i as T}from"./index-CwAiTJO5.js";import{C as D,d as U,n as B,a as F,b as C,l as u,e as P,g as v,m as A,w as H,x as k,y as h,z as c,A as L,B as a,o as I,p as N}from"./vendor-coreui-T9QyU9K3.js";import"./vendor-redux-CSji-Y9p.js";import"./index-xsH4HHeE.js";const M=()=>{const[m,y]=o.useState([]),[i,l]=o.useState(!0),[j,x]=o.useState(null),[w,g]=o.useState(0);o.useEffect(()=>{(async()=>{var t,r;try{l(!0);const n=await p.get("/client/new-users");y(n.data.users),x(null)}catch(n){x(((r=(t=n.response)==null?void 0:t.data)==null?void 0:r.message)||"Failed to fetch newly registered users"),console.error("Error fetching new users:",n)}finally{l(!1)}})()},[w]);const b=async()=>{var s,t;try{l(!0);const r=await p.post("/client/process-registrations");alert(`Processing complete: ${r.data.message}`),g(n=>n+1)}catch(r){x(((t=(s=r.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to process registrations"),console.error("Error processing registrations:",r),l(!1)}},E=s=>s?new Date(s).toLocaleString():"N/A";return e.jsx(D,{fluid:!0,className:"px-4",children:e.jsxs(U,{className:"mb-4",children:[e.jsx(B,{children:e.jsxs(F,{className:"align-items-center",children:[e.jsx(C,{children:e.jsx("h2",{className:"mb-0",children:"Newly Registered Users"})}),e.jsxs(C,{className:"d-flex justify-content-end",children:[e.jsxs(u,{color:"primary",onClick:b,disabled:i,className:"me-2",children:[e.jsx(d,{icon:i?R:f,spin:i,className:"me-2"}),"Process Pending Registrations"]}),e.jsxs(u,{color:"success",onClick:()=>g(s=>s+1),disabled:i,children:[e.jsx(d,{icon:f,className:"me-2"}),"Refresh List"]})]})]})}),e.jsxs(P,{children:[j&&e.jsx(v,{color:"danger",children:j}),i?e.jsx("div",{className:"d-flex justify-content-center py-5",children:e.jsx(A,{color:"primary"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Total Users:"})," ",m.length]}),e.jsxs(H,{hover:!0,responsive:!0,bordered:!0,children:[e.jsx(k,{color:"light",children:e.jsxs(h,{children:[e.jsx(c,{children:"Name"}),e.jsx(c,{children:"Email"}),e.jsx(c,{children:"Role"}),e.jsx(c,{children:"Department"}),e.jsx(c,{children:"Registration Date"}),e.jsx(c,{children:"Status"})]})}),e.jsx(L,{children:m.length>0?m.map(s=>e.jsxs(h,{children:[e.jsxs(a,{children:[s.firstName," ",s.lastName]}),e.jsx(a,{children:s.email}),e.jsx(a,{children:s.role}),e.jsx(a,{children:s.department}),e.jsx(a,{children:E(s.registrationDate)}),e.jsx(a,{children:s.registrationError?e.jsx(I,{content:s.registrationError,children:e.jsxs(N,{color:"danger",children:[e.jsx(d,{icon:S,className:"me-1"})," Error"]})}):e.jsxs(N,{color:"success",children:[e.jsx(d,{icon:T,className:"me-1"})," Success"]})})]},s._id)):e.jsx(h,{children:e.jsx(a,{colSpan:"7",className:"text-center py-4 text-muted",children:"No registered users found"})})})]})]})]})]})})};export{M as default};
