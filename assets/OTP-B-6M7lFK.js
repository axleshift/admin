import{r as d,u as E,A as w,B as A,j as e,C as u,L}from"./index-BizKBI6a.js";import{C as V,a as m,b as r,c as g,d as C,e as f}from"./index.esm-LX8wyrY9.js";import{C as G}from"./CCardGroup-vzqjpc4x.js";import{C as F,a as I}from"./CCardBody-cs6hLwSm.js";import{C as M}from"./CAlert-CUEFZV7O.js";import{C as b}from"./CForm-tPETyldd.js";import{C as N,a as o}from"./CFormInput-BYAzJEzi.js";import{c as B}from"./cil-lock-locked-DmxpJbVL.js";import"./CCloseButton-CGgGdGd-.js";var R=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M495.826,232a206.644,206.644,0,0,0-18.882-78.412,227.033,227.033,0,0,0-51.61-71.261C379.708,39.555,319.571,16,256,16A240,240,0,0,0,86.294,425.706a240,240,0,0,0,337.671,1.722l-22.4-22.856A206.824,206.824,0,0,1,256,464C141.309,464,48,370.691,48,256S141.309,48,256,48c112.748,0,208,87.925,208,192v36c0,28.673-25.122,52-56,52s-56-23.327-56-52V160H320v26.751a99.988,99.988,0,1,0,12.55,132.437C347.956,343.62,376.01,360,408,360c48.523,0,88-37.682,88-84V232ZM252,328a68,68,0,1,1,68-68A68.077,68.077,0,0,1,252,328Z' class='ci-primary'/>"];const $=()=>{const[n,v]=d.useState(""),[x,P]=d.useState(""),[h,y]=d.useState(1),[p,s]=d.useState({text:"",type:""}),T=E(),[O,{isLoading:i,isSuccess:z,error:D}]=w(),[S,{isLoading:c,isSuccess:q,error:Z}]=A(),j=async t=>{var l;if(t.preventDefault(),s({text:"",type:""}),!n){s({text:"Please enter your email address",type:"danger"});return}try{const a=await O(n).unwrap();s({text:a.message||"OTP sent to your email",type:"success"}),y(2)}catch(a){s({text:((l=a.data)==null?void 0:l.message)||"Failed to generate OTP. Please try again.",type:"danger"})}},k=async t=>{var l;if(t.preventDefault(),s({text:"",type:""}),!x){s({text:"Please enter the OTP sent to your email",type:"danger"});return}try{const a=await S({email:n,otp:x}).unwrap();s({text:a.message||"Account unlocked successfully",type:"success"}),setTimeout(()=>{T("/login")},2e3)}catch(a){s({text:((l=a.data)==null?void 0:l.message)||"Invalid or expired OTP. Please try again.",type:"danger"})}};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsx(V,{children:e.jsx(m,{className:"justify-content-center",children:e.jsx(r,{md:8,lg:6,children:e.jsx(G,{children:e.jsx(F,{className:"p-4",children:e.jsxs(I,{children:[e.jsx("h1",{className:"mb-4",children:"Account Unlock"}),p.text&&e.jsx(M,{color:p.type,children:p.text}),h===1&&e.jsxs(b,{onSubmit:j,children:[e.jsx("p",{className:"text-body-secondary mb-4",children:"Enter your email to receive a one-time password that will unlock your account."}),e.jsxs(g,{className:"mb-4",children:[e.jsxs(C,{children:[e.jsx(f,{icon:R})," "]}),e.jsx(N,{type:"email",placeholder:"Email address",autoComplete:"email",value:n,onChange:t=>v(t.target.value),disabled:i,required:!0})]}),e.jsxs(m,{children:[e.jsx(r,{xs:6,children:e.jsx(o,{type:"submit",color:"primary",className:"px-4",disabled:i,children:i?e.jsxs(e.Fragment,{children:[e.jsx(u,{size:"sm",className:"me-2"})," Sending..."]}):"Send OTP"})}),e.jsx(r,{xs:6,className:"text-end",children:e.jsx(L,{to:"/login",children:e.jsx(o,{color:"link",className:"px-0",children:"Back to Login"})})})]})]}),h===2&&e.jsxs(b,{onSubmit:k,children:[e.jsxs("p",{className:"text-body-secondary mb-4",children:["Enter the 6-digit code sent to ",e.jsx("strong",{children:n})]}),e.jsxs(g,{className:"mb-4",children:[e.jsx(C,{children:e.jsx(f,{icon:B})}),e.jsx(N,{type:"text",placeholder:"Enter 6-digit OTP",value:x,onChange:t=>P(t.target.value),disabled:c,maxLength:6,required:!0})]}),e.jsxs(m,{children:[e.jsx(r,{xs:6,children:e.jsx(o,{type:"submit",color:"primary",className:"px-4",disabled:c,children:c?e.jsxs(e.Fragment,{children:[e.jsx(u,{size:"sm",className:"me-2"})," Verifying..."]}):"Verify OTP"})}),e.jsx(r,{xs:6,className:"text-end",children:e.jsx(o,{type:"button",color:"link",className:"px-0",onClick:()=>y(1),disabled:c,children:"Change Email"})})]}),e.jsx(m,{className:"mt-3",children:e.jsx(r,{xs:12,className:"text-center",children:e.jsx(o,{type:"button",color:"link",className:"px-0",onClick:()=>j({preventDefault:()=>{}}),disabled:c||i,children:i?e.jsxs(e.Fragment,{children:[e.jsx(u,{size:"sm",className:"me-2"})," Resending..."]}):"Resend OTP"})})})]})]})})})})})})})};export{$ as default};
