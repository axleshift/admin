import{r as V,_ as D,R as C,d as M,c as A,P as a,a4 as W,j as r,C as q}from"./index-BizKBI6a.js";import{C as j,e as c}from"./index.esm-LX8wyrY9.js";import{C as P}from"./CAlert-CUEFZV7O.js";import{C as k,a as S}from"./CCardBody-cs6hLwSm.js";import{C as G}from"./CCardHeader-CPTDb0Yp.js";import{c as Q}from"./cil-lock-locked-DmxpJbVL.js";import{b as U}from"./CFormInput-BYAzJEzi.js";import{C as J}from"./CTable-D-tPmOjy.js";import{s as N}from"./DefaultLayout-CnpPbvhY.js";import{C as K,a as w}from"./CPaginationItem-B-2D8iv_.js";import"./CCloseButton-CGgGdGd-.js";import"./chatbox-V5kNCwUM.js";import"./cil-magnifying-glass-COgjSVTM.js";import"./index-D8rVyQy1.js";var b=V.forwardRef(function(s,p){var n,t=s.className,m=s.id,o=s.invalid,x=s.label,h=s.reverse,v=s.size,f=s.type,u=f===void 0?"checkbox":f,l=s.valid,d=D(s,["className","id","invalid","label","reverse","size","type","valid"]);return C.createElement("div",{className:M("form-check form-switch",(n={"form-check-reverse":h},n["form-switch-".concat(v)]=v,n["is-invalid"]=o,n["is-valid"]=l,n),t)},C.createElement("input",A({type:u,className:M("form-check-input",{"is-invalid":o,"is-valid":l}),id:m},d,{ref:p})),x&&C.createElement(U,A({customClassName:"form-check-label"},m&&{htmlFor:m}),x))});b.propTypes={className:a.string,id:a.string,invalid:a.bool,label:a.oneOfType([a.string,a.node]),reverse:a.bool,size:a.oneOf(["lg","xl"]),type:a.oneOf(["checkbox","radio"]),valid:a.bool};b.displayName="CFormSwitch";var F=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M471.232,111.731H368V16H144.232v95.731h-103A24.8,24.8,0,0,0,16.464,136.5V470.532A24.8,24.8,0,0,0,41.232,495.3h430A24.8,24.8,0,0,0,496,470.532V136.5A24.8,24.8,0,0,0,471.232,111.731ZM176.232,48H336v63.731H176.232Zm286.232,97.269v80.286l-53.177,53.176H273V232H239.464v46.731H103.177L50,225.555V145.269ZM50,461.764V272.982l39.286,39.287H239.464V359.5H273V312.269H423.178l39.286-39.287V461.764Z' class='ci-primary'/>"],R=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M440,464V16H72V464H16v32H496V464Zm-32,0H272V400H240v64H104V48H408Z' class='ci-primary'/><rect width='32' height='32' x='160' y='304' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='240' y='304' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='320' y='304' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='160' y='208' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='240' y='208' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='320' y='208' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='160' y='112' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='240' y='112' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='320' y='112' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/>"],X=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M327.086,496.89l-142.6-142.6-11.258-11.15-85.6-85.6.054-.054,11.259-11.367,85.5-85.5.054.054,142.6-142.595L424,114.989,281.506,257.483,424,399.978ZM184.64,309.3l11.266,11.159,131.18,131.181,51.658-51.658L236.251,257.483,378.744,114.989,327.086,63.331,184.694,205.725l-.054-.054-51.813,51.812Z' class='ci-primary'/>"],Y=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M183.505,496,86.237,398.73,229.412,255.556,86.237,112.38l97.268-97.27L326.732,158.338l11.316,11.209,85.9,85.9,0,0,.051.05-11.311,11.419-85.9,85.9-.055-.054Zm-52.013-97.27,52.013,52.014L326.629,307.62l.055.054L378.8,255.556l-52.127-52.128-11.308-11.2L183.505,60.366,131.492,112.38,274.667,255.556Z' class='ci-primary'/>"],_=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M238.627,496H192V253.828l-168-200V16H480V53.612l-160,200V414.627ZM224,464h1.373L288,401.373V242.388L443.51,48H60.9L224,242.172Z' class='ci-primary'/>"],O=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M462.541,316.3l-64.344-42.1,24.774-45.418A79.124,79.124,0,0,0,432.093,192V120A103.941,103.941,0,0,0,257.484,43.523L279.232,67a71.989,71.989,0,0,1,120.861,53v72a46.809,46.809,0,0,1-5.215,21.452L355.962,284.8l89.058,58.274a42.16,42.16,0,0,1,19.073,35.421V432h-72v32h104V378.494A74.061,74.061,0,0,0,462.541,316.3Z' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M318.541,348.3l-64.343-42.1,24.773-45.418A79.124,79.124,0,0,0,288.093,224V152A104.212,104.212,0,0,0,184.04,47.866C126.723,47.866,80.093,94.581,80.093,152v72a78,78,0,0,0,9.015,36.775l24.908,45.664L50.047,348.3A74.022,74.022,0,0,0,16.5,410.4L16,496H352.093V410.494A74.061,74.061,0,0,0,318.541,348.3ZM320.093,464H48.186l.31-53.506a42.158,42.158,0,0,1,19.073-35.421l88.682-58.029L117.2,245.452A46.838,46.838,0,0,1,112.093,224V152a72,72,0,1,1,144,0v72a46.809,46.809,0,0,1-5.215,21.452L211.962,316.8l89.058,58.274a42.16,42.16,0,0,1,19.073,35.421Z' class='ci-primary'/>"],$=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M479.6,399.716l-81.084-81.084-62.368-25.767A175.014,175.014,0,0,0,368,192c0-97.047-78.953-176-176-176S16,94.953,16,192,94.953,368,192,368a175.034,175.034,0,0,0,101.619-32.377l25.7,62.2L400.4,478.911a56,56,0,1,0,79.2-79.195ZM48,192c0-79.4,64.6-144,144-144s144,64.6,144,144S271.4,336,192,336,48,271.4,48,192ZM456.971,456.284a24.028,24.028,0,0,1-33.942,0l-76.572-76.572-23.894-57.835L380.4,345.771l76.573,76.572A24.028,24.028,0,0,1,456.971,456.284Z' class='ci-primary'/>"],E=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M473.605,88.081c-1.352-.137-135.958-14.259-199.218-68.251L269.9,16H242.1l-4.488,3.83C174.464,73.727,39.744,87.944,38.4,88.081L24,89.532V104c0,89.133,14.643,165.443,43.523,226.813,38.105,80.973,100.1,133.669,184.267,156.623l4.21,1.148,4.21-1.148c84.165-22.954,146.162-75.65,184.267-156.623C473.357,269.443,488,193.133,488,104V89.532ZM455.87,118.113q-.237,12.789-.948,25.887H272V57.915C331.921,97.482,421.024,113.237,455.87,118.113ZM272,320H414.266A288.233,288.233,0,0,1,390.9,360H272Zm0-32V248H439.9a402.662,402.662,0,0,1-13.236,42.884V288Zm0-72V176H452.378c-1.4,13.307-3.256,26.682-5.639,40ZM56.13,118.113c34.846-4.876,123.949-20.631,183.87-60.2V450.224C94.012,398.389,58.492,245.387,56.13,118.113ZM272,450.224V392h92.347C340.049,416.7,309.708,436.836,272,450.224Z' class='ci-primary'/>"];const xr=()=>{var Z;const{data:s,error:p,isLoading:n}=W(),[t,m]=V.useState(1),[o,x]=V.useState(!0),h=10,v=e=>{switch(e==null?void 0:e.toLowerCase()){case"admin":return"danger";case"manager":return"warning";case"user":return"info";default:return"secondary"}},f=e=>{switch(e==null?void 0:e.toLowerCase()){case"it":return E;case"hr":return O;case"finance":return F;case"marketing":return $;default:return R}},u=e=>{let i="info";return e.includes("delete")||e.includes("admin")?i="danger":e.includes("edit")||e.includes("create")||e.includes("write")?i="warning":(e.includes("view")||e.includes("read"))&&(i="success"),r.jsx(N,{color:i,className:"me-1 mb-1",children:e})};if(n)return r.jsx(j,{className:"d-flex justify-content-center align-items-center",style:{minHeight:"300px"},children:r.jsx(q,{color:"primary"})});if(p)return r.jsx(j,{className:"mt-4",children:r.jsxs(P,{color:"danger",children:["Error: ",p.message]})});const l=o?(Z=s==null?void 0:s.users)==null?void 0:Z.filter(e=>e.permissions&&e.permissions.length>0):s==null?void 0:s.users,d=(l==null?void 0:l.length)||0,H=Math.ceil(d/h),y=t*h,L=y-h,z=(l==null?void 0:l.slice(L,y))||[],g=e=>{m(e)},B=()=>{x(!o),m(1)},I=()=>{const e=[];e.push(r.jsx(w,{disabled:t===1,onClick:()=>g(t-1),children:r.jsx(c,{icon:X})},"prev"));for(let i=1;i<=H;i++)e.push(r.jsx(w,{active:i===t,onClick:()=>g(i),children:i},i));return e.push(r.jsx(w,{disabled:t===H,onClick:()=>g(t+1),children:r.jsx(c,{icon:Y})},"next")),e};return r.jsx(j,{className:"mt-4",children:r.jsxs(k,{className:"mb-4 shadow-sm",children:[r.jsx(G,{className:"bg-primary text-white d-flex align-items-center justify-content-between",children:r.jsxs("div",{className:"d-flex align-items-center",children:[r.jsx(c,{icon:Q,size:"xl",className:"me-2"}),r.jsx("h3",{className:"mb-0",children:"Access Control Review"})]})}),r.jsxs(S,{children:[r.jsxs("div",{className:"mb-3 d-flex align-items-center",children:[r.jsx(c,{icon:_,className:"me-2"}),r.jsx(b,{id:"permissionFilter",label:"Show only users with permissions",checked:o,onChange:B})]}),d>0?r.jsxs(r.Fragment,{children:[r.jsxs(J,{hover:!0,responsive:!0,striped:!0,className:"border",children:[r.jsx("thead",{className:"bg-light",children:r.jsxs("tr",{children:[r.jsxs("th",{children:[r.jsx(c,{icon:O,className:"me-2"}),"Name"]}),r.jsxs("th",{children:[r.jsx(c,{icon:F,className:"me-2"}),"Role"]}),r.jsxs("th",{children:[r.jsx(c,{icon:R,className:"me-2"}),"Department"]}),r.jsxs("th",{children:[r.jsx(c,{icon:E,className:"me-2"}),"Permissions"]})]})}),r.jsx("tbody",{children:z.map(e=>r.jsxs("tr",{children:[r.jsx("td",{className:"align-middle font-weight-bold",children:e.name}),r.jsx("td",{className:"align-middle",children:r.jsx(N,{color:v(e.role),children:e.role})}),r.jsx("td",{className:"align-middle",children:r.jsxs("div",{className:"d-flex align-items-center",children:[r.jsx(c,{icon:f(e.department),className:"me-2"}),e.department]})}),r.jsx("td",{children:r.jsx(k,{className:"border-0 shadow-sm",children:r.jsx(S,{className:"p-3",children:r.jsx("div",{className:"d-flex flex-wrap",children:e.permissions&&e.permissions.length>0?e.permissions.map((i,T)=>r.jsx("div",{className:"me-1 mb-1",children:u(i)},T)):r.jsx(N,{color:"secondary",className:"text-muted",children:"No permissions assigned"})})})})})]},e._id))})]}),r.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-4",children:[r.jsxs("div",{className:"text-muted",children:["Showing ",L+1,"-",Math.min(y,d)," of ",d,o?" users with permissions":" users"]}),r.jsx(K,{"aria-label":"Page navigation",children:I()})]})]}):r.jsx(P,{color:"info",children:o?"No users with permissions found":"No users found"})]})]})})};export{xr as default};
