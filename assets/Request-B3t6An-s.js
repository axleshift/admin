import{r as n,g as A,j as e}from"./index-BizKBI6a.js";import{F as o,d as v,e as U,g as q,h as I,i as F,j as M,k as P,l as E}from"./DefaultLayout-CnpPbvhY.js";import{C as B,a as h,b}from"./index.esm-LX8wyrY9.js";import{C as D,a as L}from"./CCardBody-cs6hLwSm.js";import{C as T}from"./CCardHeader-CPTDb0Yp.js";import{C as $}from"./CForm-tPETyldd.js";import{C as H,a as O}from"./CFormInput-BYAzJEzi.js";import{C as J}from"./CFormCheck-ChI44iH8.js";import"./chatbox-V5kNCwUM.js";import"./cil-magnifying-glass-COgjSVTM.js";import"./CCloseButton-CGgGdGd-.js";import"./index-D8rVyQy1.js";const V=a=>a?a.length<=2?"*".repeat(a.length):`${a[0]}${"*".repeat(a.length-2)}${a[a.length-1]}`:"",W=[{category:"HR",icon:U,permissions:[{key:"/worker",label:"Employees"},{key:"/jobposting",label:"Job Postings"},{key:"/payroll",label:"Payroll Management"}]},{category:"Finance",icon:q,permissions:[{key:"/freight/transaction",label:"Transactions"},{key:"/invoice",label:"Invoicing"},{key:"/financialanalytics",label:"Financial Analytics"},{key:"/oversales",label:"Oversales"},{key:"/freightaudit",label:"Freight Audit"}]},{category:"Logistics",icon:I,permissions:[{key:"/freight/transaction",label:"Freight Transactions"},{key:"/logistic1/index",label:"Logistics Index"}]},{category:"Core",icon:F,permissions:[{key:"/customer",label:"Customer"},{key:"/monthly",label:"Monthly"},{key:"/daily",label:"Daily"},{key:"/breakdown",label:"Breakdown"},{key:"/shipment",label:"Shipment Management"}]},{category:"Administrative",icon:M,permissions:[{key:"/useractivity/index",label:"User Activity"},{key:"/announce",label:"Announcements"},{key:"/recovery",label:"Recovery"},{key:"/registernew",label:"New User Registration"},{key:"/PendingRequest",label:"Pending Requests"},{key:"/AccessReview",label:"Access Review"},{key:"/monitoring",label:"User Monitoring"},{key:"/restore",label:"System Restore"}]}],ne=()=>{const[a,m]=n.useState([]),[c,p]=n.useState(""),[d,f]=n.useState(""),[g,k]=n.useState(""),[x,C]=n.useState(""),[r,i]=n.useState(null),[u,j]=n.useState({}),[S,{isLoading:y}]=A();n.useEffect(()=>{const s=sessionStorage.getItem("userId"),t=sessionStorage.getItem("name"),l=sessionStorage.getItem("department");s&&(p(s),C(V(s))),t&&f(t),l&&k(l)},[]);const N=s=>{m(t=>t.includes(s)?t.filter(l=>l!==s):[...t,s])},R=s=>{j(t=>({...t,[s]:!t[s]}))},w=async()=>{var s;if(i(null),!c||!d||!g||a.length===0){i({success:!1,message:"Ensure all fields are filled and at least one permission is selected."});return}try{const t=await S({requestType:"AccessRequest",pageName:a[0]||"",name:d,department:g,username:c,requestDetails:{permissions:a}}).unwrap();i({success:!0,message:"Access request sent successfully!"}),m([])}catch(t){i({success:!1,message:((s=t.data)==null?void 0:s.error)||"Failed to send request"})}};return e.jsx(B,{className:"vh-100 d-flex align-items-center justify-content-center bg-light",children:e.jsx(h,{className:"w-100 justify-content-center",children:e.jsx(b,{md:10,lg:12,children:e.jsxs(D,{className:"shadow-lg",children:[e.jsxs(T,{className:"bg-primary text-white d-flex align-items-center",children:[e.jsx(o,{icon:v,className:"me-2"}),e.jsx("strong",{children:"Access Request"})]}),e.jsx(L,{children:e.jsxs($,{children:[e.jsx(H,{type:"text",label:"User ID",value:x,readOnly:!0,className:"bg-light"}),e.jsx("label",{className:"form-label mt-3",children:"Select Permissions"}),W.map(s=>e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center bg-light p-2 rounded cursor-pointer",onClick:()=>R(s.category),children:[e.jsxs("div",{children:[e.jsx(o,{icon:s.icon,className:"me-2 text-primary"}),e.jsx("strong",{children:s.category})]}),e.jsx("span",{children:u[s.category]?"▼":"►"})]}),u[s.category]&&e.jsx(h,{className:"mt-2",children:s.permissions.map(t=>e.jsx(b,{xs:6,md:4,className:"mb-2",children:e.jsx(J,{id:t.key,label:t.label,checked:a.includes(t.key),onChange:()=>N(t.key)})},t.key))})]},s.category)),r&&e.jsxs("div",{className:`alert ${r.success?"alert-success":"alert-danger"} d-flex align-items-center`,children:[e.jsx(o,{icon:r.success?P:E,className:"me-2"}),r.message]}),e.jsx(O,{color:"primary",className:"w-100 mt-3",onClick:w,disabled:y||!c,children:y?"Sending Request...":"Submit Access Request"})]})})]})})})})};export{ne as default};
