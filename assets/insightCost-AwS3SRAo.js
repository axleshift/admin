import{j as s}from"./index-Bb-Hm6Ev.js";import{r as m}from"./vendor-react-BHxUanFt.js";import{a as A}from"./axiosInstance-Bq-uIJjs.js";import{F as c,B as z,H as E,h as V,a4 as W,$ as q,C as M,a0 as L,a1 as p,a2 as S,a3 as H}from"./index-a-IrBYvB.js";import{a as h,b as i,d as C,n as v,l as I,e as w,m as P,g as J,_ as F,q as R,p as N,w as O,x as U,y as D,z as y,A as _,B as d,$ as G}from"./vendor-coreui-T9QyU9K3.js";import"./vendor-redux-CSji-Y9p.js";import"./index-xsH4HHeE.js";const ls=()=>{const[x,T]=m.useState(null),[j,f]=m.useState(!0),[b,$]=m.useState(null),[g,K]=m.useState("6months");m.useEffect(()=>{(async()=>{var a;try{f(!0);const r=await A.get(`/core/insight/cost?timeframe=${g}`);T(r.data)}catch(r){$(((a=r.response)==null?void 0:a.data)||"Failed to fetch data")}finally{f(!1)}})()},[g]);const e=(()=>{if(!x)return null;const t=typeof x=="string"?JSON.parse(x):x;return{labels:t.labels||[],data:t.data||[]}})(),n=e?e.data.reduce((t,a)=>t+a,0):0,k=e?Math.max(...e.data,1):1,l=t=>{if(!e||t===0)return null;const a=e.data[t],r=e.data[t-1];return r===0?null:(a-r)/r*100},o=t=>t===null?"secondary":t>0?"danger":t<0?"success":"info",u=t=>t===null?p:t>0?S:t<0?H:p,B=()=>{(async()=>{var a;try{f(!0);const r=await A.get(`/core/insight/cost?timeframe=${g}`);T(r.data)}catch(r){$(((a=r.response)==null?void 0:a.data)||"Failed to fetch data")}finally{f(!1)}})()};return s.jsx("div",{className:"bg-body min-vh-100 d-flex flex-column",children:s.jsx("div",{className:"py-4",children:s.jsx(h,{children:s.jsx(i,{md:12,children:s.jsxs(C,{className:"mb-4 shadow-sm",children:[s.jsxs(v,{className:"d-flex justify-content-between align-items-center py-3 border-bottom text-body-emphasis",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"mb-0 text-body-emphasis",children:[s.jsx(c,{icon:z,className:"me-2 text-success"}),"Cost Insights"]}),s.jsx("small",{className:"text-body-secondary",children:"Track and analyze your monthly expenditures"})]}),s.jsx("div",{className:"d-flex gap-2",children:s.jsxs(I,{color:"primary",onClick:B,disabled:j,children:[s.jsx(c,{icon:E,className:j?"fa-spin me-2":"me-2"}),"Refresh"]})})]}),s.jsxs(w,{className:"p-4",children:[j&&s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"300px"},children:s.jsxs("div",{className:"text-center",children:[s.jsx(P,{color:"primary",style:{width:"3rem",height:"3rem"}}),s.jsx("p",{className:"mt-3 text-body-secondary",children:"Loading cost data..."})]})}),b&&s.jsxs(J,{color:"danger",className:"d-flex align-items-center",children:[s.jsx(c,{icon:V,className:"me-3 fs-4"}),s.jsxs("div",{children:[s.jsx("h4",{className:"alert-heading",children:"Data Fetch Error"}),s.jsx("p",{className:"mb-0",children:b}),s.jsxs(I,{color:"danger",variant:"ghost",size:"sm",className:"mt-2",onClick:B,children:[s.jsx(c,{icon:E,className:"me-1"})," Try Again"]})]})]}),e&&!j&&!b&&s.jsxs(s.Fragment,{children:[s.jsxs(h,{className:"mb-4",children:[s.jsx(i,{lg:4,md:6,className:"mb-4",children:s.jsx(F,{color:"info",className:"h-100",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"p-3 bg-info bg-opacity-25 rounded-circle me-3",children:s.jsx(c,{icon:z,size:"2x",className:"text-info"})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-body-secondary small",children:"Total Cost"}),s.jsxs("div",{className:"fs-3 fw-bold text-body-emphasis",children:["₱",n.toFixed(2)]})]})]})})}),s.jsx(i,{lg:4,md:6,className:"mb-4",children:s.jsx(F,{color:"primary",className:"h-100",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"p-3 bg-primary bg-opacity-25 rounded-circle me-3",children:s.jsx(c,{icon:W,size:"2x",className:"text-primary"})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-body-secondary small",children:"Average Monthly Cost"}),s.jsxs("div",{className:"fs-3 fw-bold text-body-emphasis",children:["₱",e.data.length>0?(n/e.data.length).toFixed(2):"0.00"]})]})]})})}),s.jsx(i,{lg:4,md:12,className:"mb-4",children:e.data.length>=2&&s.jsx(F,{color:o(l(e.data.length-1)),className:"h-100",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:`p-3 bg-${o(l(e.data.length-1))} bg-opacity-25 rounded-circle me-3`,children:s.jsx(c,{icon:u(l(e.data.length-1)),size:"2x",className:`text-${o(l(e.data.length-1))}`})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-body-secondary small",children:"Month-over-Month Change"}),s.jsx("div",{className:"fs-3 fw-bold text-body-emphasis",children:l(e.data.length-1)!==null?`${l(e.data.length-1)>0?"+":""}${l(e.data.length-1).toFixed(1)}%`:""})]})]})})})]}),s.jsx(h,{className:"mb-4",children:s.jsx(i,{md:12,children:s.jsxs(C,{className:"shadow-sm",children:[s.jsx(v,{className:"border-bottom d-flex justify-content-between align-items-center py-3 text-body-emphasis",children:s.jsxs("h4",{className:"mb-0",children:[s.jsx(c,{icon:q,className:"me-2 text-primary"}),"Monthly Cost Breakdown"]})}),s.jsx(w,{className:"p-4",children:s.jsx("div",{className:"px-3",children:s.jsx(h,{className:"align-items-end g-0",style:{height:"250px"},children:e.data.map((t,a)=>s.jsx(i,{className:"px-1 text-center",children:s.jsxs("div",{className:"d-flex flex-column align-items-center",children:[s.jsxs("small",{className:"mb-2 fw-bold text-body-emphasis",children:["$",t.toFixed(2)]}),s.jsx("div",{style:{width:"100%",height:`${t/k*80}%`,minHeight:t>0?"20px":"4px"},children:s.jsx(R,{value:100,color:a===e.data.length-1?"primary":"success",className:"h-100 shadow-sm",style:{minWidth:"30px",borderRadius:"4px"}})}),s.jsxs("small",{className:"mt-2 text-body-secondary",children:[s.jsx(c,{icon:M,className:"me-1"}),e.labels[a]]}),a>0&&s.jsxs(N,{color:o(l(a)),shape:"rounded-pill",className:"mt-1",children:[s.jsx(c,{icon:u(l(a)),className:"me-1",size:"xs"}),l(a)!==null?`${l(a).toFixed(1)}%`:""]})]})},a))})})})]})})}),s.jsx(h,{children:s.jsx(i,{md:12,children:s.jsxs(C,{className:"shadow-sm",children:[s.jsx(v,{className:"border-bottom d-flex justify-content-between align-items-center py-3 text-body-emphasis",children:s.jsxs("h4",{className:"mb-0",children:[s.jsx(c,{icon:L,className:"me-2 text-primary"}),"Cost Details"]})}),s.jsx(w,{className:"p-0",children:s.jsxs(O,{hover:!0,responsive:!0,className:"mb-0 border-0",children:[s.jsx(U,{children:s.jsxs(D,{children:[s.jsx(y,{children:"Month"}),s.jsx(y,{className:"text-end",children:"Cost (₱)"}),s.jsx(y,{className:"text-end",children:"% of Total"}),s.jsx(y,{className:"text-end",children:"Change"})]})}),s.jsx(_,{children:e.labels.map((t,a)=>s.jsxs(D,{children:[s.jsx(d,{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"p-2 me-2 bg-body-tertiary rounded",children:s.jsx(c,{icon:M,className:"text-primary"})}),s.jsx("span",{className:"fw-medium text-body-emphasis",children:t})]})}),s.jsxs(d,{className:"text-end fw-bold text-body-emphasis",children:["₱",e.data[a].toFixed(2)]}),s.jsx(d,{className:"text-end",children:s.jsxs("div",{className:"d-flex align-items-center justify-content-end",children:[s.jsx("span",{className:"me-2 text-body-emphasis",children:n>0?`${(e.data[a]/n*100).toFixed(1)}%`:"0%"}),s.jsx(R,{value:n>0?e.data[a]/n*100:0,color:"success",className:"flex-grow-1",style:{maxWidth:"100px",height:"8px"}})]})}),s.jsx(d,{className:"text-end",children:a>0?s.jsxs(N,{color:o(l(a)),shape:"rounded-pill",children:[s.jsx(c,{icon:u(l(a)),className:"me-1"}),l(a)!==null?`${l(a).toFixed(1)}%`:""]}):s.jsxs(N,{color:"secondary",shape:"rounded-pill",children:[s.jsx(c,{icon:p,className:"me-1"})," Base"]})})]},a))}),s.jsx(G,{children:s.jsxs(D,{children:[s.jsx(d,{className:"fw-bold text-body-emphasis",children:"Total"}),s.jsxs(d,{className:"fw-bold text-end text-body-emphasis",children:["₱",n.toFixed(2)]}),s.jsx(d,{className:"fw-bold text-end text-body-emphasis",children:"100%"}),s.jsx(d,{className:"text-end",children:e.data.length>=2&&s.jsxs(N,{color:e.data[e.data.length-1]>e.data[0]?"danger":e.data[e.data.length-1]<e.data[0]?"success":"info",shape:"rounded-pill",children:[s.jsx(c,{icon:e.data[e.data.length-1]>e.data[0]?S:e.data[e.data.length-1]<e.data[0]?H:p,className:"me-1"}),e.data[0]!==0?`${((e.data[e.data.length-1]-e.data[0])/e.data[0]*100).toFixed(1)}%`:""]})})]})})]})})]})})})]})]})]})})})})})};export{ls as default};
