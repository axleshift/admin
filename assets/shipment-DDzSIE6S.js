import{j as e}from"./index-DPEaZ_iK.js";import{r as u,R as A}from"./vendor-react-BHxUanFt.js";import{F as g,h as M,n as D,p as W,r as O,i as G,z as J}from"./index-BHkgY7kg.js";import{a as q}from"./axiosInstance-Bq-uIJjs.js";import{l}from"./activityLogger-D6Lc4RsL.js";import{G as C,d as S,e as b,m as K,n as Q,r as X,s as Y,t as P,u as d,v as Z,w as h,p as B,W as ee,U as te,V as k,D as se,E as ae,F as ne}from"./vendor-coreui-DaIzHuu_.js";import"./vendor-redux-CSji-Y9p.js";import"./index-xsH4HHeE.js";const ue=()=>{const[p,_]=u.useState([]),[E,y]=u.useState(!0),[F,$]=u.useState(null),[r,L]=u.useState(1),x=10,[j,R]=u.useState(null),f=A.useRef(),s=localStorage.getItem("name"),a=localStorage.getItem("role"),n=localStorage.getItem("department"),c=localStorage.getItem("userId");localStorage.getItem("username"),JSON.parse(localStorage.getItem("permissions")||"[]"),l({name:s,role:a,department:n,route:"Shipment Table",action:"Page Visit",description:`${s} visit the Shipment Table page`}).catch(console.warn);const I=(t,m,o)=>{R(e.jsxs(se,{autohide:!0,delay:5e3,children:[e.jsxs(ae,{closeButton:!0,children:[e.jsx(g,{icon:o==="success"?G:J,className:"me-2"}),e.jsx("strong",{className:`me-auto text-${o}`,children:t})]}),e.jsx(ne,{children:m})]}))};u.useEffect(()=>{(async()=>{var m;try{y(!0),c&&s&&a&&n&&l({name:s,role:a,department:n,route:"/freight-table",action:"Fetch Shipments",description:"User accessed freight shipment data"}).catch(console.warn);const T=((m=(await q.get("/core/fetch-core")).data)==null?void 0:m.data)||[];_(T),y(!1),I("Data Loaded",`Successfully loaded ${T.length} shipments`,"success"),c&&s&&a&&n&&l({name:s,role:a,department:n,route:"/freight-table",action:"Shipments Loaded",description:`Successfully loaded ${T.length} shipments`}).catch(console.warn)}catch(o){$(o.message||"Failed to fetch shipment data"),y(!1),I("Error Loading Data",o.message||"Failed to fetch shipment data","danger"),c&&s&&a&&n&&l({name:s,role:a,department:n,route:"/freight-table",action:"Shipments Load Failed",description:`Error fetching shipments: ${o.message}`}).catch(console.warn)}})()},[c,s,a,n]);const w=Math.ceil(p.length/x),N=t=>{L(t),c&&s&&a&&n&&l({name:s,role:a,department:n,route:"/freight-table",action:"Pagination",description:`User navigated to page ${t} of shipments`}).catch(console.warn)},H=()=>{const t=(r-1)*x,m=t+x;return p.slice(t,m)};if(E)return e.jsxs(e.Fragment,{children:[e.jsx(C,{ref:f,push:j,placement:"top-end"}),e.jsx(S,{children:e.jsxs(b,{className:"text-center",children:[e.jsx(K,{color:"primary"}),e.jsx("p",{className:"mt-2",children:"Loading Shipments..."})]})})]});if(F)return e.jsxs(e.Fragment,{children:[e.jsx(C,{ref:f,push:j,placement:"top-end"}),e.jsx(S,{className:"text-danger",children:e.jsxs(b,{className:"text-center",children:[e.jsx(g,{icon:M,size:"3x",className:"mb-3"}),e.jsx("p",{children:F})]})})]});if(p.length===0)return e.jsxs(e.Fragment,{children:[e.jsx(C,{ref:f,push:j,placement:"top-end"}),e.jsx(S,{children:e.jsxs(b,{className:"text-center",children:[e.jsx(g,{icon:D,size:"3x",className:"mb-3"}),e.jsx("p",{children:"No Shipments Found"})]})})]});const U=t=>{switch(t){case"to_pay":return"warning";case"cancelled":return"danger";case"delivered":return"success";case"in_transit":return"info";case"processing":return"primary";default:return"secondary"}},V=t=>{c&&s&&a&&n&&l({name:s,role:a,department:n,route:"/freight-table",action:"View Shipment Details",description:`Viewed details for shipment ${t.tracking_number}`}).catch(console.warn)},i=t=>{c&&s&&a&&n&&l({name:s,role:a,department:n,route:"/freight-table",action:"Sort Shipments",description:`User sorted shipments by ${t}`}).catch(console.warn)},z=H(),v=[];for(let t=1;t<=w;t++)v.push(e.jsx(k,{active:t===r,onClick:()=>N(t),children:t},t));return e.jsxs(e.Fragment,{children:[e.jsx(C,{ref:f,push:j,placement:"top-end"}),e.jsxs(S,{children:[e.jsxs(Q,{children:[e.jsx(g,{icon:D,className:"me-2"}),"Shipment List"]}),e.jsx(b,{children:e.jsxs(X,{hover:!0,responsive:!0,children:[e.jsx(Y,{children:e.jsxs(P,{children:[e.jsx(d,{onClick:()=>i("tracking_number"),children:"Tracking Number"}),e.jsx(d,{onClick:()=>i("country"),children:"Country"}),e.jsx(d,{onClick:()=>i("type"),children:"Type"}),e.jsx(d,{onClick:()=>i("status"),children:"Status"}),e.jsx(d,{onClick:()=>i("weight"),children:"Weight"}),e.jsx(d,{onClick:()=>i("items"),children:"Items"}),e.jsx(d,{onClick:()=>i("amount"),children:"Amount"})]})}),e.jsx(Z,{children:z.map(t=>e.jsxs(P,{onClick:()=>V(t),style:{cursor:"pointer"},children:[e.jsx(h,{children:t.tracking_number}),e.jsx(h,{children:t.country}),e.jsx(h,{children:e.jsx(B,{color:t.type==="business"?"info":"primary",children:t.type})}),e.jsx(h,{children:e.jsx(B,{color:U(t.status),children:t.status})}),e.jsxs(h,{children:[e.jsx(g,{icon:W,className:"me-1"}),t.total_weight," kg"]}),e.jsx(h,{children:t.number_of_items}),e.jsxs(h,{children:[e.jsx(g,{icon:O,className:"me-1"}),t.amount.value," ",t.amount.currency]})]},t._id))})]})}),w>1&&e.jsxs(ee,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"small text-muted",children:["Showing ",(r-1)*x+1," to ",Math.min(r*x,p.length)," of ",p.length," shipments"]}),e.jsxs(te,{"aria-label":"Shipment navigation",children:[e.jsx(k,{"aria-label":"Previous",disabled:r===1,onClick:()=>N(r-1),children:e.jsx("span",{"aria-hidden":"true",children:"«"})}),v,e.jsx(k,{"aria-label":"Next",disabled:r===w,onClick:()=>N(r+1),children:e.jsx("span",{"aria-hidden":"true",children:"»"})})]})]})]})]})};export{ue as default};
