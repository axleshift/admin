import{o as b,p as k,q as N,r as l,j as e,c as d,F as E,s as O}from"./index-CKcFKU7h.js";import{C as A}from"./customhead-DMsH-ZQR.js";import{E as L}from"./exceljs.min-CEW4BVYH.js";import{F as _}from"./FileSaver.min-BD8au5Tn.js";import{C as U}from"./index.esm-DAwbp2WG.js";import{C as p}from"./CRow-6GBEGtvd.js";import{C as V}from"./CCol-Bfnlt4mm.js";import{C as B,a as F,b as x,c as a,d as I,e as s}from"./CTable-KMmU-9g7.js";import{C as R}from"./DefaultLayout-Xwng9yPx.js";import{C as M}from"./CFormSelect-BKkxLTOG.js";import"./CCardTitle-DlzJVczk.js";import"./CCardText-BWRHRdk1.js";import"./ex-CELXs5B0.js";const ee=()=>{const{data:i,error:c,isLoading:D}=b(),[j]=k(),[y]=N(),[u,f]=l.useState({}),[C,m]=l.useState(!1),[S,h]=l.useState(!1),w=async t=>{m(!0);try{const r=u[t]||"Pending";await j({id:t,status:r,deliveryDate:r==="Delivered"?new Date:null}),alert("Shipping status updated successfully!")}catch{alert("Error updating shipping status.")}finally{m(!1)}},g=async t=>{if(window.confirm("Are you sure you want to delete this shipping entry?")){h(!0);try{await y(t),alert("Shipping entry deleted successfully!")}catch{alert("Error deleting shipping entry.")}finally{h(!1)}}},v=async()=>{if(!i)return;const t=new L.Workbook,r=t.addWorksheet("Transactions");r.columns=[{header:"Customer Name",key:"CustomerName",width:20},{header:"Order Volume (kg)",key:"OrderVolume",width:15},{header:"Shipping Type",key:"ShippingType",width:15},{header:"Order Date",key:"OrderDate",width:20},{header:"Status",key:"Status",width:15},{header:"Delivery Date",key:"DeliveryDate",width:20}],i.forEach(n=>{r.addRow({CustomerName:n.customerName,OrderVolume:`${n.orderVolume} kg`,ShippingType:n.shippingType,OrderDate:new Date(n.orderDate).toLocaleDateString(),Status:n.status,DeliveryDate:n.deliveryDate?new Date(n.deliveryDate).toLocaleString():"N/A"})});const o=await t.xlsx.writeBuffer(),T=new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});_.saveAs(T,"shipping_transactions.xlsx")};return D?e.jsx("p",{children:"Loading..."}):c?e.jsxs("p",{children:["Error loading shipping data: ",c.message]}):e.jsxs(U,{m:"1.5rem 2.5rem",children:[e.jsx(p,{children:e.jsx(A,{title:"TRANSACTIONS",subtitle:"List of Transactions"})}),e.jsx(p,{className:"p-2",children:e.jsx(V,{xs:"auto",children:e.jsx(d,{color:"Gray",onClick:v,children:e.jsx(E,{icon:O})})})}),e.jsxs(B,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[e.jsx(F,{children:e.jsxs(x,{children:[e.jsx(a,{children:"Customer Name"}),e.jsx(a,{children:"Order Volume (kg)"}),e.jsx(a,{children:"Shipping Type"}),e.jsx(a,{children:"Order Date"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Delivery Date"}),e.jsx(a,{children:"Update Status"}),e.jsx(a,{children:"Actions"})]})}),e.jsx(I,{children:i&&i.map(t=>e.jsxs(x,{children:[e.jsx(s,{children:t.customerName}),e.jsx(s,{children:t.orderVolume}),e.jsx(s,{children:t.shippingType}),e.jsx(s,{children:new Date(t.orderDate).toLocaleDateString()}),e.jsx(s,{children:e.jsx(R,{color:t.status==="Delivered"?"success":"warning",children:t.status})}),e.jsx(s,{children:t.deliveryDate?new Date(t.deliveryDate).toLocaleDateString():"N/A"}),e.jsx(s,{children:e.jsxs(M,{"aria-label":"Select Shipping Status",value:u[t._id]||t.status,onChange:r=>f(o=>({...o,[t._id]:r.target.value})),children:[e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"In Transit",children:"In Transit"}),e.jsx("option",{value:"Delivered",children:"Delivered"}),e.jsx("option",{value:"Cancelled",children:"Cancelled"})]})}),e.jsxs(s,{children:[e.jsx(d,{color:"warning",size:"sm",onClick:()=>w(t._id),disabled:C,children:"Update"}),e.jsx(d,{color:"danger",size:"sm",className:"ms-2",onClick:()=>g(t._id),disabled:S,children:"Delete"})]})]},t._id))})]})]})};export{ee as default};
