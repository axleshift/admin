import{P as O,j as e}from"./index-HAz-9vrD.js";import{r as m}from"./vendor-react-B6URQkMn.js";import{c as g,C as B,R as V,k as N,a1 as T,o as a,l as H,af as W,X as G,y as f,aa as $,ab as y}from"./vendor-coreui-BGyit7oL.js";import{l as d}from"./activityLogger-DIotgneL.js";import{c as q}from"./cil-lock-locked-DmxpJbVL.js";import"./vendor-redux-DipIbRRz.js";import"./axiosInstance-CnxFScdD.js";import"./index-D8rVyQy1.js";var L=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M471.232,111.731H368V16H144.232v95.731h-103A24.8,24.8,0,0,0,16.464,136.5V470.532A24.8,24.8,0,0,0,41.232,495.3h430A24.8,24.8,0,0,0,496,470.532V136.5A24.8,24.8,0,0,0,471.232,111.731ZM176.232,48H336v63.731H176.232Zm286.232,97.269v80.286l-53.177,53.176H273V232H239.464v46.731H103.177L50,225.555V145.269ZM50,461.764V272.982l39.286,39.287H239.464V359.5H273V312.269H423.178l39.286-39.287V461.764Z' class='ci-primary'/>"],Z=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M440,464V16H72V464H16v32H496V464Zm-32,0H272V400H240v64H104V48H408Z' class='ci-primary'/><rect width='32' height='32' x='160' y='304' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='240' y='304' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='320' y='304' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='160' y='208' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='240' y='208' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='320' y='208' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='160' y='112' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='240' y='112' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='320' y='112' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/>"],z=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M327.086,496.89l-142.6-142.6-11.258-11.15-85.6-85.6.054-.054,11.259-11.367,85.5-85.5.054.054,142.6-142.595L424,114.989,281.506,257.483,424,399.978ZM184.64,309.3l11.266,11.159,131.18,131.181,51.658-51.658L236.251,257.483,378.744,114.989,327.086,63.331,184.694,205.725l-.054-.054-51.813,51.812Z' class='ci-primary'/>"],J=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M183.505,496,86.237,398.73,229.412,255.556,86.237,112.38l97.268-97.27L326.732,158.338l11.316,11.209,85.9,85.9,0,0,.051.05-11.311,11.419-85.9,85.9-.055-.054Zm-52.013-97.27,52.013,52.014L326.629,307.62l.055.054L378.8,255.556l-52.127-52.128-11.308-11.2L183.505,60.366,131.492,112.38,274.667,255.556Z' class='ci-primary'/>"],Q=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M238.627,496H192V253.828l-168-200V16H480V53.612l-160,200V414.627ZM224,464h1.373L288,401.373V242.388L443.51,48H60.9L224,242.172Z' class='ci-primary'/>"],A=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M462.541,316.3l-64.344-42.1,24.774-45.418A79.124,79.124,0,0,0,432.093,192V120A103.941,103.941,0,0,0,257.484,43.523L279.232,67a71.989,71.989,0,0,1,120.861,53v72a46.809,46.809,0,0,1-5.215,21.452L355.962,284.8l89.058,58.274a42.16,42.16,0,0,1,19.073,35.421V432h-72v32h104V378.494A74.061,74.061,0,0,0,462.541,316.3Z' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M318.541,348.3l-64.343-42.1,24.773-45.418A79.124,79.124,0,0,0,288.093,224V152A104.212,104.212,0,0,0,184.04,47.866C126.723,47.866,80.093,94.581,80.093,152v72a78,78,0,0,0,9.015,36.775l24.908,45.664L50.047,348.3A74.022,74.022,0,0,0,16.5,410.4L16,496H352.093V410.494A74.061,74.061,0,0,0,318.541,348.3ZM320.093,464H48.186l.31-53.506a42.158,42.158,0,0,1,19.073-35.421l88.682-58.029L117.2,245.452A46.838,46.838,0,0,1,112.093,224V152a72,72,0,1,1,144,0v72a46.809,46.809,0,0,1-5.215,21.452L211.962,316.8l89.058,58.274a42.16,42.16,0,0,1,19.073,35.421Z' class='ci-primary'/>"],X=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M479.6,399.716l-81.084-81.084-62.368-25.767A175.014,175.014,0,0,0,368,192c0-97.047-78.953-176-176-176S16,94.953,16,192,94.953,368,192,368a175.034,175.034,0,0,0,101.619-32.377l25.7,62.2L400.4,478.911a56,56,0,1,0,79.2-79.195ZM48,192c0-79.4,64.6-144,144-144s144,64.6,144,144S271.4,336,192,336,48,271.4,48,192ZM456.971,456.284a24.028,24.028,0,0,1-33.942,0l-76.572-76.572-23.894-57.835L380.4,345.771l76.573,76.572A24.028,24.028,0,0,1,456.971,456.284Z' class='ci-primary'/>"],M=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M473.605,88.081c-1.352-.137-135.958-14.259-199.218-68.251L269.9,16H242.1l-4.488,3.83C174.464,73.727,39.744,87.944,38.4,88.081L24,89.532V104c0,89.133,14.643,165.443,43.523,226.813,38.105,80.973,100.1,133.669,184.267,156.623l4.21,1.148,4.21-1.148c84.165-22.954,146.162-75.65,184.267-156.623C473.357,269.443,488,193.133,488,104V89.532ZM455.87,118.113q-.237,12.789-.948,25.887H272V57.915C331.921,97.482,421.024,113.237,455.87,118.113ZM272,320H414.266A288.233,288.233,0,0,1,390.9,360H272Zm0-32V248H439.9a402.662,402.662,0,0,1-13.236,42.884V288Zm0-72V176H452.378c-1.4,13.307-3.256,26.682-5.639,40ZM56.13,118.113c34.846-4.876,123.949-20.631,183.87-60.2V450.224C94.012,398.389,58.492,245.387,56.13,118.113ZM272,450.224V392h92.347C340.049,416.7,309.708,436.836,272,450.224Z' class='ci-primary'/>"];const ce=()=>{var C;const{data:l,error:h,isLoading:k}=O(),[c,v]=m.useState(1),[t,U]=m.useState(!0),[i,b]=m.useState(null),p=10;m.useEffect(()=>{try{const r=localStorage.getItem("currentUser");if(r){const s=JSON.parse(r);b(s),d({name:s.name||"Unknown User",role:s.role||"Unknown Role",department:s.department||"Unknown Department",route:"admin/access-review",action:"VIEW",description:"Accessed permission review page"})}}catch(r){console.error("Failed to get current user:",r)}},[]);const P=r=>{switch(r==null?void 0:r.toLowerCase()){case"admin":return"danger";case"manager":return"warning";case"user":return"info";default:return"secondary"}},R=r=>{switch(r==null?void 0:r.toLowerCase()){case"it":return M;case"hr":return A;case"finance":return L;case"marketing":return X;default:return Z}},S=r=>{let s="info";return r.includes("delete")||r.includes("admin")?s="danger":r.includes("edit")||r.includes("create")||r.includes("write")?s="warning":(r.includes("view")||r.includes("read"))&&(s="success"),e.jsx(f,{color:s,className:"me-1 mb-1",children:r})};if(k)return e.jsx(g,{className:"d-flex justify-content-center align-items-center",style:{minHeight:"300px"},children:e.jsx(B,{color:"primary"})});if(h)return i&&d({name:i.name||"Unknown User",role:i.role||"Unknown Role",department:i.department||"Unknown Department",route:"admin/access-review",action:"ERROR",description:`Error loading permissions: ${h.message}`}),e.jsx(g,{className:"mt-4",children:e.jsxs(V,{color:"danger",children:["Error: ",h.message]})});const n=t?(C=l==null?void 0:l.users)==null?void 0:C.filter(r=>r.permissions&&r.permissions.length>0):l==null?void 0:l.users,o=(n==null?void 0:n.length)||0,j=Math.ceil(o/p),u=c*p,w=u-p,F=(n==null?void 0:n.slice(w,u))||[],x=r=>{r!==c&&(v(r),i&&d({name:i.name||"Unknown User",role:i.role||"Unknown Role",department:i.department||"Unknown Department",route:"admin/access-review",action:"NAVIGATE",description:`Changed to page ${r} of users list`}))},E=()=>{const r=!t;U(r),v(1),i&&d({name:i.name||"Unknown User",role:i.role||"Unknown Role",department:i.department||"Unknown Department",route:"admin/access-review",action:"FILTER",description:r?"Filtered to show only users with permissions":"Removed filter to show all users"})},I=()=>{const r=[];r.push(e.jsx(y,{disabled:c===1,onClick:()=>x(c-1),children:e.jsx(a,{icon:z})},"prev"));for(let s=1;s<=j;s++)r.push(e.jsx(y,{active:s===c,onClick:()=>x(s),children:s},s));return r.push(e.jsx(y,{disabled:c===j,onClick:()=>x(c+1),children:e.jsx(a,{icon:J})},"next")),r};return e.jsx(g,{className:"mt-4",children:e.jsxs(N,{className:"mb-4 shadow-sm",children:[e.jsx(T,{className:"bg-primary text-white d-flex align-items-center justify-content-between",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(a,{icon:q,size:"xl",className:"me-2"}),e.jsx("h3",{className:"mb-0",children:"Access Control Review"})]})}),e.jsxs(H,{children:[e.jsxs("div",{className:"mb-3 d-flex align-items-center",children:[e.jsx(a,{icon:Q,className:"me-2"}),e.jsx(W,{id:"permissionFilter",label:"Show only users with permissions",checked:t,onChange:E})]}),o>0?e.jsxs(e.Fragment,{children:[e.jsxs(G,{hover:!0,responsive:!0,striped:!0,className:"border",children:[e.jsx("thead",{className:"bg-light",children:e.jsxs("tr",{children:[e.jsxs("th",{children:[e.jsx(a,{icon:A,className:"me-2"}),"Name"]}),e.jsxs("th",{children:[e.jsx(a,{icon:L,className:"me-2"}),"Role"]}),e.jsxs("th",{children:[e.jsx(a,{icon:Z,className:"me-2"}),"Department"]}),e.jsxs("th",{children:[e.jsx(a,{icon:M,className:"me-2"}),"Permissions"]})]})}),e.jsx("tbody",{children:F.map(r=>e.jsxs("tr",{children:[e.jsx("td",{className:"align-middle font-weight-bold",children:r.name}),e.jsx("td",{className:"align-middle",children:e.jsx(f,{color:P(r.role),children:r.role})}),e.jsx("td",{className:"align-middle",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(a,{icon:R(r.department),className:"me-2"}),r.department]})}),e.jsx("td",{children:e.jsx(N,{className:"border-0 shadow-sm",children:e.jsx(H,{className:"p-3",children:e.jsx("div",{className:"d-flex flex-wrap",children:r.permissions&&r.permissions.length>0?r.permissions.map((s,D)=>e.jsx("div",{className:"me-1 mb-1",children:S(s)},D)):e.jsx(f,{color:"secondary",className:"text-muted",children:"No permissions assigned"})})})})})]},r._id))})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-4",children:[e.jsxs("div",{className:"text-muted",children:["Showing ",w+1,"-",Math.min(u,o)," of ",o,t?" users with permissions":" users"]}),e.jsx($,{"aria-label":"Page navigation",children:I()})]})]}):e.jsx(V,{color:"info",children:t?"No users with permissions found":"No users found"})]})]})})};export{ce as default};
