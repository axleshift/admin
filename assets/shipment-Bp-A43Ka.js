import{j as e}from"./index-DGlCYBmm.js";import{r as m,R as U}from"./vendor-react-B6URQkMn.js";import{F as u,D as V,L as v,M as z,O as W,E as J,V as X}from"./index-DgWFfLP0.js";import{a as q}from"./axiosInstance-Dv2jt_v_.js";import{l as x}from"./activityLogger-dj-FpP-1.js";import{ac as C,k as S,l as b,C as G,X as K,_ as Q,$ as Y,a0 as P,a1 as l,a2 as Z,a3 as d,y as _,aj as ee,ah as te,ai as T,a9 as ae,aa as se,ab as ne}from"./vendor-coreui-DDUzhqJ9.js";import"./vendor-redux-C7peqcPR.js";import"./index-t--hEgTQ.js";const ue=()=>{const[g,B]=m.useState([]),[E,y]=m.useState(!0),[F,L]=m.useState(null),[r,$]=m.useState(1),p=10,[j,R]=m.useState(null),f=U.useRef(),a=localStorage.getItem("name"),s=localStorage.getItem("role"),n=localStorage.getItem("department"),c=localStorage.getItem("userId");localStorage.getItem("username"),JSON.parse(localStorage.getItem("permissions")||"[]");const I=(t,h,o)=>{R(e.jsxs(ae,{autohide:!0,delay:5e3,children:[e.jsxs(se,{closeButton:!0,children:[e.jsx(u,{icon:o==="success"?J:X,className:"me-2"}),e.jsx("strong",{className:`me-auto text-${o}`,children:t})]}),e.jsx(ne,{children:h})]}))};m.useEffect(()=>{(async()=>{var h;try{y(!0),c&&a&&s&&n&&x({name:a,role:s,department:n,route:"/freight-table",action:"Fetch Shipments",description:"User accessed freight shipment data"}).catch(console.warn);const w=((h=(await q.get("/core/fetch-core")).data)==null?void 0:h.data)||[];B(w),y(!1),I("Data Loaded",`Successfully loaded ${w.length} shipments`,"success"),c&&a&&s&&n&&x({name:a,role:s,department:n,route:"/freight-table",action:"Shipments Loaded",description:`Successfully loaded ${w.length} shipments`}).catch(console.warn)}catch(o){L(o.message||"Failed to fetch shipment data"),y(!1),I("Error Loading Data",o.message||"Failed to fetch shipment data","danger"),c&&a&&s&&n&&x({name:a,role:s,department:n,route:"/freight-table",action:"Shipments Load Failed",description:`Error fetching shipments: ${o.message}`}).catch(console.warn)}})()},[c,a,s,n]);const k=Math.ceil(g.length/p),N=t=>{$(t),c&&a&&s&&n&&x({name:a,role:s,department:n,route:"/freight-table",action:"Pagination",description:`User navigated to page ${t} of shipments`}).catch(console.warn)},H=()=>{const t=(r-1)*p,h=t+p;return g.slice(t,h)};if(E)return e.jsxs(e.Fragment,{children:[e.jsx(C,{ref:f,push:j,placement:"top-end"}),e.jsx(S,{children:e.jsxs(b,{className:"text-center",children:[e.jsx(G,{color:"primary"}),e.jsx("p",{className:"mt-2",children:"Loading Shipments..."})]})})]});if(F)return e.jsxs(e.Fragment,{children:[e.jsx(C,{ref:f,push:j,placement:"top-end"}),e.jsx(S,{className:"text-danger",children:e.jsxs(b,{className:"text-center",children:[e.jsx(u,{icon:V,size:"3x",className:"mb-3"}),e.jsx("p",{children:F})]})})]});if(g.length===0)return e.jsxs(e.Fragment,{children:[e.jsx(C,{ref:f,push:j,placement:"top-end"}),e.jsx(S,{children:e.jsxs(b,{className:"text-center",children:[e.jsx(u,{icon:v,size:"3x",className:"mb-3"}),e.jsx("p",{children:"No Shipments Found"})]})})]});const M=t=>{switch(t){case"to_pay":return"warning";case"cancelled":return"danger";case"delivered":return"success";case"in_transit":return"info";case"processing":return"primary";default:return"secondary"}},A=t=>{c&&a&&s&&n&&x({name:a,role:s,department:n,route:"/freight-table",action:"View Shipment Details",description:`Viewed details for shipment ${t.tracking_number}`}).catch(console.warn)},i=t=>{c&&a&&s&&n&&x({name:a,role:s,department:n,route:"/freight-table",action:"Sort Shipments",description:`User sorted shipments by ${t}`}).catch(console.warn)},O=H(),D=[];for(let t=1;t<=k;t++)D.push(e.jsx(T,{active:t===r,onClick:()=>N(t),children:t},t));return e.jsxs(e.Fragment,{children:[e.jsx(C,{ref:f,push:j,placement:"top-end"}),e.jsxs(S,{children:[e.jsxs(K,{children:[e.jsx(u,{icon:v,className:"me-2"}),"Shipment List"]}),e.jsx(b,{children:e.jsxs(Q,{hover:!0,responsive:!0,children:[e.jsx(Y,{children:e.jsxs(P,{children:[e.jsx(l,{onClick:()=>i("tracking_number"),children:"Tracking Number"}),e.jsx(l,{onClick:()=>i("country"),children:"Country"}),e.jsx(l,{onClick:()=>i("type"),children:"Type"}),e.jsx(l,{onClick:()=>i("status"),children:"Status"}),e.jsx(l,{onClick:()=>i("weight"),children:"Weight"}),e.jsx(l,{onClick:()=>i("items"),children:"Items"}),e.jsx(l,{onClick:()=>i("amount"),children:"Amount"})]})}),e.jsx(Z,{children:O.map(t=>e.jsxs(P,{onClick:()=>A(t),style:{cursor:"pointer"},children:[e.jsx(d,{children:t.tracking_number}),e.jsx(d,{children:t.country}),e.jsx(d,{children:e.jsx(_,{color:t.type==="business"?"info":"primary",children:t.type})}),e.jsx(d,{children:e.jsx(_,{color:M(t.status),children:t.status})}),e.jsxs(d,{children:[e.jsx(u,{icon:z,className:"me-1"}),t.total_weight," kg"]}),e.jsx(d,{children:t.number_of_items}),e.jsxs(d,{children:[e.jsx(u,{icon:W,className:"me-1"}),t.amount.value," ",t.amount.currency]})]},t._id))})]})}),k>1&&e.jsxs(ee,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"small text-muted",children:["Showing ",(r-1)*p+1," to ",Math.min(r*p,g.length)," of ",g.length," shipments"]}),e.jsxs(te,{"aria-label":"Shipment navigation",children:[e.jsx(T,{"aria-label":"Previous",disabled:r===1,onClick:()=>N(r-1),children:e.jsx("span",{"aria-hidden":"true",children:"«"})}),D,e.jsx(T,{"aria-label":"Next",disabled:r===k,onClick:()=>N(r+1),children:e.jsx("span",{"aria-hidden":"true",children:"»"})})]})]})]})]})};export{ue as default};
