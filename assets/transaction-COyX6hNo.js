import{q as b,s as k,t as N,r as i,j as e,c as d,F as E,v as O,l as A}from"./index-Cskk6QuV.js";import{C as L}from"./customhead-SreJgXlO.js";import{E as _}from"./exceljs.min-2ZDGN-p8.js";import{F as U}from"./FileSaver.min-B7bO1w6Z.js";import{C as V}from"./index.esm-CbuOHHQi.js";import{C as x}from"./CRow-BtsQEa9i.js";import{C as B}from"./CCol-BpNSW51C.js";import{C as F,a as I,b as p,c as a,d as R,e as s}from"./CTable-N1HzVlhb.js";import{C as M}from"./DefaultLayout-CPvfNtS9.js";import"./CCardTitle-MSeVetlc.js";import"./ex-CELXs5B0.js";const Y=()=>{const{data:o,error:c,isLoading:D}=b(),[j]=k(),[y]=N(),[u,f]=i.useState({}),[C,h]=i.useState(!1),[S,m]=i.useState(!1),w=async t=>{h(!0);try{const r=u[t]||"Pending";await j({id:t,status:r,deliveryDate:r==="Delivered"?new Date:null}),alert("Shipping status updated successfully!")}catch{alert("Error updating shipping status.")}finally{h(!1)}},g=async t=>{if(window.confirm("Are you sure you want to delete this shipping entry?")){m(!0);try{await y(t),alert("Shipping entry deleted successfully!")}catch{alert("Error deleting shipping entry.")}finally{m(!1)}}},v=async()=>{if(!o)return;const t=new _.Workbook,r=t.addWorksheet("Transactions");r.columns=[{header:"Customer Name",key:"CustomerName",width:20},{header:"Order Volume (kg)",key:"OrderVolume",width:15},{header:"Shipping Type",key:"ShippingType",width:15},{header:"Order Date",key:"OrderDate",width:20},{header:"Status",key:"Status",width:15},{header:"Delivery Date",key:"DeliveryDate",width:20}],o.forEach(n=>{r.addRow({CustomerName:n.customerName,OrderVolume:`${n.orderVolume} kg`,ShippingType:n.shippingType,OrderDate:new Date(n.orderDate).toLocaleDateString(),Status:n.status,DeliveryDate:n.deliveryDate?new Date(n.deliveryDate).toLocaleString():"N/A"})});const l=await t.xlsx.writeBuffer(),T=new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});U.saveAs(T,"shipping_transactions.xlsx")};return D?e.jsx("p",{children:"Loading..."}):c?e.jsxs("p",{children:["Error loading shipping data: ",c.message]}):e.jsxs(V,{m:"1.5rem 2.5rem",children:[e.jsx(x,{children:e.jsx(L,{title:"TRANSACTIONS",subtitle:"List of Transactions"})}),e.jsx(x,{className:"p-2",children:e.jsx(B,{xs:"auto",children:e.jsx(d,{color:"Gray",onClick:v,children:e.jsx(E,{icon:O})})})}),e.jsxs(F,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[e.jsx(I,{children:e.jsxs(p,{children:[e.jsx(a,{children:"Customer Name"}),e.jsx(a,{children:"Order Volume (kg)"}),e.jsx(a,{children:"Shipping Type"}),e.jsx(a,{children:"Order Date"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Delivery Date"}),e.jsx(a,{children:"Update Status"}),e.jsx(a,{children:"Actions"})]})}),e.jsx(R,{children:o&&o.map(t=>e.jsxs(p,{children:[e.jsx(s,{children:t.customerName}),e.jsx(s,{children:t.orderVolume}),e.jsx(s,{children:t.shippingType}),e.jsx(s,{children:new Date(t.orderDate).toLocaleDateString()}),e.jsx(s,{children:e.jsx(M,{color:t.status==="Delivered"?"success":"warning",children:t.status})}),e.jsx(s,{children:t.deliveryDate?new Date(t.deliveryDate).toLocaleDateString():"N/A"}),e.jsx(s,{children:e.jsxs(A,{"aria-label":"Select Shipping Status",value:u[t._id]||t.status,onChange:r=>f(l=>({...l,[t._id]:r.target.value})),children:[e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"In Transit",children:"In Transit"}),e.jsx("option",{value:"Delivered",children:"Delivered"}),e.jsx("option",{value:"Cancelled",children:"Cancelled"})]})}),e.jsxs(s,{children:[e.jsx(d,{color:"warning",size:"sm",onClick:()=>w(t._id),disabled:C,children:"Update"}),e.jsx(d,{color:"danger",size:"sm",className:"ms-2",onClick:()=>g(t._id),disabled:S,children:"Delete"})]})]},t._id))})]})]})};export{Y as default};
