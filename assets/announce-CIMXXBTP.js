import{j as e}from"./index-CssPjSvR.js";import{r as s}from"./vendor-react-B6URQkMn.js";import{a as N}from"./index-t--hEgTQ.js";import{F as l,E as he,G as S,H as xe,C as ue,I as ge,J as B,K as pe,L as je}from"./index-HEMnEFLK.js";import{j as t,k as z,l as H,S as L,R as fe,V as F,Z as be,s as R,t as Y,_ as q,v as _,C as J,w as K,X as ye}from"./vendor-coreui-CVCUzX7i.js";import"./vendor-redux-DipIbRRz.js";const $e=()=>{const[u,A]=s.useState(""),[p,$]=s.useState(""),[m,C]=s.useState(null),[r,D]=s.useState([]),[P,Ne]=s.useState(1),[Ce,O]=s.useState(1),[M,G]=s.useState(!1),[a,v]=s.useState(0),[I,T]=s.useState(!1),[V,j]=s.useState(!1),[X,U]=s.useState(!1),[h,g]=s.useState(""),[Z,w]=s.useState(""),[f,x]=s.useState(""),[b,c]=s.useState(null),[Q,y]=s.useState(!1),[E,W]=s.useState(!1),ee=5,i="https://backend-admin.axleshift.com",k=async()=>{try{const n=await N.get(`${i}/management/getannounce?page=${P}&limit=${ee}`);D(n.data.announcements||[]),O(n.data.totalPages||1),v(0)}catch(n){console.error("Failed to fetch announcements:",n.message),D([])}};s.useEffect(()=>{k()},[P]);const ne=()=>{a>0&&v(a-1)},se=()=>{a<r.length-1&&v(a+1)},ae=async n=>{if(n.preventDefault(),!(!u||!p)){T(!0);try{const o=new FormData;o.append("title",u),o.append("message",p),m&&o.append("banner",m),await N.post(`${i}/management/announcement`,o,{headers:{"Content-Type":"multipart/form-data"}}),A(""),$(""),C(null),G(!1),g(""),w(""),k()}catch(o){console.error("Failed to create announcement:",o),c("Failed to create announcement. Please try again.")}finally{T(!1)}}},te=async()=>{if(!r.length||a<0)return;const n=r[a]._id;W(!0);try{await N.delete(`${i}/management/delannounce/${n}`),y(!1),await k()}catch(o){console.error("Failed to delete announcement:",o),c("Failed to delete announcement. Please try again.")}finally{W(!1)}},re=()=>{y(!0),c(null)},le=()=>{x(u),j(!0),c(null),g("")},oe=async()=>{var n,o;if(!f){c("Please enter a description for your banner");return}U(!0),g(""),c(null);try{const d=await N.post(`${i}/management/generate-banner`,{prompt:f});if(d.data.success){g(d.data.bannerUrl),w(d.data.banner);const de=await(await fetch(`${i}${d.data.bannerUrl}`)).blob(),me=new File([de],d.data.banner,{type:"image/png"});C(me)}else c("Failed to generate banner")}catch(d){console.error("Failed to generate AI banner:",d),c(((o=(n=d.response)==null?void 0:n.data)==null?void 0:o.message)||"Failed to generate banner. Please try again.")}finally{U(!1)}},ie=()=>{if(!h)return;const n=document.createElement("a");n.href=`${i}${h}`,n.download=Z,document.body.appendChild(n),n.click(),document.body.removeChild(n)},ce=()=>{j(!1)};return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"d-flex justify-content-between mb-4",children:[e.jsx("h1",{children:"Announcements"}),e.jsxs(t,{color:"primary",onClick:()=>G(!M),children:[e.jsx(l,{icon:he})," Upload New Announcement"]})]}),M&&e.jsx(z,{className:"mb-4",children:e.jsxs(H,{children:[b&&e.jsx(L,{color:"danger",children:b}),e.jsxs(fe,{onSubmit:ae,children:[e.jsx(F,{type:"text",value:u,onChange:n=>A(n.target.value),placeholder:"Title",required:!0,className:"mb-3"}),e.jsx(be,{value:p,onChange:n=>$(n.target.value),placeholder:"Message",required:!0,className:"mb-3"}),e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx(F,{type:"file",onChange:n=>C(n.target.files[0]),className:"me-3"}),e.jsxs(t,{color:"info",onClick:le,children:[e.jsx(l,{icon:S})," Generate Banner"]})]}),m&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("p",{children:["Selected banner: ",typeof m=="string"?m:m.name]}),h&&e.jsx("img",{src:`${i}${h}`,alt:"Generated Banner",className:"img-fluid mt-2",style:{maxHeight:"200px"}})]}),e.jsx(t,{type:"submit",color:"success",disabled:I||!u||!p,children:I?"Creating...":"Create Announcement"})]})]})}),e.jsxs(R,{visible:V,onClose:()=>j(!1),size:"lg",alignment:"center",children:[e.jsx(Y,{className:"bg-gradient-primary text-white",children:e.jsxs(q,{children:[e.jsx(l,{icon:S,className:"me-2"})," AI Banner Generator"]})}),e.jsx(_,{className:"p-4",children:X?e.jsxs("div",{className:"text-center py-5",children:[e.jsxs("div",{className:"position-relative",children:[e.jsx("div",{className:"placeholder-banner rounded mb-4",style:{height:"200px",background:"linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab)",backgroundSize:"400% 400%",animation:"gradient 3s ease infinite",position:"relative"},children:e.jsx("div",{className:"position-absolute top-50 start-50 translate-middle",children:e.jsx(J,{color:"light",size:"lg"})})}),e.jsx("style",{children:`
                          @keyframes gradient {
                            0% { background-position: 0% 50%; }
                            50% { background-position: 100% 50%; }
                            100% { background-position: 0% 50%; }
                          }
                        `})]}),e.jsx("h4",{className:"mt-3",children:"Creating Your Banner"}),e.jsx("p",{className:"text-muted",children:"Generating a professional design with AI. This usually takes 10-15 seconds..."})]}):h?e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h4",{className:"mb-3",children:"Your Custom Banner"}),e.jsx("div",{className:"banner-preview shadow rounded overflow-hidden",children:e.jsx("img",{src:`${i}${h}`,alt:"Generated Banner",className:"img-fluid w-100"})})]}),e.jsxs("div",{className:"d-flex justify-content-center gap-3 mt-4",children:[e.jsxs(t,{color:"success",className:"px-4",onClick:ce,children:[e.jsx(l,{icon:xe,className:"me-2"})," Use This Banner"]}),e.jsxs(t,{color:"info",onClick:ie,children:[e.jsx(l,{icon:ue,className:"me-2"})," Download"]}),e.jsxs(t,{color:"secondary",onClick:()=>{g(""),w("")},children:[e.jsx(l,{icon:ge,className:"me-2"})," Create Another"]})]})]}):e.jsxs("div",{children:[b&&e.jsx(L,{color:"danger",children:b}),e.jsxs("div",{className:"banner-generation-form",children:[e.jsx("h4",{className:"mb-3",children:"Design Your Announcement Banner"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label fw-bold",children:"What would you like your banner to say?"}),e.jsx(F,{type:"text",value:f,onChange:n=>x(n.target.value),placeholder:"E.g., Company anniversary celebration with fireworks",className:"form-control-lg mb-2"}),e.jsx("div",{className:"form-text text-muted",children:"Tip: Be specific about colors, style, and mood for better results"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label fw-bold",children:"Choose a Style (Optional)"}),e.jsxs("div",{className:"d-flex gap-3 overflow-auto pb-2",children:[e.jsx("div",{className:"style-option p-2 border rounded text-center cursor-pointer",style:{minWidth:"120px",background:"linear-gradient(135deg, #1a3a8f 0%, #0f2557 100%)",color:"white"},onClick:()=>x(n=>`${n} in corporate blue style`),children:e.jsx("div",{className:"py-3",children:"Corporate"})}),e.jsx("div",{className:"style-option p-2 border rounded text-center cursor-pointer",style:{minWidth:"120px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white"},onClick:()=>x(n=>`${n} in modern purple gradient style`),children:e.jsx("div",{className:"py-3",children:"Modern"})}),e.jsx("div",{className:"style-option p-2 border rounded text-center cursor-pointer",style:{minWidth:"120px",background:"linear-gradient(135deg, #11998e 0%, #38ef7d 100%)",color:"white"},onClick:()=>x(n=>`${n} in fresh green style`),children:e.jsx("div",{className:"py-3",children:"Fresh"})}),e.jsx("div",{className:"style-option p-2 border rounded text-center cursor-pointer",style:{minWidth:"120px",background:"linear-gradient(135deg, #F2994A 0%, #F2C94C 100%)",color:"white"},onClick:()=>x(n=>`${n} in warm orange style`),children:e.jsx("div",{className:"py-3",children:"Warm"})})]})]}),e.jsx("div",{className:"text-center mt-4",children:e.jsxs(t,{color:"primary",size:"lg",className:"px-5",onClick:oe,disabled:!f,children:[e.jsx(l,{icon:S,className:"me-2"})," Generate Banner"]})})]})]})}),e.jsx(K,{children:e.jsx(t,{color:"secondary",onClick:()=>j(!1),children:"Close"})})]}),e.jsxs(R,{visible:Q,onClose:()=>y(!1),alignment:"center",children:[e.jsx(Y,{children:e.jsxs(q,{children:[e.jsx(l,{icon:B,className:"me-2 text-danger"})," Confirm Deletion"]})}),e.jsx(_,{children:r.length>0&&a>=0&&e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"Are you sure you want to delete this announcement?"}),e.jsxs("div",{className:"alert alert-warning",children:[e.jsx("strong",{children:r[a].title}),e.jsx("p",{className:"mb-0 mt-2",children:"This action cannot be undone."})]})]})}),e.jsxs(K,{children:[e.jsx(t,{color:"secondary",onClick:()=>y(!1),children:"Cancel"}),e.jsx(t,{color:"danger",onClick:te,disabled:E,children:E?e.jsxs(e.Fragment,{children:[e.jsx(J,{size:"sm",className:"me-2"})," Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(l,{icon:B,className:"me-2"})," Delete"]})})]})]}),r.length>0?e.jsxs(z,{className:"mb-3",children:[e.jsxs(ye,{className:"d-flex justify-content-between align-items-center",children:[e.jsx(t,{color:"secondary",onClick:ne,disabled:a===0,children:e.jsx(l,{icon:pe})}),e.jsx("h4",{className:"m-0",children:r[a].title}),e.jsxs("div",{className:"d-flex",children:[e.jsx(t,{color:"danger",className:"me-2",onClick:re,children:e.jsx(l,{icon:B})}),e.jsx(t,{color:"secondary",onClick:se,disabled:a===r.length-1,children:e.jsx(l,{icon:je})})]})]}),e.jsxs(H,{children:[e.jsx("p",{children:r[a].message}),r[a].banner&&e.jsx("img",{src:`${i}/uploads/${r[a].banner}`,alt:"Banner",className:"mt-2 img-fluid"}),e.jsxs("small",{children:["Posted on: ",new Date(r[a].createdAt).toLocaleString()]})]})]}):e.jsx("p",{children:"No announcements found."})]})};export{$e as default};
