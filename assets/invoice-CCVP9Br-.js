import{j as e}from"./index-DPEaZ_iK.js";import{r as l}from"./vendor-react-BHxUanFt.js";import{a as R}from"./axiosInstance-Bq-uIJjs.js";import{F as t,A as y,z as S,k as x,l as _,j as w,R as I,G,s as P,Z as O,_ as B,i as H}from"./index-BHkgY7kg.js";/* empty css                */import{d as h,e as j,n as V,h as W,i as Z,k as q,a as J,b as K,U as Q,V as u}from"./vendor-coreui-DaIzHuu_.js";import"./vendor-redux-CSji-Y9p.js";import"./index-xsH4HHeE.js";const ce=()=>{const[f,o]=l.useState([]),[A,L]=l.useState(!0),[C,T]=l.useState(""),[b,F]=l.useState(""),[r,d]=l.useState(1),[N]=l.useState(10);l.useEffect(()=>{(async()=>{try{const a=await R.get("/finance/invoices");console.log("Fetched invoice response:",a.data);const n=a.data;Array.isArray(n)?o(n):n&&Array.isArray(n.data)?o(n.data):n&&typeof n.data=="object"?o([n.data]):(console.error("Unexpected data format:",n),o([]))}catch(a){T("Failed to fetch invoices"),console.error(a)}finally{L(!1)}})()},[]);const k=s=>{switch(s==null?void 0:s.toLowerCase()){case"paid":return e.jsxs("div",{className:"status-badge status-paid",children:[e.jsx(t,{icon:H})," Paid"]});case"unpaid":return e.jsxs("div",{className:"status-badge status-unpaid",children:[e.jsx(t,{icon:S})," Unpaid"]});case"pending":return e.jsxs("div",{className:"status-badge status-pending",children:[e.jsx(t,{icon:y})," Pending"]});default:return e.jsx("div",{className:"status-badge",children:s||"N/A"})}},D=s=>{if(!s)return"N/A";try{return new Date(s).toLocaleDateString()}catch{return"Invalid Date"}},$=(s,a="USD")=>s==null?"N/A":`${a} ${Number(s).toLocaleString()}`,M=s=>{F(s.target.value),d(1)},m=f.filter(s=>{const a=b.toLowerCase();return s.invoiceNumber&&s.invoiceNumber.toLowerCase().includes(a)||s.firstName&&s.firstName.toLowerCase().includes(a)||s.lastName&&s.lastName.toLowerCase().includes(a)||s.status&&s.status.toLowerCase().includes(a)}),p=r*N,v=p-N,U=m.slice(v,p),c=Math.ceil(m.length/N),z=()=>{let a=[];if(c<=5)a=Array.from({length:c},(n,i)=>i+1);else{a.push(1);let n=Math.max(2,r-1),i=Math.min(c-1,r+1);i-n<2&&(r<c/2?i=Math.min(n+5-3,c-1):n=Math.max(2,i-2)),n>2&&a.push("...");for(let g=n;g<=i;g++)a.push(g);i<c-1&&a.push("..."),a.push(c)}return a},E=s=>{typeof s=="number"&&d(s)};return A?e.jsx(h,{className:"mb-4",children:e.jsx(j,{className:"d-flex justify-content-center align-items-center p-5",children:e.jsxs("div",{className:"loading-container text-center",children:[e.jsx(t,{icon:y,spin:!0,size:"2x",className:"mb-3"}),e.jsx("p",{children:"Loading invoices..."})]})})}):C?e.jsx(h,{className:"mb-4",children:e.jsx(j,{className:"d-flex justify-content-center align-items-center p-5",children:e.jsxs("div",{className:"error-container text-center",children:[e.jsx(t,{icon:S,size:"2x",color:"red",className:"mb-3"}),e.jsx("p",{children:C})]})})}):!f||f.length===0?e.jsx(h,{className:"mb-4",children:e.jsx(j,{className:"d-flex justify-content-center align-items-center p-5",children:e.jsxs("div",{className:"empty-container text-center",children:[e.jsx(t,{icon:x,size:"2x",className:"mb-3"}),e.jsx("p",{children:"No invoices found."})]})})}):e.jsxs(h,{className:"mb-4",children:[e.jsxs(V,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("h4",{className:"mb-0",children:[e.jsx(t,{icon:x,className:"me-2"})," All Invoices"]}),e.jsxs(W,{className:"w-auto",children:[e.jsx(Z,{children:e.jsx(t,{icon:_})}),e.jsx(q,{placeholder:"Search invoices...",value:b,onChange:M,style:{maxWidth:"250px"}})]})]}),e.jsxs(j,{children:[e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-hover table-striped align-middle",children:[e.jsx("thead",{className:"bg-light",children:e.jsxs("tr",{children:[e.jsxs("th",{children:[e.jsx(t,{icon:x,className:"me-2"})," Invoice #"]}),e.jsxs("th",{children:[e.jsx(t,{icon:w,className:"me-2"})," Client"]}),e.jsxs("th",{children:[e.jsx(t,{icon:I,className:"me-2"})," Amount"]}),e.jsxs("th",{children:[e.jsx(t,{icon:G,className:"me-2"})," Status"]}),e.jsxs("th",{children:[e.jsx(t,{icon:P,className:"me-2"})," Date"]})]})}),e.jsx("tbody",{children:U.map((s,a)=>e.jsxs("tr",{children:[e.jsxs("td",{className:"invoice-number",children:[e.jsx(t,{icon:x,className:"me-2 text-secondary"}),s.invoiceNumber||s._id||"N/A"]}),e.jsxs("td",{children:[e.jsx(t,{icon:w,className:"me-2 text-secondary"}),s.firstName&&s.lastName?`${s.firstName} ${s.lastName}`:"N/A"]}),e.jsxs("td",{className:"amount-cell",children:[e.jsx(t,{icon:I,className:"me-2 text-secondary"}),$(s.totalAmount,s.selectedCurrency)]}),e.jsx("td",{className:"status-cell",children:k(s.status)}),e.jsxs("td",{children:[e.jsx(t,{icon:P,className:"me-2 text-secondary"}),D(s.createdAt)]})]},s._id||`invoice-${a}`))})]})}),e.jsxs("div",{className:"text-center text-muted mt-3",children:["Showing ",v+1,"-",Math.min(p,m.length)," of ",m.length," invoices"]}),e.jsx(J,{className:"mt-3",children:e.jsx(K,{xs:12,className:"d-flex justify-content-center",children:e.jsxs(Q,{"aria-label":"Page navigation",children:[e.jsx(u,{"aria-label":"Previous",disabled:r===1,onClick:()=>d(r-1),children:e.jsx("span",{"aria-hidden":"true",children:e.jsx(t,{icon:O})})}),z().map((s,a)=>s==="..."?e.jsx(u,{disabled:!0,children:"..."},`ellipsis-${a}`):e.jsx(u,{active:s===r,onClick:()=>E(s),children:s},`page-${s}`)),e.jsx(u,{"aria-label":"Next",disabled:r===c||c===0,onClick:()=>d(r+1),children:e.jsx("span",{"aria-hidden":"true",children:e.jsx(t,{icon:B})})})]})})})]})]})};export{ce as default};
