import{b as h,N as u,j as e}from"./index-CfReR-YB.js";import{r as f}from"./vendor-react-B6URQkMn.js";import{l as g}from"./activityLogger-CoWA-xmd.js";import{n as y,C as w,a as x,b as v,c as k}from"./vendor-coreui-BDhfDOiu.js";import"./vendor-redux-DipIbRRz.js";import"./axiosInstance-cMJSlMKI.js";const T={async notify({title:t,message:s,type:a,userId:o}){try{console.log("Sending notification:",{title:t,message:s,type:a,userId:o});const i=this.validateNotificationType(a),n=await h.post("https://backend-admin.axleshift.com/notifications/postnotif",{title:t,message:s,type:i,userId:o},{withCredentials:!0});return n.data.success?(console.log("Notification saved to MongoDB:",n.data),u.emit("notification",{title:t,message:s,type:i,userId:o,createdAt:new Date}),n.data.data):null}catch(i){console.error("Failed to save notification via API:",i);const n=this.validateNotificationType(a);throw u.emit("notification",{title:t,message:s,type:n,userId:o,createdAt:new Date}),i}},validateNotificationType(t){return["registration","permission_update","permission_revoke","request_status","button_click","system"].includes(t)?t:(console.warn(`Invalid notification type: ${t}. Using 'system' instead.`),"system")}},I=()=>{const t=sessionStorage.getItem("role"),s=sessionStorage.getItem("department");sessionStorage.getItem("username");const a=sessionStorage.getItem("userId");JSON.parse(sessionStorage.getItem("permissions")||"[]");const o=sessionStorage.getItem("name"),[i,n]=f.useState([]),p=async()=>{try{const r=o||"User",d=t||"Unknown Role",c="Button Clicked",l=`${r} (${d}) has clicked the button successfully.`;await T.notify({title:c,message:l,type:"button_click",userId:a}),m(c,l),a&&o&&t&&s&&g({name:o,role:t,department:s,route:"/button",action:"Button Click",description:"User clicked the button"}).catch(console.warn)}catch(r){console.warn("Error showing notification:",r),m("Button Clicked",`${o||"User"} (${t||"Unknown Role"}) has clicked the button successfully.`)}},m=(r,d)=>{const c=new Date().toLocaleTimeString();n(l=>[...l,e.jsxs(x,{autohide:!0,visible:!0,delay:5e3,children:[e.jsxs(v,{closeButton:!0,children:[e.jsx("svg",{className:"rounded me-2",width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid slice",focusable:"false",role:"img",children:e.jsx("rect",{width:"100%",height:"100%",fill:"#007aff"})}),e.jsx("strong",{className:"me-auto",children:r}),e.jsx("small",{children:c})]}),e.jsx(k,{children:d})]},`click-${Date.now()}`)])};return e.jsxs("div",{children:[e.jsxs("h1",{children:["Hi ",o||"there"]}),e.jsx(y,{onClick:p,color:"primary",children:"Click me"}),e.jsx(w,{placement:"top-end",children:i})]})};export{I as default};
