import{j as e}from"./index-mI93jahP.js";import{r as p}from"./vendor-react-B6URQkMn.js";import{a as k}from"./axiosInstance-D88H88kB.js";import{F as l,J as G,a6 as B,O as I,B as L,U as R,G as J,C as O,a7 as K,A as Q,a8 as H,a9 as X,aa as y,ab as W,ac as P}from"./index-D-k-o6LC.js";import{S as f,T as o,o as A,$ as D,i as Z,j as _,k as ee,l as S,n as x,p as F,d as se,W as V,M as T,a0 as U,D as C,a1 as ae,a2 as te,a3 as M,a4 as v,a5 as le,a6 as d,aj as re}from"./vendor-coreui-BDhfDOiu.js";import"./vendor-redux-DipIbRRz.js";const xe=()=>{const[n,$]=p.useState(null),[j,u]=p.useState(!0),[g,E]=p.useState(null),[h,b]=p.useState("6months");p.useEffect(()=>{(async()=>{var a,r;try{u(!0);const c=await k.get(`/core/insight/shipment?timeframe=${h}`);console.log("API Response:",c.data),$(c.data)}catch(c){console.error("Error fetching data:",c),E(((r=(a=c.response)==null?void 0:a.data)==null?void 0:r.error)||"Failed to fetch data")}finally{u(!1)}})()},[h]);const s=(()=>{if(!n)return null;if(n.labels&&n.data)return{labels:n.labels,data:n.data};let t=[],a=[];return Array.isArray(n.months)&&Array.isArray(n.shipments)?(t=n.months,a=n.shipments):Array.isArray(n)?n.forEach(r=>{r.month&&t.push(r.month),r.shipment!==void 0&&a.push(r.shipment)}):n.data&&(Array.isArray(n.data.months)&&Array.isArray(n.data.shipments)?(t=n.data.months,a=n.data.shipments):Array.isArray(n.data)&&n.data.forEach(r=>{r.month&&t.push(r.month),r.shipment!==void 0&&a.push(r.shipment)})),{labels:t,data:a}})(),m=s&&s.data.length>0?s.data.reduce((t,a)=>t+Number(a),0):0,Y=s&&s.data.length>0?Math.max(...s.data.map(t=>Number(t)),1):1,i=t=>{if(!s||t===0||!s.data[t]||!s.data[t-1])return null;const a=Number(s.data[t]),r=Number(s.data[t-1]);return r===0?null:(a-r)/r*100},N=t=>t===null?"secondary":t>0?"success":t<0?"danger":"info",w=t=>t===null?y:t>0?W:t<0?P:y,q=()=>!s||s.data.length===0?0:m/s.data.length,z=()=>{(async()=>{var a,r;try{u(!0);const c=await k.get(`/core/insight/shipment?timeframe=${h}`);$(c.data)}catch(c){E(((r=(a=c.response)==null?void 0:a.data)==null?void 0:r.error)||"Failed to fetch data")}finally{u(!1)}})()};return e.jsx("div",{className:"bg-light min-vh-100 d-flex flex-column",children:e.jsx("div",{className:"py-4",children:e.jsx(f,{children:e.jsx(o,{md:12,children:e.jsxs(A,{className:"mb-4 shadow-sm border-0",children:[e.jsxs(D,{className:"bg-white d-flex justify-content-between align-items-center py-3 border-bottom",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"mb-0 text-primary",children:[e.jsx(l,{icon:G,className:"me-2"}),"Shipment Insights"]}),e.jsx("small",{className:"text-medium-emphasis",children:"Track and analyze your monthly shipment distribution"})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs(Z,{children:[e.jsxs(_,{color:"light",className:"d-flex align-items-center",children:[e.jsx(l,{icon:B,className:"me-2"}),h==="6months"&&"Last 6 Months",h==="12months"&&"Last 12 Months",h==="ytd"&&"Year to Date"]}),e.jsxs(ee,{children:[e.jsx(S,{onClick:()=>b("6months"),children:"Last 6 Months"}),e.jsx(S,{onClick:()=>b("12months"),children:"Last 12 Months"}),e.jsx(S,{onClick:()=>b("ytd"),children:"Year to Date"})]})]}),e.jsxs(x,{color:"light",onClick:z,disabled:j,children:[e.jsx(l,{icon:I,className:j?"fa-spin me-2":"me-2"}),"Refresh"]}),e.jsxs(x,{color:"light",children:[e.jsx(l,{icon:L,className:"me-2"}),"Export"]})]})]}),e.jsxs(F,{className:"p-4",children:[j&&e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"300px"},children:e.jsxs("div",{className:"text-center",children:[e.jsx(se,{color:"primary",style:{width:"3rem",height:"3rem"}}),e.jsx("p",{className:"mt-3 text-medium-emphasis",children:"Loading shipment data..."})]})}),g&&e.jsxs(V,{color:"danger",className:"d-flex align-items-center",children:[e.jsx(l,{icon:R,className:"me-3 fs-4"}),e.jsxs("div",{children:[e.jsx("h4",{className:"alert-heading",children:"Data Fetch Error"}),e.jsx("p",{className:"mb-0",children:g}),e.jsxs(x,{color:"danger",variant:"ghost",size:"sm",className:"mt-2",onClick:z,children:[e.jsx(l,{icon:I,className:"me-1"})," Try Again"]})]})]}),!j&&!g&&(!s||s.data.length===0)&&e.jsxs(V,{color:"warning",className:"d-flex align-items-center",children:[e.jsx(l,{icon:R,className:"me-3 fs-4"}),e.jsxs("div",{children:[e.jsx("h4",{className:"alert-heading",children:"No Data Available"}),e.jsx("p",{className:"mb-0",children:"No shipment data available for the selected time period."}),e.jsxs(x,{color:"warning",variant:"ghost",size:"sm",className:"mt-2",onClick:()=>b("12months"),children:[e.jsx(l,{icon:B,className:"me-1"})," Try Different Time Period"]})]})]}),s&&s.data.length>0&&!j&&!g&&e.jsxs(e.Fragment,{children:[e.jsxs(f,{className:"mb-4",children:[e.jsx(o,{lg:4,md:6,className:"mb-4",children:e.jsx(T,{color:"primary",className:"h-100",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"p-3 bg-primary bg-opacity-25 rounded-circle me-3",children:e.jsx(l,{icon:J,size:"2x",className:"text-primary"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-medium-emphasis small",children:"Total Shipments"}),e.jsx("div",{className:"fs-3 fw-bold",children:m.toFixed(0)})]})]})})}),e.jsx(o,{lg:4,md:6,className:"mb-4",children:e.jsx(T,{color:"info",className:"h-100",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"p-3 bg-info bg-opacity-25 rounded-circle me-3",children:e.jsx(l,{icon:O,size:"2x",className:"text-info"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-medium-emphasis small",children:"Average Monthly Shipments"}),e.jsx("div",{className:"fs-3 fw-bold",children:q().toFixed(1)})]})]})})}),e.jsx(o,{lg:4,md:12,className:"mb-4",children:s.data.length>=2&&e.jsx(T,{color:N(i(s.data.length-1)),className:"h-100",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:`p-3 bg-${N(i(s.data.length-1))} bg-opacity-25 rounded-circle me-3`,children:e.jsx(l,{icon:w(i(s.data.length-1)),size:"2x",className:`text-${N(i(s.data.length-1))}`})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-medium-emphasis small",children:"Month-over-Month Change"}),e.jsx("div",{className:"fs-3 fw-bold",children:i(s.data.length-1)!==null?`${i(s.data.length-1)>0?"+":""}${i(s.data.length-1).toFixed(1)}%`:"N/A"})]})]})})})]}),e.jsx(f,{className:"mb-4",children:e.jsx(o,{md:12,children:e.jsxs(A,{className:"border-0 shadow-sm",children:[e.jsxs(D,{className:"bg-white border-bottom d-flex justify-content-between align-items-center py-3",children:[e.jsxs("h4",{className:"mb-0",children:[e.jsx(l,{icon:K,className:"me-2 text-primary"}),"Monthly Shipment Distribution"]}),e.jsxs(x,{color:"light",size:"sm",children:[e.jsx(l,{icon:Q,className:"me-1"})," Shipment Analysis"]})]}),e.jsx(F,{className:"p-4",children:e.jsx("div",{className:"px-3",children:e.jsx(f,{className:"align-items-end g-0",style:{height:"250px"},children:s.data.map((t,a)=>e.jsx(o,{className:"px-1 text-center",children:e.jsxs("div",{className:"d-flex flex-column align-items-center",children:[e.jsx("small",{className:"mb-2 fw-bold",children:Number(t).toFixed(0)}),e.jsx("div",{style:{width:"100%",height:`${Number(t)/Y*80}%`,minHeight:Number(t)>0?"20px":"4px"},children:e.jsx(U,{value:100,color:a===s.data.length-1?"primary":"success",className:"h-100 shadow-sm",style:{minWidth:"30px",borderRadius:"4px"}})}),e.jsxs("small",{className:"mt-2 text-medium-emphasis",children:[e.jsx(l,{icon:H,className:"me-1"}),s.labels[a]||`Month ${a+1}`]}),a>0&&e.jsxs(C,{color:N(i(a)),shape:"rounded-pill",className:"mt-1",children:[e.jsx(l,{icon:w(i(a)),className:"me-1",size:"xs"}),i(a)!==null?`${i(a).toFixed(1)}%`:"N/A"]})]})},a))})})})]})})}),e.jsx(f,{children:e.jsx(o,{md:12,children:e.jsxs(A,{className:"border-0 shadow-sm",children:[e.jsxs(D,{className:"bg-white border-bottom d-flex justify-content-between align-items-center py-3",children:[e.jsxs("h4",{className:"mb-0",children:[e.jsx(l,{icon:X,className:"me-2 text-primary"}),"Shipment Details"]}),e.jsxs(x,{color:"primary",size:"sm",variant:"outline",children:[e.jsx(l,{icon:L,className:"me-1"})," Export Data"]})]}),e.jsx(F,{className:"p-0",children:e.jsxs(ae,{hover:!0,responsive:!0,className:"mb-0 border-0",children:[e.jsx(te,{className:"bg-light",children:e.jsxs(M,{children:[e.jsx(v,{children:"Month"}),e.jsx(v,{className:"text-end",children:"Shipments"}),e.jsx(v,{className:"text-end",children:"% of Total"}),e.jsx(v,{className:"text-end",children:"Change"})]})}),e.jsx(le,{children:s.data.map((t,a)=>e.jsxs(M,{children:[e.jsx(d,{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"p-2 me-2 bg-light rounded",children:e.jsx(l,{icon:H,className:"text-primary"})}),e.jsx("span",{className:"fw-medium",children:s.labels[a]||`Month ${a+1}`})]})}),e.jsx(d,{className:"text-end fw-bold",children:Number(t).toFixed(0)}),e.jsx(d,{className:"text-end",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-end",children:[e.jsx("span",{className:"me-2",children:m>0?`${(Number(t)/m*100).toFixed(1)}%`:"0%"}),e.jsx(U,{value:m>0?Number(t)/m*100:0,color:"success",className:"flex-grow-1",style:{maxWidth:"100px",height:"8px"}})]})}),e.jsx(d,{className:"text-end",children:a>0?e.jsxs(C,{color:N(i(a)),shape:"rounded-pill",children:[e.jsx(l,{icon:w(i(a)),className:"me-1"}),i(a)!==null?`${i(a).toFixed(1)}%`:"N/A"]}):e.jsxs(C,{color:"secondary",shape:"rounded-pill",children:[e.jsx(l,{icon:y,className:"me-1"})," Base"]})})]},a))}),e.jsx(re,{className:"bg-light",children:e.jsxs(M,{children:[e.jsx(d,{className:"fw-bold",children:"Total"}),e.jsx(d,{className:"fw-bold text-end",children:m.toFixed(0)}),e.jsx(d,{className:"fw-bold text-end",children:"100%"}),e.jsx(d,{className:"text-end",children:s.data.length>=2&&e.jsxs(C,{color:Number(s.data[s.data.length-1])>Number(s.data[0])?"success":Number(s.data[s.data.length-1])<Number(s.data[0])?"danger":"info",shape:"rounded-pill",children:[e.jsx(l,{icon:Number(s.data[s.data.length-1])>Number(s.data[0])?W:Number(s.data[s.data.length-1])<Number(s.data[0])?P:y,className:"me-1"}),Number(s.data[0])!==0?`${((Number(s.data[s.data.length-1])-Number(s.data[0]))/Number(s.data[0])*100).toFixed(1)}%`:"N/A"]})})]})})]})})]})})})]})]})]})})})})})};export{xe as default};
