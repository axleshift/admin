import{j as e}from"./index-Bg6RPnaJ.js";import{r as c}from"./vendor-react-B6URQkMn.js";import{a as C}from"./axiosInstance-Dv2jt_v_.js";import{u as L}from"./vendor-redux-DipIbRRz.js";import{F as a,V as B,h as b,W as H,X as I,x as O,Y as _,Z as z,_ as V,$ as W,p as X,E as Y}from"./DefaultLayout-Dky5Mktb.js";import{u as Z,c as k,k as T,a2 as $,l as E,j as g,X as G,C as P,Y as q,Z as J,_ as p,$ as l,a0 as K,a1 as n,y,ag as S,ah as Q,N as ee,O as R}from"./vendor-coreui-vXCAeGSv.js";import"./index-t--hEgTQ.js";import"./Page500-xa0xHQRl.js";import"./cil-magnifying-glass-COgjSVTM.js";import"./permissionConfig-DLItbach.js";const me=()=>{const[i,u]=c.useState([]),[f,o]=c.useState(null),[A,d]=c.useState(!0),[m,x]=c.useState(!1),D=L(t=>t.changeState.theme),{colorMode:F}=Z("coreui-free-react-admin-template-theme"),s=D==="dark"||F==="dark",N=()=>{d(!0),o(null),C.get("/general/log").then(t=>{u(t.data),d(!1)}).catch(t=>{o(t.message),d(!1)})},M=()=>{x(!0),C.get("/general/log").then(t=>{u(t.data),x(!1)}).catch(t=>{o(t.message),x(!1)})};c.useEffect(()=>{N()},[]);const U=s?{color:"#FFFFFF"}:{},w=t=>{const h={CREATE:"success",UPDATE:"primary",DELETE:"danger",RESTORE:"warning",SELECT:"info",FETCH:s?"light":"secondary",NAVIGATE:s?"light":"secondary",AUTO:s?"light":"dark",SET:"info"};for(const[j,r]of Object.entries(h))if(t&&t.includes(j))return r;return s?"light":"secondary"},v=t=>{const h=new Date,j=new Date(t),r=Math.floor((h-j)/1e3);return r<60?`${r} seconds ago`:r<3600?`${Math.floor(r/60)} minutes ago`:r<86400?`${Math.floor(r/3600)} hours ago`:`${Math.floor(r/86400)} days ago`};return f?e.jsx(k,{className:"mt-4",children:e.jsxs(T,{className:`text-center border-danger ${s?"bg-dark text-white":""}`,children:[e.jsxs($,{className:"bg-danger text-white",children:[e.jsx(a,{icon:B,className:"me-2"})," Error"]}),e.jsxs(E,{children:[e.jsx("p",{className:"mb-0",children:f}),e.jsxs(g,{color:"primary",className:"mt-3",onClick:N,children:[e.jsx(a,{icon:b,className:"me-2"})," Try Again"]})]})]})}):e.jsx(k,{fluid:!0,className:"p-4",children:e.jsxs(T,{className:`shadow-sm ${s?"bg-dark text-white":""}`,children:[e.jsxs($,{className:`d-flex justify-content-between align-items-center ${s?"bg-dark text-white border-secondary":"bg-light"}`,children:[e.jsxs("div",{children:[e.jsx(a,{icon:H,className:"me-2 text-primary"}),e.jsx(G,{className:"d-inline mb-0",style:U,children:"Activity Tracker"})]}),e.jsxs("div",{children:[e.jsxs(g,{color:"light",size:"sm",className:`me-2 ${s?"text-dark":""}`,onClick:M,disabled:m,children:[e.jsx(a,{icon:b,spin:m,className:"me-1"}),m?"Refreshing...":"Refresh"]}),e.jsxs(g,{color:s?"light":"secondary",size:"sm",className:s?"text-dark":"",children:[e.jsx(a,{icon:I,className:"me-1"}),"Export"]})]})]}),e.jsx(E,{children:A?e.jsxs("div",{className:"text-center p-5",children:[e.jsx(P,{color:"primary"}),e.jsx("p",{className:`mt-2 ${s?"text-light":"text-muted"}`,children:"Loading activity data..."})]}):e.jsx("div",{className:"table-responsive",children:e.jsxs(q,{hover:!0,striped:!0,responsive:!0,className:`border ${s?"table-dark":""}`,children:[e.jsx(J,{className:s?"bg-dark text-white border-secondary":"bg-light",children:e.jsxs(p,{children:[e.jsxs(l,{className:"text-nowrap",children:[e.jsx(a,{icon:O,className:`me-2 ${s?"text-white":"text-muted"}`}),"User"]}),e.jsxs(l,{className:"text-nowrap",children:[e.jsx(a,{icon:_,className:`me-2 ${s?"text-white":"text-muted"}`}),"Role"]}),e.jsxs(l,{className:"text-nowrap",children:[e.jsx(a,{icon:z,className:`me-2 ${s?"text-white":"text-muted"}`}),"Department"]}),e.jsxs(l,{className:"text-nowrap",children:[e.jsx(a,{icon:V,className:`me-2 ${s?"text-white":"text-muted"}`}),"Route"]}),e.jsxs(l,{className:"text-nowrap",children:[e.jsx(a,{icon:W,className:`me-2 ${s?"text-white":"text-muted"}`}),"Action"]}),e.jsxs(l,{className:"text-nowrap",children:[e.jsx(a,{icon:X,className:`me-2 ${s?"text-white":"text-muted"}`}),"Description"]}),e.jsxs(l,{className:"text-nowrap",children:[e.jsx(a,{icon:Y,className:`me-2 ${s?"text-white":"text-muted"}`}),"Time"]})]})}),e.jsx(K,{children:i.length===0?e.jsx(p,{children:e.jsx(n,{colSpan:7,className:`text-center p-5 ${s?"text-white":"text-muted"}`,children:"No activity records found"})}):i.map(t=>e.jsxs(p,{className:"align-middle",children:[e.jsx(n,{className:"font-weight-bold",children:t.name||"Unknown"}),e.jsx(n,{children:e.jsx(y,{color:s?"light":"dark",shape:"rounded-pill",className:`px-2 py-1 ${s?"text-dark":""}`,children:t.role||"Unknown"})}),e.jsx(n,{children:t.department||"Unknown"}),e.jsx(n,{className:s?"text-info":"text-primary",children:t.route}),e.jsx(n,{children:e.jsx(y,{color:w(t.action),shape:"rounded-pill",className:w(t.action)==="light"?"text-dark":"",children:t.action})}),e.jsx(n,{children:e.jsx(S,{content:t.description,placement:"bottom",children:e.jsx("div",{className:"text-truncate",style:{maxWidth:"200px"},children:t.description})})}),e.jsx(n,{className:"text-nowrap",children:e.jsx(S,{content:new Date(t.timestamp).toLocaleString(),children:e.jsx("span",{children:v(t.timestamp)})})})]},t._id))})]})})}),e.jsx(Q,{className:`${s?"bg-dark text-white border-secondary":"bg-light text-muted"}`,children:e.jsxs(ee,{children:[e.jsx(R,{children:e.jsxs("small",{children:["Showing ",i.length," activities"]})}),e.jsx(R,{className:"text-end",children:e.jsxs("small",{children:["Last updated: ",new Date().toLocaleString()]})})]})})]})})};export{me as default};
