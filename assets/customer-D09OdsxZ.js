import{G as b,j as e}from"./index-Creopves.js";import{r as u,i as w}from"./vendor-react-B6URQkMn.js";import{C as N}from"./customhead-BEnqIsg7.js";import{l as c}from"./activityLogger-BV-zDNkS.js";import{g as S,o as y,S as L,X as T,Z as $,a1 as D,a2 as I,a3 as x,a4 as r,a5 as E,a6 as a,D as R,n as U}from"./vendor-coreui-C9cgcUrA.js";import"./vendor-redux-DipIbRRz.js";import"./axiosInstance-z6yTqPqm.js";const P=()=>{const{data:d,isLoading:j,error:m}=b(),[l,p]=u.useState(""),C=w(),n=sessionStorage.getItem("role"),t=sessionStorage.getItem("department"),i=sessionStorage.getItem("name");if(u.useEffect(()=>{c({name:i,role:n,department:t,route:"/customers",action:"Page Visit",description:"User visited the customers page"})},[i,n,t]),console.log("Fetched customers:",d),j)return e.jsx("div",{children:"Loading..."});if(m)return e.jsxs("div",{children:["Error: ",m.message]});const g=d.filter(s=>s.name.toLowerCase().includes(l.toLowerCase())||s.email.toLowerCase().includes(l.toLowerCase())),f=s=>{c({name:i,role:n,department:t,route:`/details/${s}`,action:"View Customer",description:`User viewed details for customer ID: ${s}`}),C(`/details/${s}`)},v=s=>{const o=s.target.value;p(o),o.length>=3&&c({name:i,role:n,department:t,route:"/customers",action:"Search",description:`User searched for: ${o}`})};return e.jsxs(e.Fragment,{children:[e.jsx(N,{title:"Customers",subtitle:"Manage and view all customer information"}),e.jsx(S,{children:e.jsx(y,{className:"mb-4",children:e.jsxs("div",{className:"p-4",children:[e.jsx(L,{className:"mb-3",children:e.jsx("div",{className:"col-md-6",children:e.jsx(T,{children:e.jsx($,{placeholder:"Search by name or email",value:l,onChange:v})})})}),e.jsxs(D,{hover:!0,responsive:!0,children:[e.jsx(I,{children:e.jsxs(x,{children:[e.jsx(r,{children:"ID"}),e.jsx(r,{children:"Name"}),e.jsx(r,{children:"Email"}),e.jsx(r,{children:"Phone Number"}),e.jsx(r,{children:"Country"}),e.jsx(r,{children:"Occupation"}),e.jsx(r,{children:"Role"}),e.jsx(r,{children:"Actions"})]})}),e.jsx(E,{children:g.map(s=>{var o,h;return e.jsxs(x,{children:[e.jsx(a,{children:s._id}),e.jsx(a,{children:s.name}),e.jsx(a,{children:s.email}),e.jsx(a,{children:s.phoneNumber?s.phoneNumber.replace(/^(\d{3})(\d{3})(\d{4})/,"($1)$2-$3"):"N/A"}),e.jsx(a,{children:s.country}),e.jsx(a,{children:s.occupation}),e.jsx(a,{children:e.jsx(R,{color:((o=s.role)==null?void 0:o.toLowerCase())==="user"?"info":"primary",children:((h=s.role)==null?void 0:h.toLowerCase())==="user"?"User":s.role})}),e.jsx(a,{children:e.jsx(U,{size:"sm",color:"primary",onClick:()=>f(s._id),children:"View"})})]},s._id)})})]})]})})})]})};export{P as default};
