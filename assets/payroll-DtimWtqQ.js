import{j as e}from"./index-CssPjSvR.js";import{r as d,R as B}from"./vendor-react-B6URQkMn.js";import{a as O}from"./axiosInstance-Dv2jt_v_.js";import{F as x,I as U,Y as $,Z as G,_ as H,$ as J,a0 as q}from"./index-HEMnEFLK.js";import{N as T,O as S,k as V,X,j as b,l as Y,T as Z,U as z,V as K,C as Q,S as W,$ as ee,a0 as se,a1 as k,a2 as l,a3 as re,a4 as t,y as ae,ac as te,ad as P}from"./vendor-coreui-CVCUzX7i.js";import"./vendor-redux-DipIbRRz.js";import"./index-t--hEgTQ.js";const he=()=>{const[h,p]=d.useState([]),[j,v]=d.useState(!0),[u,I]=d.useState(null),[F,A]=d.useState(""),[r,E]=d.useState({key:"id",direction:"ascending"}),[m,y]=d.useState(1),g=10;d.useEffect(()=>{C()},[]);const C=async()=>{try{v(!0);const s=await O.get("/hr/payroll");s.data&&Array.isArray(s.data)?p(s.data):(console.warn("Unexpected API response format:",s.data),p([])),I(null)}catch(s){I("Failed to fetch payroll data. Please try again later."),console.error("Error fetching payroll data:",s),p([])}finally{v(!1)}},n=s=>{let a="ascending";r.key===s&&r.direction==="ascending"&&(a="descending"),E({key:s,direction:a})},o=s=>r.key!==s?e.jsx(x,{icon:H,className:"ms-1 text-gray-400"}):r.direction==="ascending"?e.jsx(x,{icon:J,className:"ms-1"}):e.jsx(x,{icon:q,className:"ms-1"}),f=B.useMemo(()=>r.key?[...h].sort((s,a)=>{const c=s[r.key],i=a[r.key];return!isNaN(parseFloat(c))&&!isNaN(parseFloat(i))?r.direction==="ascending"?parseFloat(c)-parseFloat(i):parseFloat(i)-parseFloat(c):typeof c=="string"&&typeof i=="string"?r.direction==="ascending"?c.localeCompare(i):i.localeCompare(c):c<i?r.direction==="ascending"?-1:1:c>i?r.direction==="ascending"?1:-1:0}):h,[h,r]).filter(s=>Object.values(s).some(a=>a&&a.toString().toLowerCase().includes(F.toLowerCase()))),w=m*g,M=w-g,_=f.slice(M,w),N=Math.ceil(f.length/g),D=s=>s==null?"N/A":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s),R=s=>["January","February","March","April","May","June","July","August","September","October","November","December"][s-1]||`Month ${s}`,L=s=>{switch(s==null?void 0:s.toLowerCase()){case"paid":return"success";case"pending":return"warning";case"failed":return"danger";default:return"secondary"}};return e.jsx("div",{className:"mb-4",children:e.jsx(T,{children:e.jsx(S,{children:e.jsxs(V,{className:"mb-4",children:[e.jsxs(X,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h4",{className:"mb-0",children:"Payroll Management"}),e.jsxs("div",{children:[e.jsxs(b,{color:"light",className:"me-2",onClick:C,children:[e.jsx(x,{icon:U,className:"me-1"})," Refresh"]}),e.jsxs(b,{color:"primary",children:[e.jsx(x,{icon:$,className:"me-1"}),"Generate Report"]})]})]}),e.jsxs(Y,{children:[e.jsxs(T,{className:"mb-3",children:[e.jsx(S,{md:6,children:e.jsxs(Z,{children:[e.jsx(z,{children:e.jsx(x,{icon:G})}),e.jsx(K,{placeholder:"Search payroll...",value:F,onChange:s=>A(s.target.value)})]})}),e.jsx(S,{md:6,className:"d-flex justify-content-end align-items-center",children:!j&&!u&&e.jsxs("small",{className:"text-medium-emphasis",children:["Showing ",f.length," of ",h.length," records"]})})]}),j&&e.jsxs("div",{className:"text-center p-5",children:[e.jsx(Q,{color:"primary"}),e.jsx("div",{className:"mt-3",children:"Loading payroll data..."})]}),u&&e.jsxs(W,{color:"danger",children:[u,e.jsx(b,{color:"link",className:"p-0 ms-2",onClick:C,children:"Try again"})]}),!j&&!u&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"table-responsive",children:e.jsxs(ee,{hover:!0,bordered:!0,children:[e.jsx(se,{color:"light",children:e.jsxs(k,{children:[e.jsxs(l,{onClick:()=>n("id"),style:{cursor:"pointer"},children:["ID ",o("id")]}),e.jsxs(l,{onClick:()=>n("employee_id"),style:{cursor:"pointer"},children:["Employee ID ",o("employee_id")]}),e.jsxs(l,{onClick:()=>n("name"),style:{cursor:"pointer"},children:["Employee ",o("name")]}),e.jsxs(l,{onClick:()=>n("department"),style:{cursor:"pointer"},children:["Department ",o("department")]}),e.jsxs(l,{onClick:()=>n("job_position"),style:{cursor:"pointer"},children:["Position ",o("job_position")]}),e.jsxs(l,{onClick:()=>n("gross_salary"),style:{cursor:"pointer"},className:"text-end",children:["Gross Pay ",o("gross_salary")]}),e.jsxs(l,{onClick:()=>n("net_salary"),style:{cursor:"pointer"},className:"text-end",children:["Net Pay ",o("net_salary")]}),e.jsxs(l,{onClick:()=>n("year"),style:{cursor:"pointer"},className:"text-center",children:["Period ",o("year")]}),e.jsxs(l,{onClick:()=>n("status"),style:{cursor:"pointer"},className:"text-center",children:["Status ",o("status")]})]})}),e.jsx(re,{children:_.length>0?_.map((s,a)=>e.jsxs(k,{children:[e.jsx(t,{children:s.id||"—"}),e.jsx(t,{children:s.employee_id||"—"}),e.jsx(t,{children:s.name||"—"}),e.jsx(t,{children:s.department||"—"}),e.jsx(t,{children:s.job_position||"—"}),e.jsx(t,{className:"text-end",children:D(s.gross_salary)}),e.jsx(t,{className:"text-end",children:D(s.net_salary)}),e.jsx(t,{className:"text-center",children:`${R(s.month)}, ${s.year}`}),e.jsx(t,{className:"text-center",children:e.jsx(ae,{color:L(s.status),children:s.status||"Pending"})})]},s.id||a)):e.jsx(k,{children:e.jsx(t,{colSpan:"10",className:"text-center p-4 text-medium-emphasis",children:"No payroll records found."})})})]})}),N>1&&e.jsxs(te,{className:"mt-3 justify-content-center","aria-label":"Page navigation",children:[e.jsx(P,{disabled:m===1,onClick:()=>y(m-1),children:"Previous"}),Array.from({length:N},(s,a)=>a+1).map(s=>e.jsx(P,{active:s===m,onClick:()=>y(s),children:s},s)),e.jsx(P,{disabled:m===N,onClick:()=>y(m+1),children:"Next"})]})]})]})]})})})})};export{he as default};
