import{H as C,j as e}from"./index-HAz-9vrD.js";import{r as I}from"./vendor-react-B6URQkMn.js";import{M as S,N as m,a8 as g,o as u,k as D,a1 as f,j as p,l as w,X as b,Y as H,Z as h,_ as s,$ as M,a0 as o,y as N}from"./vendor-coreui-BGyit7oL.js";import{l as c}from"./activityLogger-DIotgneL.js";import"./vendor-redux-DipIbRRz.js";import"./axiosInstance-CnxFScdD.js";import"./index-D8rVyQy1.js";var $=["512 512","<polygon fill='var(--ci-primary-color, currentColor)' points='271.514 95.5 239.514 95.5 239.514 273.611 355.127 328.559 368.864 299.657 271.514 253.389 271.514 95.5' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M256,16C123.452,16,16,123.452,16,256S123.452,496,256,496,496,388.548,496,256,388.548,16,256,16Zm0,448C141.125,464,48,370.875,48,256S141.125,48,256,48s208,93.125,208,208S370.875,464,256,464Z' class='ci-primary'/>"],Z=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M432,64H16V384H432ZM400,352H48V96H400Z' class='ci-primary'/><polygon fill='var(--ci-primary-color, currentColor)' points='464 144 464 416 96 416 96 448 496 448 496 144 464 144' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M224,302.46c39.7,0,72-35.137,72-78.326s-32.3-78.326-72-78.326-72,35.136-72,78.326S184.3,302.46,224,302.46Zm0-124.652c22.056,0,40,20.782,40,46.326s-17.944,46.326-40,46.326-40-20.782-40-46.326S201.944,177.808,224,177.808Z' class='ci-primary'/><rect width='32' height='176' x='80' y='136' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='176' x='336' y='136' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/>"],A=["512 512","<rect width='32' height='176' x='240' y='176' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='240' y='384' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M274.014,16H237.986L16,445.174V496H496V445.174ZM464,464H48V452.959L256,50.826,464,452.959Z' class='ci-primary'/>"];const k=()=>{const{data:a=[],isLoading:l,error:n}=C();I.useEffect(()=>{const r=sessionStorage.getItem("name"),t=sessionStorage.getItem("role"),i=sessionStorage.getItem("department");c({name:r,role:t,department:i,route:"/invoicing",action:"View Invoice Dashboard",description:"User accessed the invoice management dashboard"}),n&&c({name:r,role:t,department:i,route:"/invoicing",action:"Error",description:`Error occurred while loading invoice data: ${n.message}`}),a.length>0&&!l&&c({name:r,role:t,department:i,route:"/invoicing",action:"Data Loaded",description:`Successfully loaded ${a.length} invoices`})},[a,n,l]);const d=a.length>0?{totalInvoices:a.length,pendingAmount:a.filter(r=>r.paymentStatus==="Pending").reduce((r,t)=>r+t.amountDue,0),overdueinvoices:a.filter(r=>r.paymentStatus==="Pending"&&new Date(r.dueDate)<new Date).length}:{totalInvoices:0,pendingAmount:0,overdueinvoices:0},x=(r,t)=>{const i=sessionStorage.getItem("name"),j=sessionStorage.getItem("role"),y=sessionStorage.getItem("department");c({name:i,role:j,department:y,route:"/invoicing",action:"Update Invoice Status",description:`User updated invoice ${r} status to ${t}`}),console.log(`Updating invoice ${r} to status ${t}`)},v=()=>{const r=sessionStorage.getItem("name"),t=sessionStorage.getItem("role"),i=sessionStorage.getItem("department");c({name:r,role:t,department:i,route:"/invoicing",action:"Create Invoice",description:"User initiated invoice creation process"}),console.log("Creating new invoice")};return l?e.jsx("p",{children:"Loading invoices..."}):n?e.jsxs("p",{children:["Error loading invoices: ",n.message]}):e.jsxs("div",{className:"p-4",children:[e.jsx("h2",{className:"mb-4",children:"Invoice Management"}),e.jsxs(S,{className:"mb-4",children:[e.jsx(m,{sm:6,lg:4,children:e.jsx(g,{icon:e.jsx(u,{icon:Z,height:24}),title:"Total Invoices",value:d.totalInvoices.toString(),color:"primary"})}),e.jsx(m,{sm:6,lg:4,children:e.jsx(g,{icon:e.jsx(u,{icon:$,height:24}),title:"Pending Amount",value:`$${d.pendingAmount.toLocaleString()}`,color:"warning"})}),e.jsx(m,{sm:6,lg:4,children:e.jsx(g,{icon:e.jsx(u,{icon:A,height:24}),title:"Overdue Invoices",value:d.overdueinvoices.toString(),color:"danger"})})]}),e.jsxs(D,{children:[e.jsxs(f,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("strong",{children:"Invoices"}),e.jsx(p,{color:"primary",onClick:v,children:"Create Invoice"})]}),e.jsx(w,{children:a.length>0?e.jsxs(b,{hover:!0,responsive:!0,children:[e.jsx(H,{children:e.jsxs(h,{children:[e.jsx(s,{children:"Invoice ID"}),e.jsx(s,{children:"Customer ID"}),e.jsx(s,{children:"Amount Due"}),e.jsx(s,{children:"Due Date"}),e.jsx(s,{children:"Status"}),e.jsx(s,{children:"Actions"})]})}),e.jsx(M,{children:a.map(r=>e.jsxs(h,{children:[e.jsx(o,{children:r.invoiceId}),e.jsx(o,{children:r.customerId}),e.jsxs(o,{children:["$",r.amountDue.toLocaleString()]}),e.jsx(o,{children:new Date(r.dueDate).toLocaleDateString()}),e.jsx(o,{children:e.jsxs(N,{color:r.paymentStatus==="Paid"?"success":new Date(r.dueDate)<new Date?"danger":"warning",children:[r.paymentStatus,r.paymentStatus==="Pending"&&new Date(r.dueDate)<new Date&&" (Overdue)"]})}),e.jsx(o,{children:r.paymentStatus==="Pending"&&e.jsx(p,{color:"success",size:"sm",onClick:()=>x(r.invoiceId,"Paid"),children:"Mark as Paid"})})]},r._id))})]}):e.jsx("p",{className:"text-center",children:"No Data Available"})})]})]})};export{k as default};
