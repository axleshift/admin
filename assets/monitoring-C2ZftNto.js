import{o as ge,p as fe,j as e}from"./index-Ac1Taqs-.js";import{R as v,r as f}from"./vendor-react-B6URQkMn.js";import{l as C}from"./activityLogger-CswLieGG.js";import{N,O as o,K as Ce,q as P,r as B,k as M,a2 as R,l as D,V as b,W as I,C as H,Y as V,Z as _,_ as j,$ as a,a0 as G,a1 as i,y as L,j as ee}from"./vendor-coreui-vXCAeGSv.js";import"./vendor-redux-DipIbRRz.js";import"./axiosInstance-Dv2jt_v_.js";import"./index-t--hEgTQ.js";var oe={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},te=v.createContext&&v.createContext(oe),ye=["attr","size","title"];function Ne(s,n){if(s==null)return{};var r=be(s,n),c,h;if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);for(h=0;h<g.length;h++)c=g[h],!(n.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(s,c)&&(r[c]=s[c])}return r}function be(s,n){if(s==null)return{};var r={};for(var c in s)if(Object.prototype.hasOwnProperty.call(s,c)){if(n.indexOf(c)>=0)continue;r[c]=s[c]}return r}function O(){return O=Object.assign?Object.assign.bind():function(s){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(s[c]=r[c])}return s},O.apply(this,arguments)}function se(s,n){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(s);n&&(c=c.filter(function(h){return Object.getOwnPropertyDescriptor(s,h).enumerable})),r.push.apply(r,c)}return r}function F(s){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?se(Object(r),!0).forEach(function(c){Se(s,c,r[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):se(Object(r)).forEach(function(c){Object.defineProperty(s,c,Object.getOwnPropertyDescriptor(r,c))})}return s}function Se(s,n,r){return n=Ae(n),n in s?Object.defineProperty(s,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[n]=r,s}function Ae(s){var n=Ie(s,"string");return typeof n=="symbol"?n:n+""}function Ie(s,n){if(typeof s!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var c=r.call(s,n);if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(s)}function de(s){return s&&s.map((n,r)=>v.createElement(n.tag,F({key:r},n.attr),de(n.child)))}function u(s){return n=>v.createElement(Le,O({attr:F({},s.attr)},n),de(s.child))}function Le(s){var n=r=>{var{attr:c,size:h,title:g}=s,m=Ne(s,ye),S=h||r.size||"1em",x;return r.className&&(x=r.className),s.className&&(x=(x?x+" ":"")+s.className),v.createElement("svg",O({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,c,m,{className:x,style:F(F({color:s.color||r.color},r.style),s.style),height:S,width:S,xmlns:"http://www.w3.org/2000/svg"}),g&&v.createElement("title",null,g),s.children)};return te!==void 0?v.createElement(te.Consumer,null,r=>n(r)):n(oe)}function re(s){return u({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M436 480h-20V24c0-13.255-10.745-24-24-24H56C42.745 0 32 10.745 32 24v456H12c-6.627 0-12 5.373-12 12v20h448v-20c0-6.627-5.373-12-12-12zM128 76c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12V76zm0 96c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40zm52 148h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12zm76 160h-64v-84c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v84zm64-172c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40zm0-96c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40zm0-96c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12V76c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40z"},child:[]}]})(s)}function Oe(s){return u({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"},child:[]}]})(s)}function Fe(s){return u({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM96 424c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm96-192c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm128 368c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16z"},child:[]}]})(s)}function $(s){return u({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"},child:[]}]})(s)}function ne(s){return u({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},child:[]}]})(s)}function k(s){return u({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.976 0H24.028C2.71 0-8.047 25.866 7.058 40.971L192 225.941V432c0 7.831 3.821 15.17 10.237 19.662l80 55.98C298.02 518.69 320 507.493 320 487.98V225.941l184.947-184.97C520.021 25.896 509.338 0 487.976 0z"},child:[]}]})(s)}function ce(s){return u({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z"},child:[]}]})(s)}function ie(s){return u({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M512 176.001C512 273.203 433.202 352 336 352c-11.22 0-22.19-1.062-32.827-3.069l-24.012 27.014A23.999 23.999 0 0 1 261.223 384H224v40c0 13.255-10.745 24-24 24h-40v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24v-78.059c0-6.365 2.529-12.47 7.029-16.971l161.802-161.802C163.108 213.814 160 195.271 160 176 160 78.798 238.797.001 335.999 0 433.488-.001 512 78.511 512 176.001zM336 128c0 26.51 21.49 48 48 48s48-21.49 48-48-21.49-48-48-48-48 21.49-48 48z"},child:[]}]})(s)}function Te(s){return u({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M202.021 0C122.202 0 70.503 32.703 29.914 91.026c-7.363 10.58-5.093 25.086 5.178 32.874l43.138 32.709c10.373 7.865 25.132 6.026 33.253-4.148 25.049-31.381 43.63-49.449 82.757-49.449 30.764 0 68.816 19.799 68.816 49.631 0 22.552-18.617 34.134-48.993 51.164-35.423 19.86-82.299 44.576-82.299 106.405V320c0 13.255 10.745 24 24 24h72.471c13.255 0 24-10.745 24-24v-5.773c0-42.86 125.268-44.645 125.268-160.627C377.504 66.256 286.902 0 202.021 0zM192 373.459c-38.196 0-69.271 31.075-69.271 69.271 0 38.195 31.075 69.27 69.271 69.27s69.271-31.075 69.271-69.271-31.075-69.27-69.271-69.27z"},child:[]}]})(s)}function ze(s){return u({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M416 320h-96c-17.6 0-32-14.4-32-32s14.4-32 32-32h96s96-107 96-160-43-96-96-96-96 43-96 96c0 25.5 22.2 63.4 45.3 96H320c-52.9 0-96 43.1-96 96s43.1 96 96 96h96c17.6 0 32 14.4 32 32s-14.4 32-32 32H185.5c-16 24.8-33.8 47.7-47.3 64H416c52.9 0 96-43.1 96-96s-43.1-96-96-96zm0-256c17.7 0 32 14.3 32 32s-14.3 32-32 32-32-14.3-32-32 14.3-32 32-32zM96 256c-53 0-96 43-96 96s96 160 96 160 96-107 96-160-43-96-96-96zm0 128c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"},child:[]}]})(s)}function ae(s){return u({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 160H48c-26.51 0-48 21.49-48 48v224c0 26.51 21.49 48 48 48h16v16c0 8.84 7.16 16 16 16h32c8.84 0 16-7.16 16-16v-16h128v16c0 8.84 7.16 16 16 16h32c8.84 0 16-7.16 16-16v-16h16c26.51 0 48-21.49 48-48V208c0-26.51-21.49-48-48-48zm-16 216c0 4.42-3.58 8-8 8H72c-4.42 0-8-3.58-8-8v-16c0-4.42 3.58-8 8-8h240c4.42 0 8 3.58 8 8v16zm0-96c0 4.42-3.58 8-8 8H72c-4.42 0-8-3.58-8-8v-16c0-4.42 3.58-8 8-8h240c4.42 0 8 3.58 8 8v16zM144 48h96v80h48V48c0-26.51-21.49-48-48-48h-96c-26.51 0-48 21.49-48 48v80h48V48z"},child:[]}]})(s)}function Ee(s){return u({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(s)}function le(s){return u({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M622.3 271.1l-115.2-45c-4.1-1.6-12.6-3.7-22.2 0l-115.2 45c-10.7 4.2-17.7 14-17.7 24.9 0 111.6 68.7 188.8 132.9 213.9 9.6 3.7 18 1.6 22.2 0C558.4 489.9 640 420.5 640 296c0-10.9-7-20.7-17.7-24.9zM496 462.4V273.3l95.5 37.3c-5.6 87.1-60.9 135.4-95.5 151.8zM224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm96 40c0-2.5.8-4.8 1.1-7.2-2.5-.1-4.9-.8-7.5-.8h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c6.8 0 13.3-1.5 19.2-4-54-42.9-99.2-116.7-99.2-212z"},child:[]}]})(s)}function we(s){return u({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(s)}const Ve=()=>{const[s,n]=f.useState("alerts"),[r,c]=f.useState({name:"",role:"",department:""});f.useEffect(()=>{const t={name:localStorage.getItem("userName")||"Admin User",role:localStorage.getItem("userRole")||"Administrator",department:localStorage.getItem("userDepartment")||"IT Security"};c(t)},[]);const[h,g]=f.useState({userId:"",alertType:"",status:""}),[m,S]=f.useState({userId:"",status:"",ipAddress:""}),[x,Q]=f.useState({name:"",action:"",route:""}),ue=()=>{const t={...m};return t.status==="attempt"&&(delete t.status,t.emptyUserId=!0),t},{data:K=[],isLoading:he,error:W}=ge(h),{data:A=[],isLoading:me,error:Z}=fe(ue()),{data:q=[],isLoading:xe,error:J}=useGetUserActivitiesQuery(x),X=v.useMemo(()=>m.status==="attempt"?A.filter(t=>!t.userId||t.userId===""||t.userId===null||t.userId===void 0):m.status==="success"||m.status==="failed"?A.filter(t=>t.status===m.status&&t.userId&&t.userId!==""&&t.userId!==null&&t.userId!==void 0):A,[A,m.status]),T=t=>{n(t),C({name:r.name,role:r.role,department:r.department,route:`/security/${t}`,action:"Tab Change",description:`User navigated to ${t} tab in Security Dashboard`})},z=t=>{const{name:d,value:p}=t.target;g(y=>({...y,[d]:p})),C({name:r.name,role:r.role,department:r.department,route:"/security/alerts",action:"Filter Change",description:`User filtered alerts by ${d}=${p}`})},E=t=>{const{name:d,value:p}=t.target;S(y=>({...y,[d]:p})),C({name:r.name,role:r.role,department:r.department,route:"/security/logins",action:"Filter Change",description:`User filtered login attempts by ${d}=${p}`})},w=t=>{const{name:d,value:p}=t.target;Q(y=>({...y,[d]:p})),C({name:r.name,role:r.role,department:r.department,route:"/security/activity",action:"Filter Change",description:`User filtered activity logs by ${d}=${p}`})},U=t=>new Date(t).toLocaleString(),Y=(t,d=!1)=>{if(d)return t==="attempt"?"warning":t==="success"?"success":"danger";switch(t){case"OPEN":return"warning";case"RESOLVED":return"success";case"FALSE_POSITIVE":return"info";default:return"secondary"}},je=t=>{switch(t){case"SUSPICIOUS_LOGIN":return"warning";case"BRUTE_FORCE":return"danger";case"MULTIPLE_FAILURES":return"danger";case"UNUSUAL_LOCATION":return"info";default:return"secondary"}},pe=t=>{switch(t.toUpperCase()){case"LOGIN":return"success";case"LOGOUT":return"info";case"TAB CHANGE":return"secondary";case"FILTER CHANGE":return"primary";case"BUTTON CLICK":return"warning";case"DATA EXPORT":return"dark";case"ALERT ACTION":return"danger";default:return"light"}},l=t=>t==null?"-":typeof t=="object"?t.name?t.name:t.id?t.id:t.toString&&t.toString()!=="[object Object]"?t.toString():JSON.stringify(t):t,ve=t=>!t.userId||t.userId===""||t.userId===null||t.userId===void 0?"attempt":t.status;return e.jsx("div",{className:"security-dashboard",children:e.jsx(N,{children:e.jsxs(o,{children:[e.jsxs(Ce,{variant:"tabs",className:"mb-4",children:[e.jsx(P,{children:e.jsxs(B,{active:s==="alerts",onClick:()=>T("alerts"),children:[e.jsx(ne,{className:"me-2"})," Security Alerts"]})}),e.jsx(P,{children:e.jsxs(B,{active:s==="logins",onClick:()=>T("logins"),children:[e.jsx(ie,{className:"me-2"})," Login Attempts"]})}),e.jsx(P,{children:e.jsxs(B,{active:s==="activity",onClick:()=>T("activity"),children:[e.jsx(ce,{className:"me-2"})," User Activity"]})})]}),s==="alerts"&&e.jsxs(M,{className:"mb-4",children:[e.jsx(R,{children:e.jsxs("strong",{children:[e.jsx(ne,{className:"me-2"})," Security Alerts"]})}),e.jsxs(D,{children:[e.jsxs(N,{className:"mb-3 filter-section",children:[e.jsx(o,{sm:12,children:e.jsxs("h6",{children:[e.jsx(k,{className:"me-2"})," Filters"]})}),e.jsx(o,{sm:3,children:e.jsx(b,{placeholder:"User ID",name:"userId",value:h.userId,onChange:z,className:"mb-2"})}),e.jsx(o,{sm:3,children:e.jsxs(I,{name:"alertType",value:h.alertType,onChange:z,className:"mb-2",children:[e.jsx("option",{value:"",children:"All Alert Types"}),e.jsx("option",{value:"SUSPICIOUS_LOGIN",children:"Suspicious Login"}),e.jsx("option",{value:"BRUTE_FORCE",children:"Brute Force"}),e.jsx("option",{value:"MULTIPLE_FAILURES",children:"Multiple Failures"}),e.jsx("option",{value:"UNUSUAL_LOCATION",children:"Unusual Location"})]})}),e.jsx(o,{sm:3,children:e.jsxs(I,{name:"status",value:h.status,onChange:z,className:"mb-2",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"OPEN",children:"Open"}),e.jsx("option",{value:"RESOLVED",children:"Resolved"}),e.jsx("option",{value:"FALSE_POSITIVE",children:"False Positive"})]})})]}),W&&e.jsxs("div",{className:"alert alert-danger",children:["Failed to load security alerts: ",W.toString()]}),he?e.jsxs("div",{className:"text-center py-5",children:[e.jsx(H,{color:"primary"}),e.jsx("p",{className:"mt-3",children:"Loading security alerts..."})]}):e.jsxs(V,{hover:!0,responsive:!0,children:[e.jsx(_,{children:e.jsxs(j,{children:[e.jsx(a,{children:"Alert Type"}),e.jsx(a,{children:"User"}),e.jsx(a,{children:"Timestamp"}),e.jsx(a,{children:"Details"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Resolution"})]})}),e.jsx(G,{children:K.length===0?e.jsx(j,{children:e.jsx(i,{colSpan:"6",className:"text-center",children:"No security alerts found"})}):K.map(t=>e.jsxs(j,{children:[e.jsx(i,{children:e.jsx(L,{color:je(t.alertType),children:l(t.alertType)})}),e.jsxs(i,{children:[e.jsx(le,{className:"me-1"}),typeof t.userId=="object"&&t.userId!==null&&l(t.userId.name)||l(t.userId)]}),e.jsxs(i,{children:[e.jsx($,{className:"me-1"}),t.timestamp?U(t.timestamp):"-"]}),e.jsx(i,{children:l(t.details)}),e.jsx(i,{children:e.jsx(L,{color:Y(t.status),children:l(t.status)})}),e.jsx(i,{children:t.resolution&&typeof t.resolution=="object"?l(t.resolution.notes):"-"})]},t._id))})]})]})]}),s==="logins"&&e.jsxs(M,{className:"mb-4",children:[e.jsx(R,{children:e.jsxs("strong",{children:[e.jsx(ie,{className:"me-2"})," Login Attempts"]})}),e.jsxs(D,{children:[e.jsxs(N,{className:"mb-3 filter-section",children:[e.jsx(o,{sm:12,children:e.jsxs("h6",{children:[e.jsx(k,{className:"me-2"})," Filters"]})}),e.jsx(o,{sm:3,children:e.jsx(b,{placeholder:"User ID",name:"userId",value:m.userId,onChange:E,className:"mb-2"})}),e.jsx(o,{sm:3,children:e.jsx(b,{placeholder:"IP Address",name:"ipAddress",value:m.ipAddress,onChange:E,className:"mb-2"})}),e.jsx(o,{sm:3,children:e.jsxs(I,{name:"status",value:m.status,onChange:E,className:"mb-2",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"success",children:"Success"}),e.jsx("option",{value:"failed",children:"Failed"}),e.jsx("option",{value:"attempt",children:"Attempt"})]})})]}),Z&&e.jsxs("div",{className:"alert alert-danger",children:["Failed to load login attempts: ",Z.toString()]}),me?e.jsxs("div",{className:"text-center py-5",children:[e.jsx(H,{color:"primary"}),e.jsx("p",{className:"mt-3",children:"Loading login attempts..."})]}):e.jsxs(V,{hover:!0,responsive:!0,children:[e.jsx(_,{children:e.jsxs(j,{children:[e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Name"}),e.jsx(a,{children:"Role"}),e.jsx(a,{children:"Department"}),e.jsx(a,{children:"Device/Browser"}),e.jsx(a,{children:"Timestamp"})]})}),e.jsx(G,{children:X.length===0?e.jsx(j,{children:e.jsx(i,{colSpan:"7",className:"text-center",children:"No login attempts found"})}):X.map(t=>{const d=ve(t);return e.jsxs(j,{children:[e.jsx(i,{children:e.jsx(L,{color:Y(d,!0),children:d==="success"?e.jsxs(e.Fragment,{children:[e.jsx(Oe,{className:"me-1"})," SUCCESS"]}):d==="attempt"?e.jsxs(e.Fragment,{children:[e.jsx(Te,{className:"me-1"})," ATTEMPT"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"me-1"})," FAILED"]})})}),e.jsxs(i,{children:[e.jsx(le,{className:"me-1"}),l(t.name)]}),e.jsxs(i,{children:[e.jsx(ae,{className:"me-1"}),l(t.role)]}),e.jsxs(i,{children:[e.jsx(re,{className:"me-1"}),l(t.department)]}),e.jsx(i,{children:l(t.userAgent)}),e.jsxs(i,{children:[e.jsx($,{className:"me-1"}),t.timestamp?U(t.timestamp):"-"]})]},t._id)})})]})]})]}),s==="activity"&&e.jsxs(M,{className:"mb-4",children:[e.jsx(R,{children:e.jsxs("strong",{children:[e.jsx(ce,{className:"me-2"})," User Activity Logs"]})}),e.jsxs(D,{children:[e.jsxs(N,{className:"mb-3 filter-section",children:[e.jsx(o,{sm:12,children:e.jsxs("h6",{children:[e.jsx(k,{className:"me-2"})," Filters"]})}),e.jsx(o,{sm:3,children:e.jsx(b,{placeholder:"User Name",name:"name",value:x.name,onChange:w,className:"mb-2"})}),e.jsx(o,{sm:3,children:e.jsx(b,{placeholder:"Route",name:"route",value:x.route,onChange:w,className:"mb-2"})}),e.jsx(o,{sm:3,children:e.jsxs(I,{name:"action",value:x.action,onChange:w,className:"mb-2",children:[e.jsx("option",{value:"",children:"All Actions"}),e.jsx("option",{value:"Login",children:"Login"}),e.jsx("option",{value:"Logout",children:"Logout"}),e.jsx("option",{value:"Tab Change",children:"Tab Change"}),e.jsx("option",{value:"Filter Change",children:"Filter Change"}),e.jsx("option",{value:"Button Click",children:"Button Click"}),e.jsx("option",{value:"Data Export",children:"Data Export"}),e.jsx("option",{value:"Alert Action",children:"Alert Action"})]})}),e.jsx(o,{sm:3,children:e.jsx(ee,{color:"secondary",onClick:()=>{Q({name:"",action:"",route:""}),C({name:r.name,role:r.role,department:r.department,route:"/security/activity",action:"Reset Filters",description:"User reset activity filters"})},className:"mb-2",children:"Reset Filters"})})]}),J&&e.jsxs("div",{className:"alert alert-danger",children:["Failed to load user activities: ",J.toString()]}),xe?e.jsxs("div",{className:"text-center py-5",children:[e.jsx(H,{color:"primary"}),e.jsx("p",{className:"mt-3",children:"Loading user activities..."})]}):e.jsxs(V,{hover:!0,responsive:!0,children:[e.jsx(_,{children:e.jsxs(j,{children:[e.jsx(a,{children:"Timestamp"}),e.jsx(a,{children:"User"}),e.jsx(a,{children:"Role"}),e.jsx(a,{children:"Department"}),e.jsx(a,{children:"Action"}),e.jsx(a,{children:"Route"}),e.jsx(a,{children:"Description"})]})}),e.jsx(G,{children:q.length===0?e.jsx(j,{children:e.jsx(i,{colSpan:"7",className:"text-center",children:"No user activities found"})}):q.map(t=>e.jsxs(j,{children:[e.jsxs(i,{children:[e.jsx($,{className:"me-1"}),t.timestamp?U(t.timestamp):"-"]}),e.jsxs(i,{children:[e.jsx(we,{className:"me-1"}),l(t.name)]}),e.jsxs(i,{children:[e.jsx(ae,{className:"me-1"}),l(t.role)]}),e.jsxs(i,{children:[e.jsx(re,{className:"me-1"}),l(t.department)]}),e.jsx(i,{children:e.jsx(L,{color:pe(t.action),children:l(t.action)})}),e.jsxs(i,{children:[e.jsx(ze,{className:"me-1"}),l(t.route)]}),e.jsxs(i,{children:[e.jsx(Fe,{className:"me-1"}),l(t.description)]})]},t._id))})]}),e.jsx(N,{className:"mt-3",children:e.jsx(o,{sm:12,children:e.jsx(ee,{color:"primary",onClick:()=>{C({name:r.name,role:r.role,department:r.department,route:"/security/activity",action:"Data Export",description:"User exported activity logs"}),alert("Activity logs exported successfully")},children:"Export Activity Logs"})})})]})]})]})})})};export{Ve as default};
