import{q as T,s as k,t as N,r as l,j as e}from"./index-BizKBI6a.js";import{C as E}from"./customhead-t2LJNxRX.js";import{E as O}from"./exceljs.min-BPnPlXgj.js";import{F as A}from"./FileSaver.min-DjNVfYMz.js";import{F as L,t as _,s as U}from"./DefaultLayout-CnpPbvhY.js";import{C as V,a as p,b as B}from"./index.esm-LX8wyrY9.js";import{a as d}from"./CFormInput-BYAzJEzi.js";import{C as F,a as I,b as x,c as a,d as R,e as s}from"./CTable-D-tPmOjy.js";import{C as M}from"./CFormSelect-BBQbi0Yz.js";import"./CCardBody-cs6hLwSm.js";import"./CCardTitle-DUMIo4Tm.js";import"./chatbox-V5kNCwUM.js";import"./cil-magnifying-glass-COgjSVTM.js";import"./CCloseButton-CGgGdGd-.js";import"./index-D8rVyQy1.js";const re=()=>{const{data:i,error:c,isLoading:D}=T(),[j]=k(),[y]=N(),[u,f]=l.useState({}),[S,m]=l.useState(!1),[w,h]=l.useState(!1),C=async t=>{m(!0);try{const r=u[t]||"Pending";await j({id:t,status:r,deliveryDate:r==="Delivered"?new Date:null}),alert("Shipping status updated successfully!")}catch{alert("Error updating shipping status.")}finally{m(!1)}},g=async t=>{if(window.confirm("Are you sure you want to delete this shipping entry?")){h(!0);try{await y(t),alert("Shipping entry deleted successfully!")}catch{alert("Error deleting shipping entry.")}finally{h(!1)}}},v=async()=>{if(!i)return;const t=new O.Workbook,r=t.addWorksheet("Transactions");r.columns=[{header:"Customer Name",key:"CustomerName",width:20},{header:"Order Volume (kg)",key:"OrderVolume",width:15},{header:"Shipping Type",key:"ShippingType",width:15},{header:"Order Date",key:"OrderDate",width:20},{header:"Status",key:"Status",width:15},{header:"Delivery Date",key:"DeliveryDate",width:20}],i.forEach(n=>{r.addRow({CustomerName:n.customerName,OrderVolume:`${n.orderVolume} kg`,ShippingType:n.shippingType,OrderDate:new Date(n.orderDate).toLocaleDateString(),Status:n.status,DeliveryDate:n.deliveryDate?new Date(n.deliveryDate).toLocaleString():"N/A"})});const o=await t.xlsx.writeBuffer(),b=new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});A.saveAs(b,"shipping_transactions.xlsx")};return D?e.jsx("p",{children:"Loading..."}):c?e.jsxs("p",{children:["Error loading shipping data: ",c.message]}):e.jsxs(V,{m:"1.5rem 2.5rem",children:[e.jsx(p,{children:e.jsx(E,{title:"TRANSACTIONS",subtitle:"List of Transactions"})}),e.jsx(p,{className:"p-2",children:e.jsx(B,{xs:"auto",children:e.jsx(d,{color:"Gray",onClick:v,children:e.jsx(L,{icon:_})})})}),e.jsxs(F,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[e.jsx(I,{children:e.jsxs(x,{children:[e.jsx(a,{children:"Customer Name"}),e.jsx(a,{children:"Order Volume (kg)"}),e.jsx(a,{children:"Shipping Type"}),e.jsx(a,{children:"Order Date"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Delivery Date"}),e.jsx(a,{children:"Update Status"}),e.jsx(a,{children:"Actions"})]})}),e.jsx(R,{children:i&&i.map(t=>e.jsxs(x,{children:[e.jsx(s,{children:t.customerName}),e.jsx(s,{children:t.orderVolume}),e.jsx(s,{children:t.shippingType}),e.jsx(s,{children:new Date(t.orderDate).toLocaleDateString()}),e.jsx(s,{children:e.jsx(U,{color:t.status==="Delivered"?"success":"warning",children:t.status})}),e.jsx(s,{children:t.deliveryDate?new Date(t.deliveryDate).toLocaleDateString():"N/A"}),e.jsx(s,{children:e.jsxs(M,{"aria-label":"Select Shipping Status",value:u[t._id]||t.status,onChange:r=>f(o=>({...o,[t._id]:r.target.value})),children:[e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"In Transit",children:"In Transit"}),e.jsx("option",{value:"Delivered",children:"Delivered"}),e.jsx("option",{value:"Cancelled",children:"Cancelled"})]})}),e.jsxs(s,{children:[e.jsx(d,{color:"warning",size:"sm",onClick:()=>C(t._id),disabled:S,children:"Update"}),e.jsx(d,{color:"danger",size:"sm",className:"ms-2",onClick:()=>g(t._id),disabled:w,children:"Delete"})]})]},t._id))})]})]})};export{re as default};
