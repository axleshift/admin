import{r as l,_ as T,R as E,E as G,G as P,P as u,u as R,$ as F,j as e,e as U,f as q,g as B,C as h,b as x,c as f,O as M}from"./index-Cskk6QuV.js";import{C as _,a as C}from"./index.esm-CbuOHHQi.js";import{C as j}from"./CRow-BtsQEa9i.js";import{C as c}from"./CCol-BpNSW51C.js";import{C as y}from"./CInputGroupText-BbkZsFpP.js";import{c as D}from"./ex-CELXs5B0.js";import{c as O}from"./cil-lock-locked-DmxpJbVL.js";var d=l.forwardRef(function(s,n){var i=s.children,o=s.className,r=T(s,["children","className"]);return E.createElement("div",G({className:P("card-group",o)},r,{ref:n}),i)});d.propTypes={children:u.node,className:u.string};d.displayName="CCardGroup";const W=()=>{const[s,n]=l.useState({identifier:"",password:""}),[i,o]=l.useState(null),r=R(),[S,{isLoading:m,error:A}]=F(),N=async t=>{var p;if(t.preventDefault(),!s.identifier||!s.password){o("Both fields are required.");return}try{const a=await S(s).unwrap();console.log("Login Success:",a),localStorage.setItem("accessToken",a.accessToken),localStorage.setItem("refreshToken",a.refreshToken);const{id:I,name:b,username:w,role:v,email:k,department:g,permissions:L}=a.user;switch(sessionStorage.setItem("userId",I),sessionStorage.setItem("username",w||""),sessionStorage.setItem("name",b||""),sessionStorage.setItem("email",k||""),sessionStorage.setItem("role",v||""),sessionStorage.setItem("department",g||""),sessionStorage.setItem("permissions",JSON.stringify(L||[])),console.log("Stored Permissions in sessionStorage:",sessionStorage.getItem("permissions")),g.toLowerCase()){case"administrative":r("/employeedash");break;case"hr":r("/hrdash");break;case"core":r("/coredash");break;case"finance":r("/financedash");break;case"logistics":r("/logisticdash");break;default:o("Invalid department or access rights.")}}catch(a){console.error("Login Failed:",a),o(((p=a.data)==null?void 0:p.message)||"An error occurred. Please try again.")}};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsx(_,{children:e.jsx(j,{className:"justify-content-center",children:e.jsx(c,{md:8,children:e.jsx(d,{children:e.jsx(U,{className:"p-4",children:e.jsx(q,{children:e.jsxs(B,{onSubmit:N,children:[e.jsx("h1",{children:"Login"}),e.jsx("p",{className:"text-body-secondary",children:"Sign In to your account"}),i&&e.jsx("p",{style:{color:"red"},children:i}),e.jsxs(h,{className:"mb-3",children:[e.jsx(y,{children:e.jsx(C,{icon:D})}),e.jsx(x,{type:"text",placeholder:"Email or Username",autoComplete:"email",value:s.identifier,onChange:t=>n({...s,identifier:t.target.value}),required:!0})]}),e.jsxs(h,{className:"mb-4",children:[e.jsx(y,{children:e.jsx(C,{icon:O})}),e.jsx(x,{type:"password",placeholder:"Password",autoComplete:"current-password",value:s.password,onChange:t=>n({...s,password:t.target.value}),required:!0})]}),e.jsxs(j,{children:[e.jsx(c,{xs:6,children:e.jsx(f,{type:"submit",color:"primary",className:"px-4",disabled:m,children:m?"Logging in...":"Login"})}),e.jsx(c,{xs:6,className:"text-right",children:e.jsx(M,{to:"/forgotpass",children:e.jsx(f,{color:"link",className:"px-0",children:"Forgot password?"})})})]})]})})})})})})})})};export{W as default};
