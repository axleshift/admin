import{j as e}from"./index-DnQYre1Z.js";import{r as l,R as J}from"./vendor-react-B6URQkMn.js";import{a as B}from"./axiosInstance-Dv2jt_v_.js";import{a8 as K,a9 as Q,aa as W,c as ee,ab as se,k as u,X as ae,o as c,j as x,l as C,C as D,N as re,O as N,Y as le,Z as ce,_ as E,$ as t,a0 as te,a1 as n,ac as ne,ad as ie,ae as w,s as oe,t as de,a3 as he,v as me,a2 as xe,w as je,y as h}from"./vendor-coreui-jwXAEa-8.js";import{c as pe,a as ue,b as Ce}from"./cil-people-DOcwnkEl.js";import{c as F}from"./cil-user-Ddrdy7PS.js";import"./vendor-redux-DipIbRRz.js";import"./index-t--hEgTQ.js";var ve=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M199.066,456l-7.379-7.514-3.94-3.9-86.2-86.2.053-.055L17.936,274.665l97.614-97.613,83.565,83.565L398.388,61.344,496,158.958,296.729,358.229,285.469,369.6ZM146.6,358.183l52.459,52.46.1-.1.054.054,52.311-52.311,11.259-11.368L450.746,158.958,398.388,106.6,199.115,305.871,115.55,222.306,63.191,274.665l83.464,83.463Z' class='ci-primary'/>"],ge=["512 512","<rect width='34.924' height='34.924' x='256' y='95.998' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M16,496H496V16H16ZM48,48H464V464H48Z' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M285.313,359.032a18.123,18.123,0,0,1-15.6,8.966,18.061,18.061,0,0,1-17.327-23.157l35.67-121.277A49.577,49.577,0,0,0,194.7,190.572l-11.718,28.234,29.557,12.266,11.718-28.235a17.577,17.577,0,0,1,33.1,11.7l-35.67,121.277A50.061,50.061,0,0,0,269.709,400a50.227,50.227,0,0,0,43.25-24.853l15.1-25.913-27.646-16.115Z' class='ci-primary'/>"],ye=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M344,16H168V168H16V344H168V496H344V344H496V168H344ZM464,200V312H312V464H200V312H48V200H200V48H312V200Z' class='ci-primary'/>"],fe=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M29.663,482.25l.087.087a24.847,24.847,0,0,0,17.612,7.342,25.178,25.178,0,0,0,8.1-1.345l142.006-48.172,272.5-272.5A88.832,88.832,0,0,0,344.334,42.039l-272.5,272.5L23.666,456.541A24.844,24.844,0,0,0,29.663,482.25Zm337.3-417.584a56.832,56.832,0,0,1,80.371,80.373L411.5,180.873,331.127,100.5ZM99.744,331.884,308.5,123.127,388.873,203.5,180.116,412.256,58.482,453.518Z' class='ci-primary'/>"],be=["512 512","<polygon fill='var(--ci-primary-color, currentColor)' points='427.314 107.313 404.686 84.687 256 233.373 107.314 84.687 84.686 107.313 233.373 256 84.686 404.687 107.314 427.313 256 278.627 404.686 427.313 427.314 404.687 278.627 256 427.314 107.313' class='ci-primary'/>"];const Ae=()=>{const[i,L]=l.useState([]),[v,R]=l.useState(!0),[d,g]=l.useState(1),[H,S]=l.useState(!1),[r,T]=l.useState(null),[o,M]=l.useState(""),[z,A]=l.useState(!1),[k,y]=l.useState(""),[I,q]=l.useState(null),j=5,$=J.useRef();l.useEffect(()=>{P()},[]);const P=async()=>{try{R(!0);const s=await B.get("/hr/leaveRequest");L(s.data.leaveRequests||[])}catch(s){console.error("Error fetching leave requests:",s),b("danger","Error","Failed to load leave requests")}finally{R(!1)}},V=d*j,O=V-j,U=i.slice(O,V),_=Math.ceil(i.length/j),X=s=>{switch(s.toLowerCase()){case"approved":return e.jsx(h,{color:"success",children:s});case"pending":return e.jsx(h,{color:"warning",children:s});case"rejected":return e.jsx(h,{color:"danger",children:s});default:return e.jsx(h,{color:"info",children:s})}},Y=s=>s.toLowerCase()==="paid"?e.jsx(h,{color:"success",children:s}):e.jsx(h,{color:"secondary",children:s}),p=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),Z=(s,a)=>{T(s),M(a),y(""),A(!0)},f=()=>{A(!1),T(null),M(""),y("")},b=(s,a,m)=>{q(e.jsxs(K,{autohide:!0,delay:5e3,children:[e.jsx(Q,{closeButton:!0,color:s,children:e.jsx("strong",{className:"me-auto",children:a})}),e.jsx(W,{children:m})]}))},G=async()=>{if(!(!r||!o))try{S(!0);const s=o==="approve"?"Approved":"Rejected";await B.put(`/hr/leaveRequest/${r.id}`,{status:s,comments:k}),L(a=>a.map(m=>m.id===r.id?{...m,status:s}:m)),f(),b("success","Success",`Leave request has been ${s.toLowerCase()} successfully`)}catch(s){console.error(`Error ${o}ing leave request:`,s),b("danger","Error",`Failed to ${o} leave request. Please try again.`)}finally{S(!1)}};return e.jsxs(ee,{className:"mt-4",children:[e.jsx(se,{ref:$,push:I,placement:"top-end"}),e.jsxs(u,{className:"shadow",children:[e.jsxs(ae,{className:"bg-primary text-white d-flex justify-content-between align-items-center",children:[e.jsxs("h4",{className:"mb-0",children:[e.jsx(c,{icon:pe,className:"me-2"}),"Leave Requests"]}),e.jsxs(x,{color:"light",size:"sm",onClick:()=>P(),disabled:v,children:[e.jsx(c,{icon:fe,className:"me-1"}),"Refresh"]})]}),e.jsx(C,{children:v?e.jsxs("div",{className:"text-center p-4",children:[e.jsx(D,{color:"primary"}),e.jsx("p",{className:"mt-2 text-muted",children:"Loading leave requests..."})]}):i.length===0?e.jsxs("div",{className:"text-center p-4",children:[e.jsx(c,{icon:ge,size:"xl",className:"mb-3 text-muted"}),e.jsx("p",{children:"No leave requests found"})]}):e.jsxs(e.Fragment,{children:[e.jsxs(re,{className:"mb-3",children:[e.jsx(N,{sm:12,md:4,className:"mb-2",children:e.jsx(u,{className:"text-white bg-info",children:e.jsxs(C,{className:"d-flex justify-content-between",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"mb-0",children:"Total Requests"}),e.jsx("h3",{className:"mb-0",children:i.length})]}),e.jsx(c,{icon:ue,size:"3xl"})]})})}),e.jsx(N,{sm:12,md:4,className:"mb-2",children:e.jsx(u,{className:"text-white bg-warning",children:e.jsxs(C,{className:"d-flex justify-content-between",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"mb-0",children:"Pending"}),e.jsx("h3",{className:"mb-0",children:i.filter(s=>s.status.toLowerCase()==="pending").length})]}),e.jsx(c,{icon:ye,size:"3xl"})]})})}),e.jsx(N,{sm:12,md:4,className:"mb-2",children:e.jsx(u,{className:"text-white bg-success",children:e.jsxs(C,{className:"d-flex justify-content-between",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"mb-0",children:"Approved"}),e.jsx("h3",{className:"mb-0",children:i.filter(s=>s.status.toLowerCase()==="approved").length})]}),e.jsx(c,{icon:Ce,size:"3xl"})]})})})]}),e.jsxs(le,{striped:!0,hover:!0,responsive:!0,className:"border",children:[e.jsx(ce,{className:"bg-light",children:e.jsxs(E,{children:[e.jsx(t,{children:"ID"}),e.jsxs(t,{children:[e.jsx(c,{icon:F,className:"me-1"}),"Employee"]}),e.jsx(t,{children:"Department"}),e.jsx(t,{children:"Leave Type"}),e.jsx(t,{children:"Duration"}),e.jsx(t,{children:"Days"}),e.jsx(t,{children:"Paid Status"}),e.jsx(t,{children:"Status"}),e.jsx(t,{children:"Actions"})]})}),e.jsx(te,{children:U.map(s=>e.jsxs(E,{children:[e.jsx(n,{children:s.id}),e.jsx(n,{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"bg-light rounded-circle p-2 me-2 text-primary",children:e.jsx(c,{icon:F})}),e.jsx("div",{children:e.jsx("div",{className:"fw-bold",children:s.name})})]})}),e.jsx(n,{children:s.department}),e.jsx(n,{children:s.leave_type}),e.jsxs(n,{children:[e.jsx("small",{className:"text-muted d-block",children:"From"}),p(s.start_date),e.jsx("small",{className:"text-muted d-block mt-1",children:"To"}),p(s.end_date)]}),e.jsxs(n,{children:[e.jsx("span",{className:"fw-bold",children:s.total_days})," ",s.total_days===1?"day":"days"]}),e.jsx(n,{children:Y(s.is_paid)}),e.jsx(n,{children:X(s.status)}),e.jsx(n,{children:s.status.toLowerCase()==="pending"&&e.jsxs("div",{className:"d-flex gap-1",children:[e.jsx(x,{color:"success",size:"sm",onClick:()=>Z(s,"approve"),children:e.jsx(c,{icon:ve})}),e.jsx(x,{color:"danger",size:"sm",onClick:()=>Z(s,"reject"),children:e.jsx(c,{icon:be})})]})})]},s.id))})]})]})}),!v&&i.length>j&&e.jsx(ne,{children:e.jsxs(ie,{align:"center","aria-label":"Page navigation",children:[e.jsx(w,{disabled:d===1,onClick:()=>g(d-1),children:"Previous"}),[...Array(_)].map((s,a)=>e.jsx(w,{active:d===a+1,onClick:()=>g(a+1),children:a+1},a+1)),e.jsx(w,{disabled:d===_,onClick:()=>g(d+1),children:"Next"})]})})]}),e.jsxs(oe,{visible:z,onClose:f,children:[e.jsx(de,{children:e.jsxs(he,{children:[o==="approve"?"Approve":"Reject"," Leave Request"]})}),e.jsx(me,{children:r&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Employee:"})," ",r.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Leave Type:"})," ",r.leave_type]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Duration:"})," ",p(r.start_date)," to ",p(r.end_date)," (",r.total_days," days)"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Reason:"})," ",r.reason||"Not provided"]}),e.jsx("hr",{}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"comments",className:"form-label",children:"Comments:"}),e.jsx(xe,{id:"comments",rows:3,placeholder:"Add your comments here (optional)",value:k,onChange:s=>y(s.target.value)})]})]})}),e.jsxs(je,{children:[e.jsx(x,{color:"secondary",onClick:f,children:"Cancel"}),e.jsxs(x,{color:o==="approve"?"success":"danger",onClick:G,disabled:H,children:[H&&e.jsx(D,{size:"sm",className:"me-2"}),o==="approve"?"Approve":"Reject"," Request"]})]})]})]})};export{Ae as default};
