import{j as e}from"./index-CE3ud9Cr.js";import{r as c}from"./vendor-react-B6URQkMn.js";import{a as C}from"./axiosInstance-CnxFScdD.js";import{u as v}from"./vendor-redux-DipIbRRz.js";import{F as a,I as B,J as b,K as I,L as H,j as O,M as z,N as P,O as _,P as G,Q as J,r as K}from"./DefaultLayout-B3_Yu0So.js";import{u as Q,c as k,k as T,a2 as $,l as E,j as g,X as V,C as W,Y as X,Z as Y,_ as p,$ as l,a0 as Z,a1 as n,y,ad as S,ae as q,N as ee,O as R}from"./vendor-coreui-C5DyMb8h.js";import"./index-D8rVyQy1.js";import"./Page500-DbqZ037B.js";import"./cil-magnifying-glass-COgjSVTM.js";import"./permissionConfig-pp7a5Fm6.js";const me=()=>{const[i,u]=c.useState([]),[f,o]=c.useState(null),[A,d]=c.useState(!0),[m,x]=c.useState(!1),D=v(t=>t.changeState.theme),{colorMode:F}=Q("coreui-free-react-admin-template-theme"),s=D==="dark"||F==="dark",N=()=>{d(!0),o(null),C.get("/general/log").then(t=>{u(t.data),d(!1)}).catch(t=>{o(t.message),d(!1)})},M=()=>{x(!0),C.get("/general/log").then(t=>{u(t.data),x(!1)}).catch(t=>{o(t.message),x(!1)})};c.useEffect(()=>{N()},[]);const L=s?{color:"#FFFFFF"}:{},w=t=>{const h={CREATE:"success",UPDATE:"primary",DELETE:"danger",RESTORE:"warning",SELECT:"info",FETCH:s?"light":"secondary",NAVIGATE:s?"light":"secondary",AUTO:s?"light":"dark",SET:"info"};for(const[j,r]of Object.entries(h))if(t&&t.includes(j))return r;return s?"light":"secondary"},U=t=>{const h=new Date,j=new Date(t),r=Math.floor((h-j)/1e3);return r<60?`${r} seconds ago`:r<3600?`${Math.floor(r/60)} minutes ago`:r<86400?`${Math.floor(r/3600)} hours ago`:`${Math.floor(r/86400)} days ago`};return f?e.jsx(k,{className:"mt-4",children:e.jsxs(T,{className:`text-center border-danger ${s?"bg-dark text-white":""}`,children:[e.jsxs($,{className:"bg-danger text-white",children:[e.jsx(a,{icon:B,className:"me-2"})," Error"]}),e.jsxs(E,{children:[e.jsx("p",{className:"mb-0",children:f}),e.jsxs(g,{color:"primary",className:"mt-3",onClick:N,children:[e.jsx(a,{icon:b,className:"me-2"})," Try Again"]})]})]})}):e.jsx(k,{fluid:!0,className:"p-4",children:e.jsxs(T,{className:`shadow-sm ${s?"bg-dark text-white":""}`,children:[e.jsxs($,{className:`d-flex justify-content-between align-items-center ${s?"bg-dark text-white border-secondary":"bg-light"}`,children:[e.jsxs("div",{children:[e.jsx(a,{icon:I,className:"me-2 text-primary"}),e.jsx(V,{className:"d-inline mb-0",style:L,children:"Activity Tracker"})]}),e.jsxs("div",{children:[e.jsxs(g,{color:"light",size:"sm",className:`me-2 ${s?"text-dark":""}`,onClick:M,disabled:m,children:[e.jsx(a,{icon:b,spin:m,className:"me-1"}),m?"Refreshing...":"Refresh"]}),e.jsxs(g,{color:s?"light":"secondary",size:"sm",className:s?"text-dark":"",children:[e.jsx(a,{icon:H,className:"me-1"}),"Export"]})]})]}),e.jsx(E,{children:A?e.jsxs("div",{className:"text-center p-5",children:[e.jsx(W,{color:"primary"}),e.jsx("p",{className:`mt-2 ${s?"text-light":"text-muted"}`,children:"Loading activity data..."})]}):e.jsx("div",{className:"table-responsive",children:e.jsxs(X,{hover:!0,striped:!0,responsive:!0,className:`border ${s?"table-dark":""}`,children:[e.jsx(Y,{className:s?"bg-dark text-white border-secondary":"bg-light",children:e.jsxs(p,{children:[e.jsxs(l,{className:"text-nowrap",children:[e.jsx(a,{icon:O,className:`me-2 ${s?"text-white":"text-muted"}`}),"User"]}),e.jsxs(l,{className:"text-nowrap",children:[e.jsx(a,{icon:z,className:`me-2 ${s?"text-white":"text-muted"}`}),"Role"]}),e.jsxs(l,{className:"text-nowrap",children:[e.jsx(a,{icon:P,className:`me-2 ${s?"text-white":"text-muted"}`}),"Department"]}),e.jsxs(l,{className:"text-nowrap",children:[e.jsx(a,{icon:_,className:`me-2 ${s?"text-white":"text-muted"}`}),"Route"]}),e.jsxs(l,{className:"text-nowrap",children:[e.jsx(a,{icon:G,className:`me-2 ${s?"text-white":"text-muted"}`}),"Action"]}),e.jsxs(l,{className:"text-nowrap",children:[e.jsx(a,{icon:J,className:`me-2 ${s?"text-white":"text-muted"}`}),"Description"]}),e.jsxs(l,{className:"text-nowrap",children:[e.jsx(a,{icon:K,className:`me-2 ${s?"text-white":"text-muted"}`}),"Time"]})]})}),e.jsx(Z,{children:i.length===0?e.jsx(p,{children:e.jsx(n,{colSpan:7,className:`text-center p-5 ${s?"text-white":"text-muted"}`,children:"No activity records found"})}):i.map(t=>e.jsxs(p,{className:"align-middle",children:[e.jsx(n,{className:"font-weight-bold",children:t.name||"Unknown"}),e.jsx(n,{children:e.jsx(y,{color:s?"light":"dark",shape:"rounded-pill",className:`px-2 py-1 ${s?"text-dark":""}`,children:t.role||"Unknown"})}),e.jsx(n,{children:t.department||"Unknown"}),e.jsx(n,{className:s?"text-info":"text-primary",children:t.route}),e.jsx(n,{children:e.jsx(y,{color:w(t.action),shape:"rounded-pill",className:w(t.action)==="light"?"text-dark":"",children:t.action})}),e.jsx(n,{children:e.jsx(S,{content:t.description,placement:"bottom",children:e.jsx("div",{className:"text-truncate",style:{maxWidth:"200px"},children:t.description})})}),e.jsx(n,{className:"text-nowrap",children:e.jsx(S,{content:new Date(t.timestamp).toLocaleString(),children:e.jsx("span",{children:U(t.timestamp)})})})]},t._id))})]})})}),e.jsx(q,{className:`${s?"bg-dark text-white border-secondary":"bg-light text-muted"}`,children:e.jsxs(ee,{children:[e.jsx(R,{children:e.jsxs("small",{children:["Showing ",i.length," activities"]})}),e.jsx(R,{className:"text-end",children:e.jsxs("small",{children:["Last updated: ",new Date().toLocaleString()]})})]})})]})})};export{me as default};
