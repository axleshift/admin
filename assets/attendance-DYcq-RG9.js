import{j as e}from"./index-DsFxS9jr.js";import{r as n}from"./vendor-react-BHxUanFt.js";import{a as A}from"./axiosInstance-Bq-uIJjs.js";import"./vendor-redux-CSji-Y9p.js";import"./vendor-coreui-CLDxaGvm.js";import"./index-xsH4HHeE.js";const W=()=>{const[r,p]=n.useState([]),[D,s]=n.useState(!0),[k,d]=n.useState(null),[x,E]=n.useState(""),[j,F]=n.useState(""),[f,S]=n.useState(""),[R,N]=n.useState(!1),[c,g]=n.useState(1),[b]=n.useState(10),[h,u]=n.useState(!1);n.useEffect(()=>{C()},[]);const C=async()=>{try{s(!0),N(!1),u(!1);const t=await A.get("/hr/attendance");p(t.data),s(!1)}catch(t){d("Failed to fetch attendance data"),s(!1),console.error("Error fetching attendance data:",t)}},P=async()=>{if(!f.trim()){d("Please enter a valid employee ID");return}try{s(!0),N(!0),u(!1);const t=await A.get(`/hr/attendance/employee/${f}`);p(t.data),s(!1)}catch(t){d("Failed to fetch employee attendance data"),s(!1),console.error("Error fetching employee attendance data:",t)}},O=async()=>{if(!x||!j){d("Please select both start and end dates");return}try{s(!0),N(!0),u(!1);const t=await A.get("/hr/attendance/daterange",{params:{startDate:x,endDate:j}});p(t.data),s(!1)}catch(t){d("Failed to fetch attendance data for selected dates"),s(!1),console.error("Error fetching attendance by date range:",t)}},L=()=>{s(!0),u(!0);const t=r.filter(a=>a.status==="Absent");p(t),g(1),s(!1)},$=()=>{E(""),F(""),S(""),d(null),u(!1),C()},M=t=>t?new Date(t).toLocaleDateString():"N/A",w=t=>t||"N/A",B=(t,a)=>{const l=[];if(a<=7)for(let i=1;i<=a;i++)l.push(i);else{l.push(1);let i=Math.max(2,t-1),m=Math.min(a-1,t+1);i>2&&l.push("ellipsis-start");for(let o=i;o<=m;o++)l.push(o);m<a-1&&l.push("ellipsis-end"),l.push(a)}return l},y=c*b,I=y-b,T=r.slice(I,y),v=Math.ceil(r.length/b),U=t=>g(t),q=()=>{c<v&&g(c+1)},z=()=>{c>1&&g(c-1)};return e.jsxs("div",{className:"attendance-dashboard",children:[e.jsxs("header",{className:"dashboard-header",children:[e.jsx("h1",{children:"Attendance Dashboard"}),e.jsx("div",{className:"action-buttons",children:e.jsx("button",{className:`absence-button ${h?"active":""}`,onClick:L,disabled:D||r.length===0,children:"Show Absences Only"})})]}),e.jsxs("div",{className:"filter-section",children:[e.jsxs("div",{className:"date-filter",children:[e.jsx("h3",{children:"Filter by Date Range"}),e.jsxs("div",{className:"date-inputs",children:[e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"start-date",children:"Start Date:"}),e.jsx("input",{type:"date",id:"start-date",value:x,onChange:t=>E(t.target.value)})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"end-date",children:"End Date:"}),e.jsx("input",{type:"date",id:"end-date",value:j,onChange:t=>F(t.target.value)})]}),e.jsx("button",{className:"filter-button",onClick:O,disabled:!x||!j,children:"Apply Date Filter"})]})]}),e.jsxs("div",{className:"employee-filter",children:[e.jsx("h3",{children:"Filter by Employee"}),e.jsxs("div",{className:"employee-inputs",children:[e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"employee-id",children:"Employee ID:"}),e.jsx("input",{type:"text",id:"employee-id",value:f,onChange:t=>S(t.target.value),placeholder:"Enter employee ID"})]}),e.jsx("button",{className:"filter-button",onClick:P,disabled:!f.trim(),children:"Find Employee"})]})]}),(R||h)&&e.jsx("button",{className:"reset-button",onClick:$,children:"Reset Filters"})]}),k&&e.jsx("div",{className:"error-message",children:k}),e.jsxs("div",{className:"attendance-data",children:[e.jsxs("h2",{children:[h?"Absence Records":"Attendance Records",h&&e.jsxs("span",{className:"record-count",children:[" (",r.length,")"]})]}),D?e.jsx("div",{className:"loading",children:"Loading attendance data..."}):r.length===0?e.jsx("div",{className:"no-data",children:h?"No absence records found":"No attendance records found"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"attendance-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Employee Name"}),e.jsx("th",{children:"Employee ID"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Check In"}),e.jsx("th",{children:"Check Out"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Department"})]})}),e.jsx("tbody",{children:T.map((t,a)=>{var l,i,m,o;return e.jsxs("tr",{className:t.status==="Absent"?"absent-row":"",children:[e.jsx("td",{children:((l=t.employee)==null?void 0:l.name)||"N/A"}),e.jsx("td",{children:((i=t.employee)==null?void 0:i.id)||t.employeeId||"N/A"}),e.jsx("td",{children:M(t.date)}),e.jsx("td",{className:t.checkIn?"check-in":"no-check",children:w(t.checkIn)}),e.jsx("td",{className:t.checkOut?"check-out":"no-check",children:w(t.checkOut)}),e.jsx("td",{className:`status-${((m=t.status)==null?void 0:m.toLowerCase())||"unknown"}`,children:t.status||"Unknown"}),e.jsx("td",{children:((o=t.employee)==null?void 0:o.department)||"N/A"})]},a)})})]})}),e.jsxs("div",{className:"pagination-container",children:[e.jsxs("div",{className:"pagination-info",children:["Showing ",I+1," to ",Math.min(y,r.length)," of ",r.length," records"]}),e.jsxs("div",{className:"pagination-controls",children:[e.jsx("button",{className:"pagination-button",onClick:z,disabled:c===1,children:"Previous"}),e.jsx("div",{className:"pagination-pages",children:B(c,v).map((t,a)=>t==="ellipsis-start"||t==="ellipsis-end"?e.jsx("span",{className:"pagination-ellipsis",children:"â€¦"},`ellipsis-${a}`):e.jsx("button",{onClick:()=>U(t),className:`pagination-number ${c===t?"active":""}`,children:t},t))}),e.jsx("button",{className:"pagination-button",onClick:q,disabled:c===v,children:"Next"})]})]})]})]})]})};export{W as default};
