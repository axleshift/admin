import{j as s}from"./index-DV-wgTl8.js";import{i as b,r}from"./vendor-react-B6URQkMn.js";import{S as y}from"./statbox-lF7W2CKx.js";import{C as z}from"./customhead-Dsx3FIZz.js";import I from"./monthly-B4zb7Xn_.js";import{F as C,I as B,O as W}from"./index-DgWFfLP0.js";import{a as Y}from"./axiosInstance-Bq-uIJjs.js";import{c as O,N as m,O as l,k as U}from"./vendor-coreui-DDUzhqJ9.js";import"./vendor-redux-C7peqcPR.js";import"./activityLogger-D6Lc4RsL.js";import"./index-xsH4HHeE.js";const M=()=>{var g,u;b();const[k,v]=r.useState(window.innerWidth>768),[e,h]=r.useState(null),[t,L]=r.useState(null),[H,f]=r.useState(!0),[x,$]=r.useState(null);r.useEffect(()=>{const a=()=>v(window.innerWidth>768);return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]),r.useEffect(()=>{(async()=>{try{f(!0);const n=await Y.get("/finance/monthlysalesrevenue");if(n.data&&Array.isArray(n.data)&&n.data.length>0){const c=new Date,N=c.toLocaleString("en-US",{month:"long"}),R=c.getFullYear(),S=n.data.find(o=>o.month===N&&o.year===R),d=new Date(c);d.setMonth(d.getMonth()-1);const F=d.toLocaleString("en-US",{month:"long"}),A=d.getFullYear(),j=n.data.find(o=>o.month===F&&o.year===A);if(S)h(S);else{const o=[...n.data].sort((w,p)=>{const E=new Date(`${w.month} 1, ${w.year}`);return new Date(`${p.month} 1, ${p.year}`)-E});h(o[0]),console.log("Current month data not found, using most recent:",o[0])}j&&L(j)}f(!1)}catch(n){console.error("Failed to fetch dashboard data:",n),$(n.message||"An error occurred while fetching data"),f(!1)}})()},[]);const i=(a,n)=>!n||n===0?"0":((a-n)/n*100).toFixed(1);return s.jsxs(O,{fluid:!0,className:"p-3",children:[s.jsx(m,{children:s.jsx(l,{children:s.jsx(z,{title:"Finance Dashboard",subtitle:"Welcome to the Finance Dashboard"})})}),s.jsxs(m,{children:[s.jsx(l,{xs:12,md:6,lg:3,children:s.jsx(y,{title:`Current Sales (${(e==null?void 0:e.month)||"Loading..."})`,value:((g=e==null?void 0:e.totalSales)==null?void 0:g.toLocaleString())||0,increase:t?`${i((e==null?void 0:e.totalSales)||0,(t==null?void 0:t.totalSales)||0)>0?"+":""}${i((e==null?void 0:e.totalSales)||0,(t==null?void 0:t.totalSales)||0)}%`:"0",description:"vs. last month",icon:s.jsx(C,{icon:B,style:{fontSize:"20px",color:"#0d6efd"}})})}),s.jsx(l,{xs:12,md:6,lg:3,children:s.jsx(y,{title:`Current Revenue (${(e==null?void 0:e.month)||"Loading..."})`,value:`$${((u=e==null?void 0:e.totalRevenue)==null?void 0:u.toLocaleString())||0}`,increase:t?`${i((e==null?void 0:e.totalRevenue)||0,(t==null?void 0:t.totalRevenue)||0)>0?"+":""}${i((e==null?void 0:e.totalRevenue)||0,(t==null?void 0:t.totalRevenue)||0)}%`:"0",description:"vs. last month",icon:s.jsx(C,{icon:W,style:{fontSize:"20px",color:"#198754"}})})})]}),s.jsx(m,{className:"my-3",children:s.jsx(l,{xs:12,children:s.jsx(U,{className:"mb-4",children:s.jsx("div",{className:"p-3",children:s.jsx(I,{view:"sales",onDataLoaded:a=>{a&&Array.isArray(a)&&a.length>0}})})})})}),x&&s.jsx(m,{className:"my-3",children:s.jsx(l,{xs:12,children:s.jsx("div",{className:"alert alert-danger",children:x})})})]})};export{M as default};
