import{j as e}from"./index-Bb-Hm6Ev.js";import{r as c}from"./vendor-react-BHxUanFt.js";import{F as m,m as k,i as U,n as A,o as b,p as D,a as q,q as w,h as L,r as B,s as H,t as M}from"./index-a-IrBYvB.js";import{a as P}from"./axiosInstance-Bq-uIJjs.js";import{C as R,a as d,b as n,d as O,n as W,e as z,g as G,f as J,s as t,k as x,t as j,u as K,v as Q,l as V,m as X}from"./vendor-coreui-T9QyU9K3.js";import"./vendor-redux-CSji-Y9p.js";import"./index-xsH4HHeE.js";function oe(){const[l,h]=c.useState({employeeId:"",employeeName:"",department:"",employeeEmail:"",employeeUsername:"",complaintType:"",complaintText:"",urgency:"Medium",isAnonymous:!1});c.useEffect(()=>{console.log("Loading from localStorage:"),console.log("userId:",localStorage.getItem("userId")),console.log("name:",localStorage.getItem("name")),console.log("department:",localStorage.getItem("department")),console.log("email:",localStorage.getItem("email")),console.log("username:",localStorage.getItem("username")),h(a=>({...a,employeeId:localStorage.getItem("userId")||"",employeeName:localStorage.getItem("name")||"",department:localStorage.getItem("department")||"",employeeEmail:localStorage.getItem("email")||"",employeeUsername:localStorage.getItem("username")||""}))},[]);const[s,f]=c.useState({}),[C,v]=c.useState(!1),[p,g]=c.useState(null),[Y,Z]=c.useState(null),N=["HR","Finance","Core","Logistics","Administrative"],I=["Workplace Harassment","Pay Issues","Working Conditions","Management Issues","Other"],E=["Low","Medium","High","Critical"],o=a=>{const{name:r,value:u,type:y,checked:i}=a.target;h({...l,[r]:y==="checkbox"?i:u}),s[r]&&f({...s,[r]:null})},S=()=>{const a={};return l.employeeId.trim()||(a.employeeId="Employee ID is required"),l.employeeName.trim()||(a.employeeName="Employee name is required"),l.department||(a.department="Department is required"),l.employeeEmail.trim()||(a.employeeEmail="Employee email is required"),l.employeeUsername.trim()||(a.employeeUsername="Employee username is required"),l.complaintType||(a.complaintType="Complaint type is required"),l.complaintText.trim()||(a.complaintText="Complaint details are required"),a},T=async a=>{var u,y;a.preventDefault();const r=S();if(Object.keys(r).length>0){f(r);return}console.log("Submitting form data:",l),v(!0),g(null);try{const i=await P.post("/complains/employeecomplain",l);console.log("Server response:",i.data),g({success:!0,message:i.data.message||"Complaint submitted successfully"}),h(F=>({...F,complaintType:"",complaintText:"",urgency:"Medium",isAnonymous:!1}))}catch(i){console.error("Error submitting complaint:",i),g({success:!1,message:((y=(u=i.response)==null?void 0:u.data)==null?void 0:y.message)||"Failed to submit complaint. Please try again."})}finally{v(!1)}};return e.jsx(R,{className:"py-4",children:e.jsx(d,{className:"justify-content-center",children:e.jsx(n,{md:10,children:e.jsxs(O,{children:[e.jsxs(W,{className:"text-center bg-light",children:[e.jsxs("h4",{children:[e.jsx(m,{icon:k,className:"me-2"}),"Employee Complaint Form"]}),e.jsx("small",{className:"text-muted",children:"Please provide the details of your complaint below"})]}),e.jsxs(z,{children:[p&&e.jsxs(G,{color:p.success?"success":"danger",children:[e.jsx(m,{icon:p.success?U:A,className:"me-2"}),p.message]}),e.jsxs(J,{onSubmit:T,children:[e.jsxs(d,{className:"mb-3",children:[e.jsxs(n,{md:6,children:[e.jsxs(t,{htmlFor:"employeeUsername",children:[e.jsx(m,{icon:b,className:"me-1"})," Employee Username *"]}),e.jsx(x,{id:"employeeUsername",name:"employeeUsername",value:l.employeeUsername,onChange:o,invalid:!!s.employeeUsername}),s.employeeUsername&&e.jsx("div",{className:"invalid-feedback d-block",children:s.employeeUsername})]}),e.jsxs(n,{md:6,children:[e.jsxs(t,{htmlFor:"employeeName",children:[e.jsx(m,{icon:D,className:"me-1"})," Employee Name *"]}),e.jsx(x,{id:"employeeName",name:"employeeName",value:l.employeeName,onChange:o,invalid:!!s.employeeName}),s.employeeName&&e.jsx("div",{className:"invalid-feedback d-block",children:s.employeeName})]})]}),e.jsxs(d,{className:"mb-3",children:[e.jsxs(n,{md:6,children:[e.jsxs(t,{htmlFor:"employeeEmail",children:[e.jsx(m,{icon:q,className:"me-1"})," Employee Email *"]}),e.jsx(x,{id:"employeeEmail",name:"employeeEmail",type:"email",value:l.employeeEmail,onChange:o,invalid:!!s.employeeEmail}),s.employeeEmail&&e.jsx("div",{className:"invalid-feedback d-block",children:s.employeeEmail})]}),e.jsxs(n,{md:6,children:[e.jsxs(t,{htmlFor:"employeeId",children:[e.jsx(m,{icon:b,className:"me-1"})," Employee ID *"]}),e.jsx(x,{id:"employeeId",name:"employeeId",value:l.employeeId,onChange:o,invalid:!!s.employeeId}),s.employeeId&&e.jsx("div",{className:"invalid-feedback d-block",children:s.employeeId})]})]}),e.jsxs(d,{className:"mb-3",children:[e.jsxs(n,{md:6,children:[e.jsxs(t,{htmlFor:"department",children:[e.jsx(m,{icon:w,className:"me-1"})," Department *"]}),e.jsxs(j,{id:"department",name:"department",value:l.department,onChange:o,invalid:!!s.department,children:[e.jsx("option",{value:"",children:"Select Department"}),N.map(a=>e.jsx("option",{value:a,children:a},a))]}),s.department&&e.jsx("div",{className:"invalid-feedback d-block",children:s.department})]}),e.jsxs(n,{md:6,children:[e.jsxs(t,{htmlFor:"complaintType",children:[e.jsx(m,{icon:L,className:"me-1"})," Complaint Type *"]}),e.jsxs(j,{id:"complaintType",name:"complaintType",value:l.complaintType,onChange:o,invalid:!!s.complaintType,children:[e.jsx("option",{value:"",children:"Select Complaint Type"}),I.map(a=>e.jsx("option",{value:a,children:a},a))]}),s.complaintType&&e.jsx("div",{className:"invalid-feedback d-block",children:s.complaintType})]})]}),e.jsxs(d,{className:"mb-3",children:[e.jsxs(n,{md:6,children:[e.jsxs(t,{htmlFor:"urgency",children:[e.jsx(m,{icon:B,className:"me-1"})," Urgency Level"]}),e.jsx(j,{id:"urgency",name:"urgency",value:l.urgency,onChange:o,children:E.map(a=>e.jsx("option",{value:a,children:a},a))})]}),e.jsx(n,{md:6,className:"d-flex align-items-end",children:e.jsx(K,{id:"isAnonymous",name:"isAnonymous",label:e.jsxs(e.Fragment,{children:["Submit Anonymously ",e.jsx(m,{icon:H,className:"ms-1 text-muted"})]}),checked:l.isAnonymous,onChange:o})})]}),e.jsxs(t,{htmlFor:"complaintText",children:[e.jsx(m,{icon:M,className:"me-1"})," Complaint Details *"]}),e.jsx(Q,{id:"complaintText",name:"complaintText",rows:5,value:l.complaintText,onChange:o,invalid:!!s.complaintText,placeholder:"Please provide detailed information about your complaint..."}),s.complaintText&&e.jsx("div",{className:"invalid-feedback d-block",children:s.complaintText}),e.jsx("div",{className:"text-center mt-4",children:e.jsxs(V,{type:"submit",color:"primary",disabled:C,children:[C?e.jsx(X,{size:"sm",className:"me-2"}):null,"Submit Complaint"]})})]})]})]})})})})}export{oe as default};
