import{e as T,f as H,r as u,j as e}from"./index-BizKBI6a.js";import{F as m,f as A,a as B,b as L,c as k}from"./DefaultLayout-CnpPbvhY.js";import{a as z,b as G}from"./index.esm-LX8wyrY9.js";import{C as M,a as Q}from"./CCardBody-cs6hLwSm.js";import{C as V}from"./CCardHeader-CPTDb0Yp.js";import{C as _,a as q,b as v,c as n,d as J,e as l}from"./CTable-D-tPmOjy.js";import{C as K,a as g}from"./CFormInput-BYAzJEzi.js";import{C as w}from"./CFormSelect-BBQbi0Yz.js";import"./chatbox-V5kNCwUM.js";import"./cil-magnifying-glass-COgjSVTM.js";import"./CCloseButton-CGgGdGd-.js";import"./index-D8rVyQy1.js";const le=()=>{const{data:h,isLoading:O,isError:W,refetch:N}=T(),[S]=H(),b=["Administrative","Finance","HR","Core","Logistics"],[o,d]=u.useState({}),[c,y]=u.useState({}),R=s=>s==="Finance"?["user","admin","staff","superadmin","technician"]:["admin","manager","superadmin"],U=(s,a)=>{d({...o,[s]:{...o[s],password:a}})},F=s=>{y({...c,[s]:!c[s]})},D=(s,a)=>{d({...o,[s]:{...o[s],department:a,role:""}})},E=(s,a)=>{d({...o,[s]:{...o[s],role:a}})},P=async s=>{const a=o[s.id]||{},i={id:s.id,firstName:s.firstName,lastName:s.lastName,email:s.email,password:a.password||"",role:a.role||"",department:a.department||""};try{const t=await S(i).unwrap();console.log("User saved successfully:",t),N()}catch(t){console.error("Error saving user:",t),t.data&&t.data.error&&console.error("Validation error:",t.data.error)}};return e.jsx(z,{children:e.jsx(G,{md:12,children:e.jsxs(M,{children:[e.jsx(V,{children:e.jsxs("h4",{children:[e.jsx(m,{icon:A,className:"me-2"}),"New Users"]})}),e.jsx(Q,{children:e.jsxs(_,{hover:!0,responsive:!0,className:"align-middle",children:[e.jsx(q,{color:"light",children:e.jsxs(v,{children:[e.jsx(n,{children:"First Name"}),e.jsx(n,{children:"Last Name"}),e.jsx(n,{children:"Email"}),e.jsx(n,{children:"Password"}),e.jsx(n,{children:"Department"}),e.jsx(n,{children:"Role"}),e.jsx(n,{children:"Actions"})]})}),e.jsx(J,{children:h&&h.map(s=>{var p,x,j,C,f;const a=s.id||s._id||s.email,i=((p=o[a])==null?void 0:p.department)||"",t=R(i);return e.jsxs(v,{children:[e.jsx(l,{children:s.firstName}),e.jsx(l,{children:s.lastName}),e.jsx(l,{children:s.email}),e.jsx(l,{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(K,{type:c[a]?"text":"password",placeholder:"Set password",value:((x=o[a])==null?void 0:x.password)||"",onChange:r=>U(a,r.target.value)}),e.jsx(g,{variant:"ghost",onClick:()=>F(a),className:"ms-2",children:e.jsx(m,{icon:c[a]?B:L})})]})}),e.jsx(l,{children:e.jsxs(w,{value:i,onChange:r=>D(a,r.target.value),children:[e.jsx("option",{value:"",children:"Select Department"}),b.map(r=>e.jsx("option",{value:r,children:r},r))]})}),e.jsx(l,{children:e.jsxs(w,{value:((j=o[a])==null?void 0:j.role)||"",onChange:r=>E(a,r.target.value),disabled:!i,children:[e.jsx("option",{value:"",children:"Select Role"}),t.map(r=>e.jsx("option",{value:r,children:r},r))]})}),e.jsx(l,{children:e.jsxs(g,{color:"primary",size:"sm",onClick:()=>P(s),disabled:!i||!((C=o[a])!=null&&C.role)||!((f=o[a])!=null&&f.password),children:[e.jsx(m,{icon:k,className:"me-2"}),"Save"]})})]},a)})})]})})]})})})};export{le as default};
