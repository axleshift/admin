import{j as e}from"./index-DsFxS9jr.js";import{r as n}from"./vendor-react-BHxUanFt.js";import{F as r,R as y,n as g,i as b,T as P,ay as M,az as k,au as B,j as z,av as D}from"./index-ByAwoHiW.js";import{a as v}from"./axiosInstance-Bq-uIJjs.js";import{C as U,a as L,b as q,o as Q,g as H,l as c,m as F,d as W,n as X,p as I,e as G,Q as J,R as K,S as O,T as V,v as Y,X as Z}from"./vendor-coreui-CLDxaGvm.js";import"./vendor-redux-CSji-Y9p.js";import"./index-xsH4HHeE.js";const te=()=>{const[f,j]=n.useState([]),[d,C]=n.useState(!1),[m,o]=n.useState(null),[a,u]=n.useState(null),[T,h]=n.useState(!1),[w,x]=n.useState(""),[t,l]=n.useState(null);n.useEffect(()=>{N()},[]);const N=async()=>{try{C(!0),o(null);const s=await v.get("/complains/hr-complains");j(s.data.complaints||[])}catch(s){console.error("Error fetching HR complaints:",s),o({type:"danger",message:"Failed to load complaints. Please try again."})}finally{C(!1),l(null)}},S=s=>{switch(s){case"Resolved":return"success";case"Processing":case"Under Review":return"warning";case"Dismissed":return"danger";case"HR Review":return"info";case"Pending":default:return"secondary"}},A=s=>{switch(s){case"Resolved":return b;case"Processing":case"Under Review":return D;case"Dismissed":return z;case"HR Review":return y;case"Pending":default:return g}},_=async()=>{if(a)try{l(a._id),o(null);const s=await v.post("/complains/forward-to-ai",{complaintId:a._id,hrNotes:w});j(i=>i.filter(p=>p._id!==a._id)),h(!1),x(""),u(null),o({type:"success",message:"Complaint successfully forwarded to AI resolution system"})}catch(s){console.error("Error forwarding complaint:",s),o({type:"danger",message:"Failed to forward complaint. Please try again."})}finally{l(null)}},E=async s=>{try{l(s._id),o(null);const i={...s,status:"Resolved",resolutionText:"This complaint has been reviewed and resolved by HR. Appropriate action has been taken."};j(p=>p.map(R=>R._id===s._id?i:R))}catch(i){console.error("Error resolving with HR:",i),o({type:"danger",message:"Failed to resolve complaint. Please try again."})}finally{l(null)}};return e.jsxs(U,{className:"py-4",children:[e.jsx(L,{children:e.jsxs(q,{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsxs("h1",{children:[e.jsx(r,{icon:y,className:"me-2"}),"HR Complaints Management"]}),e.jsx(Q,{content:"This system shows standard complaints that can be handled by HR. Complex cases can be forwarded to the AI system.",placement:"bottom",children:e.jsx(r,{icon:g,className:"ms-2 text-info",style:{cursor:"pointer"}})})]}),m&&e.jsxs(H,{color:m.type||"danger",className:"mb-4",children:[e.jsx(r,{icon:m.type==="success"?b:g,className:"me-2"}),m.message]}),e.jsxs(c,{color:"primary",onClick:N,disabled:d,className:"mb-4",children:[e.jsx(r,{icon:P,className:"me-2",spin:d}),d?"Loading...":"Refresh Complaints"]}),d?e.jsxs("div",{className:"text-center py-5",children:[e.jsx(F,{}),e.jsx("p",{className:"mt-3",children:"Loading HR complaints..."})]}):e.jsx(e.Fragment,{children:f.length===0?e.jsxs(H,{color:"info",children:[e.jsx(r,{icon:g,className:"me-2"}),"No complaints found that require HR handling."]}):f.map(s=>e.jsxs(W,{className:"mb-4",children:[e.jsxs(X,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("strong",{children:s.source==="Employee Complaint"?s.isAnonymous?"Anonymous":s.employeeName:s.userId}),s.source==="Employee Complaint"&&e.jsxs("span",{className:"ms-3 text-muted",children:["ID: ",s.isAnonymous?"Hidden":s.employeeId]})]}),e.jsxs(I,{color:S(s.status),children:[e.jsx(r,{icon:A(s.status),className:"me-1"}),s.status]})]}),e.jsxs(G,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs("small",{className:"text-muted d-block mb-2",children:["Source: ",s.source,s.source==="Employee Complaint"&&e.jsxs(e.Fragment,{children:[" • ","Department: ",s.department," • ","Type: ",s.complaintType," • ","Urgency: ",e.jsx(I,{color:s.urgency==="Critical"?"danger":s.urgency==="High"?"warning":s.urgency==="Medium"?"info":"secondary",shape:"rounded-pill",children:s.urgency})]})]}),e.jsx("p",{className:"mb-0",children:s.complaintText})]}),s.resolutionText&&e.jsxs("div",{className:"mt-3 p-3 bg-light rounded",children:[e.jsx("h6",{children:"Resolution:"}),e.jsx("p",{className:"mb-0",children:s.resolutionText})]}),(s.status==="HR Review"||s.status==="Pending")&&e.jsxs("div",{className:"mt-3",children:[e.jsxs(c,{color:"primary",size:"sm",onClick:()=>E(s),className:"me-2",disabled:t===s._id,children:[e.jsx(r,{icon:y,className:"me-2"}),t===s._id?"Processing...":"Resolve with HR"]}),e.jsxs(c,{color:"warning",size:"sm",onClick:()=>{u(s),h(!0)},disabled:t===s._id,children:[e.jsx(r,{icon:M,className:"me-2"}),"Forward to AI"]})]})]})]},s._id))})]})}),e.jsxs(J,{visible:T,onClose:()=>{h(!1),x(""),u(null)},children:[e.jsx(K,{closeButton:!0,children:e.jsx(O,{children:"Forward Complaint to AI Resolution System"})}),e.jsxs(V,{children:[e.jsx("p",{children:"This complaint will be forwarded to the AI resolution system for specialized handling. Please provide any notes or context that might help with the resolution."}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"hrNotes",className:"form-label",children:[e.jsx(r,{icon:k,className:"me-1"})," HR Notes"]}),e.jsx(Y,{id:"hrNotes",rows:"4",value:w,onChange:s=>x(s.target.value),placeholder:"Explain why this complaint needs AI handling..."})]})]}),e.jsxs(Z,{children:[e.jsx(c,{color:"secondary",onClick:()=>{h(!1),x(""),u(null)},children:"Cancel"}),e.jsx(c,{color:"primary",onClick:_,disabled:t===(a==null?void 0:a._id),children:t===(a==null?void 0:a._id)?e.jsxs(e.Fragment,{children:[e.jsx(F,{size:"sm",className:"me-2"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(r,{icon:B,className:"me-2"}),"Forward to AI"]})})]})]})]})};export{te as default};
