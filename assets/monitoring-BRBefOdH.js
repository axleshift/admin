import{y as le,z as oe,j as e}from"./index-30lfaIj6.js";import{R as j,r as g}from"./vendor-react-BHxUanFt.js";import{l as w}from"./activityLogger-D6Lc4RsL.js";import{a as A,b as m,X as de,Y as D,Z as R,d as V,n as H,e as $,k as F,t as L,m as k,w as G,x as Q,y as v,z as l,A as W,B as a,p as z}from"./vendor-coreui-T9QyU9K3.js";import"./vendor-redux-CSji-Y9p.js";import"./axiosInstance-Bq-uIJjs.js";import"./index-xsH4HHeE.js";var te={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Z=j.createContext&&j.createContext(te),ue=["attr","size","title"];function he(r,n){if(r==null)return{};var s=me(r,n),c,i;if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(r);for(i=0;i<x.length;i++)c=x[i],!(n.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(r,c)&&(s[c]=r[c])}return s}function me(r,n){if(r==null)return{};var s={};for(var c in r)if(Object.prototype.hasOwnProperty.call(r,c)){if(n.indexOf(c)>=0)continue;s[c]=r[c]}return s}function b(){return b=Object.assign?Object.assign.bind():function(r){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var c in s)Object.prototype.hasOwnProperty.call(s,c)&&(r[c]=s[c])}return r},b.apply(this,arguments)}function K(r,n){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);n&&(c=c.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),s.push.apply(s,c)}return s}function S(r){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?K(Object(s),!0).forEach(function(c){je(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):K(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}function je(r,n,s){return n=xe(n),n in r?Object.defineProperty(r,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[n]=s,r}function xe(r){var n=pe(r,"string");return typeof n=="symbol"?n:n+""}function pe(r,n){if(typeof r!="object"||!r)return r;var s=r[Symbol.toPrimitive];if(s!==void 0){var c=s.call(r,n);if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(r)}function re(r){return r&&r.map((n,s)=>j.createElement(n.tag,S({key:s},n.attr),re(n.child)))}function h(r){return n=>j.createElement(ge,b({attr:S({},r.attr)},n),re(r.child))}function ge(r){var n=s=>{var{attr:c,size:i,title:x}=r,o=he(r,ue),y=i||s.size||"1em",p;return s.className&&(p=s.className),r.className&&(p=(p?p+" ":"")+r.className),j.createElement("svg",b({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},s.attr,c,o,{className:p,style:S(S({color:r.color||s.color},s.style),r.style),height:y,width:y,xmlns:"http://www.w3.org/2000/svg"}),x&&j.createElement("title",null,x),r.children)};return Z!==void 0?j.createElement(Z.Consumer,null,s=>n(s)):n(te)}function ve(r){return h({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M436 480h-20V24c0-13.255-10.745-24-24-24H56C42.745 0 32 10.745 32 24v456H12c-6.627 0-12 5.373-12 12v20h448v-20c0-6.627-5.373-12-12-12zM128 76c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12V76zm0 96c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40zm52 148h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12zm76 160h-64v-84c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v84zm64-172c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40zm0-96c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40zm0-96c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12V76c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40z"},child:[]}]})(r)}function fe(r){return h({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"},child:[]}]})(r)}function q(r){return h({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"},child:[]}]})(r)}function J(r){return h({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},child:[]}]})(r)}function X(r){return h({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.976 0H24.028C2.71 0-8.047 25.866 7.058 40.971L192 225.941V432c0 7.831 3.821 15.17 10.237 19.662l80 55.98C298.02 518.69 320 507.493 320 487.98V225.941l184.947-184.97C520.021 25.896 509.338 0 487.976 0z"},child:[]}]})(r)}function Y(r){return h({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M512 176.001C512 273.203 433.202 352 336 352c-11.22 0-22.19-1.062-32.827-3.069l-24.012 27.014A23.999 23.999 0 0 1 261.223 384H224v40c0 13.255-10.745 24-24 24h-40v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24v-78.059c0-6.365 2.529-12.47 7.029-16.971l161.802-161.802C163.108 213.814 160 195.271 160 176 160 78.798 238.797.001 335.999 0 433.488-.001 512 78.511 512 176.001zM336 128c0 26.51 21.49 48 48 48s48-21.49 48-48-21.49-48-48-48-48 21.49-48 48z"},child:[]}]})(r)}function ye(r){return h({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M202.021 0C122.202 0 70.503 32.703 29.914 91.026c-7.363 10.58-5.093 25.086 5.178 32.874l43.138 32.709c10.373 7.865 25.132 6.026 33.253-4.148 25.049-31.381 43.63-49.449 82.757-49.449 30.764 0 68.816 19.799 68.816 49.631 0 22.552-18.617 34.134-48.993 51.164-35.423 19.86-82.299 44.576-82.299 106.405V320c0 13.255 10.745 24 24 24h72.471c13.255 0 24-10.745 24-24v-5.773c0-42.86 125.268-44.645 125.268-160.627C377.504 66.256 286.902 0 202.021 0zM192 373.459c-38.196 0-69.271 31.075-69.271 69.271 0 38.195 31.075 69.27 69.271 69.27s69.271-31.075 69.271-69.271-31.075-69.27-69.271-69.27z"},child:[]}]})(r)}function Ce(r){return h({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 160H48c-26.51 0-48 21.49-48 48v224c0 26.51 21.49 48 48 48h16v16c0 8.84 7.16 16 16 16h32c8.84 0 16-7.16 16-16v-16h128v16c0 8.84 7.16 16 16 16h32c8.84 0 16-7.16 16-16v-16h16c26.51 0 48-21.49 48-48V208c0-26.51-21.49-48-48-48zm-16 216c0 4.42-3.58 8-8 8H72c-4.42 0-8-3.58-8-8v-16c0-4.42 3.58-8 8-8h240c4.42 0 8 3.58 8 8v16zm0-96c0 4.42-3.58 8-8 8H72c-4.42 0-8-3.58-8-8v-16c0-4.42 3.58-8 8-8h240c4.42 0 8 3.58 8 8v16zM144 48h96v80h48V48c0-26.51-21.49-48-48-48h-96c-26.51 0-48 21.49-48 48v80h48V48z"},child:[]}]})(r)}function be(r){return h({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(r)}function ee(r){return h({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M622.3 271.1l-115.2-45c-4.1-1.6-12.6-3.7-22.2 0l-115.2 45c-10.7 4.2-17.7 14-17.7 24.9 0 111.6 68.7 188.8 132.9 213.9 9.6 3.7 18 1.6 22.2 0C558.4 489.9 640 420.5 640 296c0-10.9-7-20.7-17.7-24.9zM496 462.4V273.3l95.5 37.3c-5.6 87.1-60.9 135.4-95.5 151.8zM224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm96 40c0-2.5.8-4.8 1.1-7.2-2.5-.1-4.9-.8-7.5-.8h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c6.8 0 13.3-1.5 19.2-4-54-42.9-99.2-116.7-99.2-212z"},child:[]}]})(r)}const ze=()=>{const[r,n]=g.useState("alerts"),[s,c]=g.useState({name:"",role:"",department:""});g.useEffect(()=>{const t={name:localStorage.getItem("userName")||"Admin User",role:localStorage.getItem("userRole")||"Administrator",department:localStorage.getItem("userDepartment")||"IT Security"};c(t)},[]);const[i,x]=g.useState({userId:"",alertType:"",status:""}),[o,y]=g.useState({userId:"",status:"",ipAddress:""}),[p,Se]=g.useState({name:"",action:"",route:""}),se=()=>{const t={...o};return t.status==="attempt"&&(delete t.status,t.emptyUserId=!0),t},{data:T=[],isLoading:ne,error:P}=le(i),{data:C=[],isLoading:ce,error:E}=oe(se()),_=j.useMemo(()=>o.status==="attempt"?C.filter(t=>!t.userId||t.userId===""||t.userId===null||t.userId===void 0):o.status==="success"||o.status==="failed"?C.filter(t=>t.status===o.status&&t.userId&&t.userId!==""&&t.userId!==null&&t.userId!==void 0):C,[C,o.status]),M=t=>{n(t),w({name:s.name,role:s.role,department:s.department,route:`/security/${t}`,action:"Tab Change",description:`User navigated to ${t} tab in Security Dashboard`})},N=t=>{const{name:u,value:f}=t.target;x(O=>({...O,[u]:f})),w({name:s.name,role:s.role,department:s.department,route:"/security/alerts",action:"Filter Change",description:`User filtered alerts by ${u}=${f}`})},I=t=>{const{name:u,value:f}=t.target;y(O=>({...O,[u]:f})),w({name:s.name,role:s.role,department:s.department,route:"/security/logins",action:"Filter Change",description:`User filtered login attempts by ${u}=${f}`})},U=t=>new Date(t).toLocaleString(),B=(t,u=!1)=>{if(u)return t==="attempt"?"warning":t==="success"?"success":"danger";switch(t){case"OPEN":return"warning";case"RESOLVED":return"success";case"FALSE_POSITIVE":return"info";default:return"secondary"}},ae=t=>{switch(t){case"SUSPICIOUS_LOGIN":return"warning";case"BRUTE_FORCE":return"danger";case"MULTIPLE_FAILURES":return"danger";case"UNUSUAL_LOCATION":return"info";default:return"secondary"}},d=t=>t==null?"-":typeof t=="object"?t.name?t.name:t.id?t.id:t.toString&&t.toString()!=="[object Object]"?t.toString():JSON.stringify(t):t,ie=t=>!t.userId||t.userId===""||t.userId===null||t.userId===void 0?"attempt":t.status;return e.jsx("div",{className:"security-dashboard",children:e.jsx(A,{children:e.jsxs(m,{children:[e.jsxs(de,{variant:"tabs",className:"mb-4",children:[e.jsx(D,{children:e.jsxs(R,{active:r==="alerts",onClick:()=>M("alerts"),children:[e.jsx(J,{className:"me-2"})," Security Alerts"]})}),e.jsx(D,{children:e.jsxs(R,{active:r==="logins",onClick:()=>M("logins"),children:[e.jsx(Y,{className:"me-2"})," Login Attempts"]})})]}),r==="alerts"&&e.jsxs(V,{className:"mb-4",children:[e.jsx(H,{children:e.jsxs("strong",{children:[e.jsx(J,{className:"me-2"})," Security Alerts"]})}),e.jsxs($,{children:[e.jsxs(A,{className:"mb-3 filter-section",children:[e.jsx(m,{sm:12,children:e.jsxs("h6",{children:[e.jsx(X,{className:"me-2"})," Filters"]})}),e.jsx(m,{sm:3,children:e.jsx(F,{placeholder:"User ID",name:"userId",value:i.userId,onChange:N,className:"mb-2"})}),e.jsx(m,{sm:3,children:e.jsxs(L,{name:"alertType",value:i.alertType,onChange:N,className:"mb-2",children:[e.jsx("option",{value:"",children:"All Alert Types"}),e.jsx("option",{value:"multiple_failed_attempts",children:"Multiple Failed Attempts"}),e.jsx("option",{value:"unusual_login_detected",children:"Unusual Login Detected"}),e.jsx("option",{value:"account_locked",children:"Account Locked"}),e.jsx("option",{value:"rapid_login_detected",children:"Rapid  Login"})]})}),e.jsx(m,{sm:3,children:e.jsxs(L,{name:"status",value:i.status,onChange:N,className:"mb-2",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"resolved",children:"Resolved"}),e.jsx("option",{value:"false_positive",children:"False Positive"})]})})]}),P&&e.jsxs("div",{className:"alert alert-danger",children:["Failed to load security alerts: ",P.toString()]}),ne?e.jsxs("div",{className:"text-center py-5",children:[e.jsx(k,{color:"primary"}),e.jsx("p",{className:"mt-3",children:"Loading security alerts..."})]}):e.jsxs(G,{hover:!0,responsive:!0,children:[e.jsx(Q,{children:e.jsxs(v,{children:[e.jsx(l,{children:"Alert Type"}),e.jsx(l,{children:"User"}),e.jsx(l,{children:"Timestamp"}),e.jsx(l,{children:"Details"}),e.jsx(l,{children:"Status"}),e.jsx(l,{children:"Resolution"})]})}),e.jsx(W,{children:T.length===0?e.jsx(v,{children:e.jsx(a,{colSpan:"6",className:"text-center",children:"No security alerts found"})}):T.map(t=>e.jsxs(v,{children:[e.jsx(a,{children:e.jsx(z,{color:ae(t.alertType),children:d(t.alertType)})}),e.jsxs(a,{children:[e.jsx(ee,{className:"me-1"}),typeof t.userId=="object"&&t.userId!==null&&d(t.userId.name)||d(t.userId)]}),e.jsxs(a,{children:[e.jsx(q,{className:"me-1"}),t.timestamp?U(t.timestamp):"-"]}),e.jsx(a,{children:d(t.details)}),e.jsx(a,{children:e.jsx(z,{color:B(t.status),children:d(t.status)})}),e.jsx(a,{children:t.resolution&&typeof t.resolution=="object"?d(t.resolution.notes):"-"})]},t._id))})]})]})]}),r==="logins"&&e.jsxs(V,{className:"mb-4",children:[e.jsx(H,{children:e.jsxs("strong",{children:[e.jsx(Y,{className:"me-2"})," Login Attempts"]})}),e.jsxs($,{children:[e.jsxs(A,{className:"mb-3 filter-section",children:[e.jsx(m,{sm:12,children:e.jsxs("h6",{children:[e.jsx(X,{className:"me-2"})," Filters"]})}),e.jsx(m,{sm:3,children:e.jsx(F,{placeholder:"User ID",name:"userId",value:o.userId,onChange:I,className:"mb-2"})}),e.jsx(m,{sm:3,children:e.jsx(F,{placeholder:"IP Address",name:"ipAddress",value:o.ipAddress,onChange:I,className:"mb-2"})}),e.jsx(m,{sm:3,children:e.jsxs(L,{name:"status",value:o.status,onChange:I,className:"mb-2",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"success",children:"Success"}),e.jsx("option",{value:"failed",children:"Failed"}),e.jsx("option",{value:"attempt",children:"Attempt"})]})})]}),E&&e.jsxs("div",{className:"alert alert-danger",children:["Failed to load login attempts: ",E.toString()]}),ce?e.jsxs("div",{className:"text-center py-5",children:[e.jsx(k,{color:"primary"}),e.jsx("p",{className:"mt-3",children:"Loading login attempts..."})]}):e.jsxs(G,{hover:!0,responsive:!0,children:[e.jsx(Q,{children:e.jsxs(v,{children:[e.jsx(l,{children:"Status"}),e.jsx(l,{children:"Name"}),e.jsx(l,{children:"Role"}),e.jsx(l,{children:"Department"}),e.jsx(l,{children:"Device/Browser"}),e.jsx(l,{children:"Timestamp"})]})}),e.jsx(W,{children:_.length===0?e.jsx(v,{children:e.jsx(a,{colSpan:"7",className:"text-center",children:"No login attempts found"})}):_.map(t=>{const u=ie(t);return e.jsxs(v,{children:[e.jsx(a,{children:e.jsx(z,{color:B(u,!0),children:u==="success"?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"me-1"})," SUCCESS"]}):u==="attempt"?e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"me-1"})," ATTEMPT"]}):e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"me-1"})," FAILED"]})})}),e.jsxs(a,{children:[e.jsx(ee,{className:"me-1"}),d(t.name)]}),e.jsxs(a,{children:[e.jsx(Ce,{className:"me-1"}),d(t.role)]}),e.jsxs(a,{children:[e.jsx(ve,{className:"me-1"}),d(t.department)]}),e.jsx(a,{children:d(t.userAgent)}),e.jsxs(a,{children:[e.jsx(q,{className:"me-1"}),t.timestamp?U(t.timestamp):"-"]})]},t._id)})})]})]})]})]})})})};export{ze as default};
