import{j as s}from"./index-DLAH96kV.js";import{r as t,i as ds}from"./vendor-react-B6URQkMn.js";import{a as os}from"./axiosInstance-CMfybdaZ.js";import{F as i,w as q,$ as ms,E as hs,U as xs,a0 as K,A as Y,f as js,a1 as ps,a2 as us}from"./index-CFR1Xy5f.js";import{g as Ns,S as y,T as o,o as w,$ as G,p as C,Z as A,_ as J,n as h,W as gs,d as fs,a1 as bs,a2 as ys,a3 as Q,a4 as x,a5 as ws,a6 as j,a0 as X,ab as Cs,ac as u,x as Ss,y as vs,a8 as As,z as Ps,A as Fs}from"./vendor-coreui-Be7TXQEF.js";import"./vendor-redux-C7peqcPR.js";function zs(){var M,z,L,U,I,V,_,$,B,H,O;const[P,F]=t.useState([]),[ss,D]=t.useState(!0),[E,T]=t.useState(""),[n,c]=t.useState(1),[d,es]=t.useState(1),[N,as]=t.useState(10),[m,k]=t.useState({dateFrom:"",dateTo:"",strengthLevel:"",searchTerm:""}),[a,ls]=t.useState(null),[rs,g]=t.useState(!1);ds(),t.useEffect(()=>{is()},[n,N,m]);const is=async()=>{var e,r;D(!0),T("");try{const l=new URLSearchParams({page:n,limit:N,...Object.fromEntries(Object.entries(m).filter(([v,b])=>b!==""))}),p=await os.get(`/security/password-reset-analysis?${l}`);F(p.data.data||[]),es(p.data.totalPages||1)}catch(l){console.error("Error fetching password reset events:",l),T(((r=(e=l.response)==null?void 0:e.data)==null?void 0:r.Message)||"Failed to load password reset analysis data"),F([])}finally{D(!1)}},R=e=>e?new Date(e).toLocaleString():"N/A",S=e=>e<40?"danger":e<60?"warning":e<80?"info":"success",ns=e=>{ls(e),g(!0)},f=(e,r)=>{k({...m,[e]:r}),c(1)},ts=e=>{e.preventDefault()},cs=()=>{k({dateFrom:"",dateTo:"",strengthLevel:"",searchTerm:""}),c(1)};return s.jsxs(Ns,{fluid:!0,className:"px-4",children:[s.jsx(y,{className:"mb-3",children:s.jsxs(o,{children:[s.jsxs("h2",{className:"mb-3 mt-4",children:[s.jsx(i,{icon:q,className:"me-2 text-primary"}),"Password Reset Analysis Dashboard"]}),s.jsx("p",{className:"text-muted",children:"Monitor and analyze password reset events and security levels across the system"})]})}),s.jsxs(w,{className:"mb-4 shadow-sm",children:[s.jsxs(G,{children:[s.jsx(i,{icon:ms,className:"me-2"}),"Filters & Search"]}),s.jsx(C,{children:s.jsxs("form",{onSubmit:ts,children:[s.jsxs(y,{className:"g-3",children:[s.jsx(o,{md:3,children:s.jsx(A,{type:"date",label:"From Date",value:m.dateFrom,onChange:e=>f("dateFrom",e.target.value)})}),s.jsx(o,{md:3,children:s.jsx(A,{type:"date",label:"To Date",value:m.dateTo,onChange:e=>f("dateTo",e.target.value)})}),s.jsx(o,{md:3,children:s.jsxs(J,{label:"Password Strength",value:m.strengthLevel,onChange:e=>f("strengthLevel",e.target.value),children:[s.jsx("option",{value:"",children:"All Strength Levels"}),s.jsx("option",{value:"Weak",children:"Weak"}),s.jsx("option",{value:"Moderate",children:"Moderate"}),s.jsx("option",{value:"Strong",children:"Strong"}),s.jsx("option",{value:"Very Strong",children:"Very Strong"})]})}),s.jsx(o,{md:3,children:s.jsx(A,{type:"text",label:"Search User",placeholder:"Name or Email",value:m.searchTerm,onChange:e=>f("searchTerm",e.target.value)})})]}),s.jsx(y,{className:"mt-3",children:s.jsxs(o,{className:"d-flex justify-content-end",children:[s.jsx(h,{color:"secondary",variant:"outline",className:"me-2",onClick:cs,children:"Reset Filters"}),s.jsxs(h,{type:"submit",color:"primary",children:[s.jsx(i,{icon:hs,className:"me-2"}),"Search"]})]})})]})})]}),E&&s.jsxs(gs,{color:"danger",className:"mb-4",children:[s.jsx(i,{icon:xs,className:"me-2"}),E]}),s.jsxs(w,{className:"mb-4 shadow-sm",children:[s.jsxs(G,{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("div",{children:[s.jsx(i,{icon:K,className:"me-2"}),"Password Reset Events"]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("span",{className:"me-2",children:"Show:"}),s.jsxs(J,{size:"sm",className:"me-3",style:{width:"80px"},value:N,onChange:e=>{as(Number(e.target.value)),c(1)},children:[s.jsx("option",{value:"5",children:"5"}),s.jsx("option",{value:"10",children:"10"}),s.jsx("option",{value:"25",children:"25"}),s.jsx("option",{value:"50",children:"50"})]})]})]}),s.jsx(C,{children:ss?s.jsxs("div",{className:"text-center py-5",children:[s.jsx(fs,{color:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading password reset data..."})]}):P.length===0?s.jsxs("div",{className:"text-center py-5",children:[s.jsx(i,{icon:Y,size:"2x",className:"text-muted mb-3"}),s.jsx("p",{className:"text-muted",children:"No password reset events found"})]}):s.jsxs(s.Fragment,{children:[s.jsxs(bs,{responsive:!0,hover:!0,align:"middle",className:"mb-0",children:[s.jsx(ys,{children:s.jsxs(Q,{className:"bg-light",children:[s.jsx(x,{style:{width:"5%"},children:"#"}),s.jsxs(x,{style:{width:"20%"},children:[s.jsx(i,{icon:js,className:"me-2"}),"User"]}),s.jsxs(x,{style:{width:"15%"},children:[s.jsx(i,{icon:ps,className:"me-2"}),"Reset Date"]}),s.jsxs(x,{style:{width:"30%"},children:[s.jsx(i,{icon:K,className:"me-2"}),"Password Strength"]}),s.jsx(x,{style:{width:"15%"},children:"Status"}),s.jsx(x,{style:{width:"15%"},children:"Actions"})]})}),s.jsx(ws,{children:P.map((e,r)=>{var l,p,v,b,W,Z;return s.jsxs(Q,{children:[s.jsx(j,{children:(n-1)*N+r+1}),s.jsx(j,{children:s.jsxs("div",{className:"d-flex flex-column",children:[s.jsx("span",{className:"fw-bold",children:((l=e==null?void 0:e.user)==null?void 0:l.name)||"Unknown"}),s.jsx("span",{className:"small text-muted",children:((p=e==null?void 0:e.user)==null?void 0:p.email)||"No email"})]})}),s.jsx(j,{children:R(e==null?void 0:e.timestamp)}),s.jsx(j,{children:s.jsxs("div",{className:"d-flex flex-column",children:[s.jsxs("div",{className:"d-flex justify-content-between mb-1",children:[s.jsx("span",{children:((v=e==null?void 0:e.passwordAnalysis)==null?void 0:v.strength)||"N/A"}),s.jsxs("span",{className:"fw-bold",children:[((b=e==null?void 0:e.passwordAnalysis)==null?void 0:b.score)||0,"/100"]})]}),s.jsx(X,{thin:!0,value:((W=e==null?void 0:e.passwordAnalysis)==null?void 0:W.score)||0,color:S(((Z=e==null?void 0:e.passwordAnalysis)==null?void 0:Z.score)||0)})]})}),s.jsx(j,{children:e!=null&&e.validationPassed?s.jsx(h,{color:"success",variant:"outline",size:"sm",className:"px-3",disabled:!0,children:"Success"}):s.jsx(h,{color:"danger",variant:"outline",size:"sm",className:"px-3",disabled:!0,children:"Failed"})}),s.jsx(j,{children:s.jsxs(h,{color:"primary",variant:"ghost",size:"sm",onClick:()=>ns(e),children:[s.jsx(i,{icon:us,className:"me-1"}),"Details"]})})]},(e==null?void 0:e._id)||r)})})]}),s.jsxs(Cs,{align:"center",className:"mt-4",children:[s.jsx(u,{disabled:n===1,onClick:()=>c(1),children:"First"}),s.jsx(u,{disabled:n===1,onClick:()=>c(e=>Math.max(e-1,1)),children:"Previous"}),[...Array(Math.min(5,d))].map((e,r)=>{let l;return d<=5||n<=3?l=r+1:n>=d-2?l=d-4+r:l=n-2+r,s.jsx(u,{active:l===n,onClick:()=>c(l),children:l},l)}),s.jsx(u,{disabled:n===d,onClick:()=>c(e=>Math.min(e+1,d)),children:"Next"}),s.jsx(u,{disabled:n===d,onClick:()=>c(d),children:"Last"})]})]})})]}),s.jsxs(Ss,{visible:rs,onClose:()=>g(!1),size:"lg",children:[s.jsx(vs,{onClose:()=>g(!1),children:s.jsxs(As,{children:[s.jsx(i,{icon:q,className:"me-2 text-primary"}),"Password Reset Details"]})}),s.jsx(Ps,{children:a&&s.jsxs(s.Fragment,{children:[s.jsxs(y,{className:"mb-4",children:[s.jsxs(o,{md:6,children:[s.jsx("h5",{children:"User Information"}),s.jsxs("div",{className:"mb-2",children:[s.jsx("strong",{children:"Name:"})," ",((M=a.user)==null?void 0:M.name)||"Unknown"]}),s.jsxs("div",{className:"mb-2",children:[s.jsx("strong",{children:"Email:"})," ",((z=a.user)==null?void 0:z.email)||"No email"]}),s.jsxs("div",{className:"mb-2",children:[s.jsx("strong",{children:"Department:"})," ",((L=a.user)==null?void 0:L.department)||"N/A"]}),s.jsxs("div",{className:"mb-2",children:[s.jsx("strong",{children:"Role:"})," ",((U=a.user)==null?void 0:U.role)||"User"]})]}),s.jsxs(o,{md:6,children:[s.jsx("h5",{children:"Event Information"}),s.jsxs("div",{className:"mb-2",children:[s.jsx("strong",{children:"Event ID:"})," ",a._id||"N/A"]}),s.jsxs("div",{className:"mb-2",children:[s.jsx("strong",{children:"Timestamp:"})," ",R(a.timestamp)]}),s.jsxs("div",{className:"mb-2",children:[s.jsx("strong",{children:"IP Address:"})," ",a.ipAddress||"N/A"]}),s.jsxs("div",{className:"mb-2",children:[s.jsx("strong",{children:"Status:"})," ",a.validationPassed?"Success":"Failed"]})]})]}),s.jsx("h5",{className:"mb-3",children:"Password Analysis"}),s.jsx(w,{className:"mb-4 border",children:s.jsxs(C,{children:[s.jsxs("div",{className:"mb-3",children:[s.jsxs("div",{className:"d-flex justify-content-between mb-1",children:[s.jsx("span",{className:"fw-bold",children:"Strength Rating:"}),s.jsx("span",{className:`text-${S(((I=a.passwordAnalysis)==null?void 0:I.score)||0)}`,children:((V=a.passwordAnalysis)==null?void 0:V.strength)||"N/A"})]}),s.jsxs("div",{className:"d-flex justify-content-between mb-1",children:[s.jsx("span",{className:"fw-bold",children:"Score:"}),s.jsxs("span",{children:[((_=a.passwordAnalysis)==null?void 0:_.score)||0,"/100"]})]}),s.jsx(X,{className:"mb-3",value:(($=a.passwordAnalysis)==null?void 0:$.score)||0,color:S(((B=a.passwordAnalysis)==null?void 0:B.score)||0)})]}),((H=a.passwordAnalysis)==null?void 0:H.feedback)&&a.passwordAnalysis.feedback.length>0&&s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{children:"Feedback & Recommendations"}),s.jsx("ul",{className:"list-group list-group-flush",children:a.passwordAnalysis.feedback.map((e,r)=>s.jsxs("li",{className:"list-group-item px-0",children:[s.jsx(i,{icon:Y,className:"me-2 text-primary"}),e]},r))})]}),((O=a.passwordAnalysis)==null?void 0:O.explanation)&&s.jsxs("div",{className:"p-3 bg-light rounded",children:[s.jsx("h6",{children:"Analysis Explanation"}),s.jsx("p",{className:"mb-0",children:a.passwordAnalysis.explanation})]})]})}),a.validationDetails&&s.jsxs("div",{className:"mb-3",children:[s.jsx("h5",{className:"mb-3",children:"Validation Details"}),s.jsx(w,{className:"border",children:s.jsxs(C,{children:[s.jsxs("div",{className:"mb-2",children:[s.jsx("strong",{children:"Validation Passed:"})," ",a.validationDetails.passed?"Yes":"No"]}),a.validationDetails.message&&s.jsxs("div",{className:"mb-2",children:[s.jsx("strong",{children:"Message:"})," ",a.validationDetails.message]}),a.validationDetails.checks&&s.jsxs("div",{className:"mt-3",children:[s.jsx("h6",{children:"Validation Checks"}),s.jsx("ul",{className:"list-group list-group-flush",children:Object.entries(a.validationDetails.checks).map(([e,r])=>s.jsxs("li",{className:"list-group-item px-0 d-flex justify-content-between",children:[s.jsx("span",{children:e.replace(/([A-Z])/g," $1").replace(/^./,l=>l.toUpperCase())}),s.jsx("span",{children:r?s.jsx("span",{className:"text-success",children:"Passed"}):s.jsx("span",{className:"text-danger",children:"Failed"})})]},e))})]})]})})]})]})}),s.jsx(Fs,{children:s.jsx(h,{color:"secondary",onClick:()=>g(!1),children:"Close"})})]})]})}export{zs as default};
