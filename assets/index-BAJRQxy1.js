import{j as e}from"./index-BizgVrQc.js";import{r as c}from"./vendor-react-B6URQkMn.js";import{a as C}from"./axiosInstance-Dv2jt_v_.js";import{u as L}from"./vendor-redux-DipIbRRz.js";import{F as t,$ as B,E as b,a0 as H,a1 as I,f as O,a2 as z,a3 as _,a4 as G,a5 as P,a6 as V,T as W}from"./index-DKn7kd4F.js";import{u as X,c as k,k as T,X as $,l as E,j as g,ac as Y,C as Z,Y as q,Z as J,_ as u,$ as l,a0 as K,a1 as n,y,ae as S,af as Q,N as ee,O as R}from"./vendor-coreui-ChV5wH51.js";import"./index-t--hEgTQ.js";const ie=()=>{const[i,p]=c.useState([]),[f,o]=c.useState(null),[A,d]=c.useState(!0),[m,x]=c.useState(!1),D=L(a=>a.changeState.theme),{colorMode:F}=X("coreui-free-react-admin-template-theme"),s=D==="dark"||F==="dark",N=()=>{d(!0),o(null),C.get("/general/log").then(a=>{p(a.data),d(!1)}).catch(a=>{o(a.message),d(!1)})},M=()=>{x(!0),C.get("/general/log").then(a=>{p(a.data),x(!1)}).catch(a=>{o(a.message),x(!1)})};c.useEffect(()=>{N()},[]);const U=s?{color:"#FFFFFF"}:{},w=a=>{const h={CREATE:"success",UPDATE:"primary",DELETE:"danger",RESTORE:"warning",SELECT:"info",FETCH:s?"light":"secondary",NAVIGATE:s?"light":"secondary",AUTO:s?"light":"dark",SET:"info"};for(const[j,r]of Object.entries(h))if(a&&a.includes(j))return r;return s?"light":"secondary"},v=a=>{const h=new Date,j=new Date(a),r=Math.floor((h-j)/1e3);return r<60?`${r} seconds ago`:r<3600?`${Math.floor(r/60)} minutes ago`:r<86400?`${Math.floor(r/3600)} hours ago`:`${Math.floor(r/86400)} days ago`};return f?e.jsx(k,{className:"mt-4",children:e.jsxs(T,{className:`text-center border-danger ${s?"bg-dark text-white":""}`,children:[e.jsxs($,{className:"bg-danger text-white",children:[e.jsx(t,{icon:B,className:"me-2"})," Error"]}),e.jsxs(E,{children:[e.jsx("p",{className:"mb-0",children:f}),e.jsxs(g,{color:"primary",className:"mt-3",onClick:N,children:[e.jsx(t,{icon:b,className:"me-2"})," Try Again"]})]})]})}):e.jsx(k,{fluid:!0,className:"p-4",children:e.jsxs(T,{className:`shadow-sm ${s?"bg-dark text-white":""}`,children:[e.jsxs($,{className:`d-flex justify-content-between align-items-center ${s?"bg-dark text-white border-secondary":"bg-light"}`,children:[e.jsxs("div",{children:[e.jsx(t,{icon:H,className:"me-2 text-primary"}),e.jsx(Y,{className:"d-inline mb-0",style:U,children:"Activity Tracker"})]}),e.jsxs("div",{children:[e.jsxs(g,{color:"light",size:"sm",className:`me-2 ${s?"text-dark":""}`,onClick:M,disabled:m,children:[e.jsx(t,{icon:b,spin:m,className:"me-1"}),m?"Refreshing...":"Refresh"]}),e.jsxs(g,{color:s?"light":"secondary",size:"sm",className:s?"text-dark":"",children:[e.jsx(t,{icon:I,className:"me-1"}),"Export"]})]})]}),e.jsx(E,{children:A?e.jsxs("div",{className:"text-center p-5",children:[e.jsx(Z,{color:"primary"}),e.jsx("p",{className:`mt-2 ${s?"text-light":"text-muted"}`,children:"Loading activity data..."})]}):e.jsx("div",{className:"table-responsive",children:e.jsxs(q,{hover:!0,striped:!0,responsive:!0,className:`border ${s?"table-dark":""}`,children:[e.jsx(J,{className:s?"bg-dark text-white border-secondary":"bg-light",children:e.jsxs(u,{children:[e.jsxs(l,{className:"text-nowrap",children:[e.jsx(t,{icon:O,className:`me-2 ${s?"text-white":"text-muted"}`}),"User"]}),e.jsxs(l,{className:"text-nowrap",children:[e.jsx(t,{icon:z,className:`me-2 ${s?"text-white":"text-muted"}`}),"Role"]}),e.jsxs(l,{className:"text-nowrap",children:[e.jsx(t,{icon:_,className:`me-2 ${s?"text-white":"text-muted"}`}),"Department"]}),e.jsxs(l,{className:"text-nowrap",children:[e.jsx(t,{icon:G,className:`me-2 ${s?"text-white":"text-muted"}`}),"Route"]}),e.jsxs(l,{className:"text-nowrap",children:[e.jsx(t,{icon:P,className:`me-2 ${s?"text-white":"text-muted"}`}),"Action"]}),e.jsxs(l,{className:"text-nowrap",children:[e.jsx(t,{icon:V,className:`me-2 ${s?"text-white":"text-muted"}`}),"Description"]}),e.jsxs(l,{className:"text-nowrap",children:[e.jsx(t,{icon:W,className:`me-2 ${s?"text-white":"text-muted"}`}),"Time"]})]})}),e.jsx(K,{children:i.length===0?e.jsx(u,{children:e.jsx(n,{colSpan:7,className:`text-center p-5 ${s?"text-white":"text-muted"}`,children:"No activity records found"})}):i.map(a=>e.jsxs(u,{className:"align-middle",children:[e.jsx(n,{className:"font-weight-bold",children:a.name||"Unknown"}),e.jsx(n,{children:e.jsx(y,{color:s?"light":"dark",shape:"rounded-pill",className:`px-2 py-1 ${s?"text-dark":""}`,children:a.role||"Unknown"})}),e.jsx(n,{children:a.department||"Unknown"}),e.jsx(n,{className:s?"text-info":"text-primary",children:a.route}),e.jsx(n,{children:e.jsx(y,{color:w(a.action),shape:"rounded-pill",className:w(a.action)==="light"?"text-dark":"",children:a.action})}),e.jsx(n,{children:e.jsx(S,{content:a.description,placement:"bottom",children:e.jsx("div",{className:"text-truncate",style:{maxWidth:"200px"},children:a.description})})}),e.jsx(n,{className:"text-nowrap",children:e.jsx(S,{content:new Date(a.timestamp).toLocaleString(),children:e.jsx("span",{children:v(a.timestamp)})})})]},a._id))})]})})}),e.jsx(Q,{className:`${s?"bg-dark text-white border-secondary":"bg-light text-muted"}`,children:e.jsxs(ee,{children:[e.jsx(R,{children:e.jsxs("small",{children:["Showing ",i.length," activities"]})}),e.jsx(R,{className:"text-end",children:e.jsxs("small",{children:["Last updated: ",new Date().toLocaleString()]})})]})})]})})};export{ie as default};
