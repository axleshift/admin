import{j as e}from"./index-DGlCYBmm.js";import{r as c}from"./vendor-react-B6URQkMn.js";import{a as f}from"./axiosInstance-Dv2jt_v_.js";import{F as o,Q as S,R as C,S as T,T as R,E as P}from"./index-DgWFfLP0.js";import{c as v,k,X as D,N as U,O as N,j as m,l as F,S as B,C as A,_ as H,$ as L,a0 as j,a1 as t,a2 as I,a3 as r,Y as _,y as u}from"./vendor-coreui-DDUzhqJ9.js";import"./vendor-redux-C7peqcPR.js";import"./index-t--hEgTQ.js";const G=()=>{const[x,w]=c.useState([]),[l,d]=c.useState(!0),[g,h]=c.useState(null),[y,p]=c.useState(0);c.useEffect(()=>{(async()=>{var n,a;try{d(!0);const i=await f.get("/client/new-users");w(i.data.users),h(null)}catch(i){h(((a=(n=i.response)==null?void 0:n.data)==null?void 0:a.message)||"Failed to fetch newly registered users"),console.error("Error fetching new users:",i)}finally{d(!1)}})()},[y]);const b=async()=>{var s,n;try{d(!0);const a=await f.post("/client/process-registrations");alert(`Processing complete: ${a.data.message}`),p(i=>i+1)}catch(a){h(((n=(s=a.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to process registrations"),console.error("Error processing registrations:",a),d(!1)}},E=s=>s?new Date(s).toLocaleString():"N/A";return e.jsx(v,{fluid:!0,className:"px-4",children:e.jsxs(k,{className:"mb-4",children:[e.jsx(D,{children:e.jsxs(U,{className:"align-items-center",children:[e.jsx(N,{children:e.jsx("h2",{className:"mb-0",children:"Newly Registered Users"})}),e.jsxs(N,{className:"d-flex justify-content-end",children:[e.jsxs(m,{color:"primary",onClick:b,disabled:l,className:"me-2",children:[e.jsx(o,{icon:l?S:C,spin:l,className:"me-2"}),"Process Pending Registrations"]}),e.jsxs(m,{color:"success",onClick:()=>p(s=>s+1),disabled:l,children:[e.jsx(o,{icon:C,className:"me-2"}),"Refresh List"]})]})]})}),e.jsxs(F,{children:[g&&e.jsx(B,{color:"danger",children:g}),l?e.jsx("div",{className:"d-flex justify-content-center py-5",children:e.jsx(A,{color:"primary"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Total Users:"})," ",x.length]}),e.jsxs(H,{hover:!0,responsive:!0,bordered:!0,children:[e.jsx(L,{color:"light",children:e.jsxs(j,{children:[e.jsx(t,{children:"Name"}),e.jsx(t,{children:"Email"}),e.jsx(t,{children:"Role"}),e.jsx(t,{children:"Department"}),e.jsx(t,{children:"Password"}),e.jsx(t,{children:"Registration Date"}),e.jsx(t,{children:"Status"})]})}),e.jsx(I,{children:x.length>0?x.map(s=>e.jsxs(j,{children:[e.jsxs(r,{children:[s.firstName," ",s.lastName]}),e.jsx(r,{children:s.email}),e.jsx(r,{children:s.role}),e.jsx(r,{children:s.department}),e.jsx(r,{children:s.generatedPassword?e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("span",{className:"bg-light px-2 py-1 rounded",children:s.generatedPassword}),e.jsx(m,{color:"link",onClick:()=>{navigator.clipboard.writeText(s.generatedPassword),alert("Password copied to clipboard!")},title:"Copy to clipboard",children:e.jsx(o,{icon:T})})]}):e.jsx("span",{className:"text-muted",children:"Not available"})}),e.jsx(r,{children:E(s.registrationDate)}),e.jsx(r,{children:s.registrationError?e.jsx(_,{content:s.registrationError,children:e.jsxs(u,{color:"danger",children:[e.jsx(o,{icon:R,className:"me-1"})," Error"]})}):e.jsxs(u,{color:"success",children:[e.jsx(o,{icon:P,className:"me-1"})," Success"]})})]},s._id)):e.jsx(j,{children:e.jsx(r,{colSpan:"7",className:"text-center py-4 text-muted",children:"No registered users found"})})})]})]})]})]})})};export{G as default};
