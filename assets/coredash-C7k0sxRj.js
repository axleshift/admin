import{j as t}from"./index-3FTAhQcu.js";import{r as i}from"./vendor-react-BHxUanFt.js";import{S as p}from"./statbox-Cc0eoi3p.js";import{C as W}from"./customhead-H6YLDd_T.js";import L from"./shipmentTable-DXKl5mUG.js";import{a as g}from"./axiosInstance-Bq-uIJjs.js";import{F as f,m as $,n as J,o as O,p as K,q as z}from"./index-fF0KaNX5.js";import{l as _}from"./activityLogger-D6Lc4RsL.js";import{C as G,a as I,b as n}from"./vendor-coreui-DaIzHuu_.js";import"./vendor-redux-CSji-Y9p.js";import"./index-xsH4HHeE.js";const oe=()=>{const[S,N]=i.useState([]),[u,U]=i.useState(null),[y,b]=i.useState(null),[D,R]=i.useState(null),[c,o]=i.useState(!0),[Y,m]=i.useState(null),[B,P]=i.useState([]),j=localStorage.getItem("name"),v=localStorage.getItem("role"),E=localStorage.getItem("department");_({name:j,role:v,department:E,route:"Core Dashboard",action:"Navigate",description:`${j} Navigate to Core Dashboard`}).catch(console.warn);const H=e=>{if(e==null)return"N/A";const r=(typeof e=="number"?e.toString():e).replace(/[\s,]/g,""),F={$:"USD","₱":"PHP","€":"EUR","£":"GBP","¥":"JPY","₩":"KRW","₹":"INR",R$:"BRL",A$:"AUD",C$:"CAD","฿":"THB","₽":"RUB",kr:"SEK",CHF:"CHF",zł:"PLN"},w=["USD","PHP","EUR","GBP","JPY","KRW","INR","BRL","AUD","CAD","THB","RUB","SEK","CHF","PLN"];let a="USD";for(const[C,k]of Object.entries(F))if(r.includes(C)){a=k;break}for(const C of w)if(r.includes(C)){a=C;break}let l=r.replace(/[^\d.-]/g,"");const d=parseFloat(l);return isNaN(d)?e:new Intl.NumberFormat("en-US",{style:"currency",currency:a}).format(d)};i.useEffect(()=>{const e=async()=>{var a;try{o(!0);const d=((a=(await g.get("/core/fetch-core")).data)==null?void 0:a.data)||[];N(d),o(!1)}catch(l){m(l.message||"Failed to fetch shipment data"),o(!1)}},s=async()=>{try{o(!0);const a=await g.get("/core/insight/cost");U(a.data),o(!1)}catch(a){m(a.message||"Failed to fetch insight Cost Data"),o(!1)}},r=async()=>{try{o(!0);const a=await g.get("/core/insight/weight");b(a.data),o(!1)}catch(a){m(a.message||"Failed to fetch insight Weight Data"),o(!1)}},F=async()=>{try{o(!0);const a=await g.get("/core/insight/item?timeframe=6months");R(a.data),o(!1)}catch(a){m(a.message||"Failed to fetch insight Item Data"),o(!1)}};(async()=>{try{const l=(await g.get("/hr/worker")).data.filter(d=>d.department==="Core");P(l)}catch(a){m(a.message||"Failed to fetch Core department users"),console.error("Error fetching Core users:",a)}})(),r(),s(),e(),F()},[]);const T=S.length;S.reduce((e,s)=>e+(parseFloat(s.total_weight)||0),0),S.reduce((e,s)=>e+(parseInt(s.number_of_items)||0),0);let A=0;if(u){const e=typeof u=="string"?JSON.parse(u):u;e&&e.data&&Array.isArray(e.data)&&(A=e.data.reduce((s,r)=>s+(parseFloat(r)||0),0))}let h=0;if(y){const e=typeof y=="string"?JSON.parse(y):y;e&&e.data&&Array.isArray(e.data)?h=e.data.reduce((s,r)=>s+(parseFloat(r)||0),0):e&&Array.isArray(e)?h=e.reduce((s,r)=>s+(parseFloat(r.weight)||0),0):e&&e.weights&&Array.isArray(e.weights)?h=e.weights.reduce((s,r)=>s+(parseFloat(r)||0),0):e&&e.data&&e.data.weights&&Array.isArray(e.data.weights)&&(h=e.data.weights.reduce((s,r)=>s+(parseFloat(r)||0),0))}let x=0;if(D){const e=typeof D=="string"?JSON.parse(D):D;e&&e.data&&Array.isArray(e.data)?x=e.data.reduce((s,r)=>s+(parseFloat(r)||0),0):e&&Array.isArray(e)?x=e.reduce((s,r)=>s+parseFloat(r.count||0),0):e&&e.items&&Array.isArray(e.items)&&(x=e.items.reduce((s,r)=>s+(parseFloat(r)||0),0))}return t.jsxs(t.Fragment,{children:[t.jsx(W,{title:"Core Dashboard"}),t.jsxs(G,{fluid:!0,children:[t.jsxs(I,{className:"mb-4",children:[t.jsx(n,{xs:12,md:6,lg:3,children:t.jsx(p,{title:"Core Department Employees",value:c?"...":B.length,icon:t.jsx(f,{icon:$,style:{fontSize:"20px",color:"#0d6efd"}}),description:"Total Core personnel",loading:c})}),t.jsx(n,{sm:6,lg:3,children:t.jsx(p,{title:"Total Shipments",value:T,icon:t.jsx(f,{icon:J}),color:"primary",loading:c,description:"Total shipments tracked"})}),t.jsx(n,{sm:6,lg:3,children:t.jsx(p,{title:"Insight Cost",value:H(A),icon:t.jsx(f,{icon:O}),color:"success",loading:c,description:"Cost insights for period"})}),t.jsx(n,{sm:6,lg:3,children:t.jsx(p,{title:"Insight Weight",value:`${h.toFixed(2)} kg`,icon:t.jsx(f,{icon:K}),color:"info",loading:c,description:"Total weight tracked"})}),t.jsx(n,{sm:6,lg:3,children:t.jsx(p,{title:"Insight Items",value:x.toFixed(0),icon:t.jsx(f,{icon:z}),color:"warning",loading:c,description:"Total items shipped"})})]}),t.jsxs(I,{className:"mb-4",children:[t.jsx(n,{lg:8,children:t.jsx(L,{})}),t.jsx(n,{lg:4})]})]})]})};export{oe as default};
